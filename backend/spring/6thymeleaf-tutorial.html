<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>第6章 テンプレートエンジン（Thymeleaf）を知ろう</title>

        <link
            href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&family=M+PLUS+Rounded+1c:wght@400;500;700&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="../../shared/common.css" />
        <style>
            :root {
                --primary: #0097A7;
                --primary-dark: #00838F;
                --primary-light: #E0F7FA;
                --primary-lighter: #B2EBF2;
            }
            .nav-category-links { display: none; }
        </style>
    </head>
    <body>
        <!-- グローバルナビゲーション -->
        <nav class="global-nav"></nav>
        <script src="../../shared/js/nav-spring.js"></script>

        <div class="container">
            <!-- ヘッダー -->
            <header class="chapter-header">
                <div class="chapter-badge">📘 Chapter</div>
                <div class="chapter-number">6</div>
                <h1 class="chapter-title">テンプレートエンジン<br />（Thymeleaf）を知ろう</h1>
            </header>

            <!-- 目次 -->
            <nav class="toc">
                <h2 class="toc-title">📑 この章で学ぶこと</h2>
                <ul class="toc-list">
                    <li class="toc-item">
                        <a href="#section-6-1"> <span class="toc-section">6-1</span>Thymeleafについて知ろう </a>
                    </li>
                    <li class="toc-item">
                        <a href="#section-6-2">
                            <span class="toc-section">6-2</span>Modelを使ったプログラムを作成しよう
                        </a>
                    </li>
                    <li class="toc-item">
                        <a href="#section-6-3"> <span class="toc-section">6-3</span>Thymeleafを使ってみよう </a>
                    </li>
                </ul>
            </nav>

            <!-- Section 6-1 -->
            <section id="section-6-1" class="section">
                <div class="section-header">
                    <span class="section-number">Section 6-1</span>
                    <h2 class="section-title">Thymeleafについて知ろう</h2>
                </div>

                <p>
                    この章では、Spring
                    Bootで使用が推奨されている「Thymeleaf（タイムリーフ）」というテンプレートエンジンについて使用方法を説明した後、ThymeleafをビューとしてWebアプリケーションを作成します。
                </p>

                <!-- 6-1-1 Thymeleafとは？ -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-1-1</span>
                        <h3 class="subsection-title">Thymeleafとは？</h3>
                    </div>

                    <p>Thymeleaf（タイムリーフ）の特徴を以下に簡単に説明します。</p>

                    <ul class="feature-list">
                        <li class="feature-item">
                            <div class="feature-icon">📄</div>
                            <div class="feature-content">
                                <h4>HTMLベースで使いやすい</h4>
                                <p>
                                    ThymeleafはHTMLを基本にしているので、普通のHTMLとほとんど変わりません。特別なコードを書くことで、ページに動きをつけたり、データを表示したりできます。
                                </p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">⚡</div>
                            <div class="feature-content">
                                <h4>動的なページ作成</h4>
                                <p>
                                    条件分岐（もし〜なら、これを表示）や繰り返し（このリストを何回も表示）など、プログラミングの基本的な機能を使って、動的なWebページを作れます。
                                </p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">🎨</div>
                            <div class="feature-content">
                                <h4>ナチュラルテンプレート</h4>
                                <p>
                                    Thymeleafは「ナチュラルテンプレート」とも呼ばれます。これは、テンプレートがそのままのHTMLとしても見れるということです。これにより、デザイナーは特別なツールなしでテンプレートを確認できます。
                                </p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">👥</div>
                            <div class="feature-content">
                                <h4>デザイナーとの分業作業が楽</h4>
                                <p>
                                    Thymeleafのテンプレートはそのままブラウザで見ることができます。これにより、デザイナーとプログラマーが同時に作業しやすくなります。
                                </p>
                            </div>
                        </li>
                    </ul>

                    <div class="info-box success">
                        <h4>💡 ポイント</h4>
                        <p>
                            これらの特徴が、Thymeleafを使う理由としてよく挙げられます。特に、「デザイナーとの分業作業が楽」に行える点は大きな利点です。
                        </p>
                    </div>
                </div>

<div class="architecture-diagram">
                    <!-- MVCモデル図解 -->
                    <div class="diagram-container">
 <div class="diagram-title">図6.1 リクエスト受信からレスポンス送信までの流れ</div>
                        <svg viewBox="0 0 700 380" style="max-width: 100%; height: auto">
                            <!-- クライアント -->
                            <g transform="translate(20, 55)">
                                <rect
                                    x="0"
                                    y="0"
                                    width="90"
                                    height="70"
                                    rx="8"
                                    fill="#f1f5f9"
                                    stroke="#64748b"
                                    stroke-width="2"
                                />
                                <text
                                    x="45"
                                    y="30"
                                    text-anchor="middle"
                                    font-size="11"
                                    fill="#1e293b"
                                    font-weight="600"
                                >
                                    クライアント
                                </text>
                                <text x="45" y="50" text-anchor="middle" font-size="10" fill="#64748b">(ブラウザ)</text>
                            </g>

                            <!-- DispatcherServlet -->
                            <g transform="translate(250, 45)">
                                <rect
                                    x="0"
                                    y="0"
                                    width="110"
                                    height="90"
                                    rx="8"
                                    fill="#0ea5e9"
                                    stroke="#0284c7"
                                    stroke-width="2"
                                />
                                <text x="55" y="35" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    Dispatcher
                                </text>
                                <text x="55" y="52" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    Servlet
                                </text>
                                <text x="55" y="72" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.8)">
                                    フロントコントローラ
                                </text>
                            </g>

                            <!-- Spring MVC 枠 -->
                            <rect
                                x="230"
                                y="10"
                                width="150"
                                height="340"
                                rx="12"
                                fill="none"
                                stroke="#0ea5e9"
                                stroke-width="2"
                                stroke-dasharray="8,4"
                            />
                            <text x="305" y="35" text-anchor="middle" font-size="12" fill="#0ea5e9" font-weight="700">
                                Spring MVC
                            </text>

                            <!-- コントローラ -->
                            <g transform="translate(440, 60)">
                                <rect
                                    x="0"
                                    y="0"
                                    width="100"
                                    height="60"
                                    rx="8"
                                    fill="#f59e0b"
                                    stroke="#d97706"
                                    stroke-width="2"
                                />
                                <text x="50" y="35" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    コントローラ
                                </text>
                                <circle cx="-35" cy="5" r="14" fill="#ef4444" />
                                <text x="-35" y="10" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    2
                                </text>
                            </g>

                            <!-- ビジネスロジック -->
                            <g transform="translate(590, 60)">
                                <rect
                                    x="0"
                                    y="0"
                                    width="100"
                                    height="60"
                                    rx="8"
                                    fill="#8b5cf6"
                                    stroke="#7c3aed"
                                    stroke-width="2"
                                />
                                <text x="50" y="28" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    ビジネス
                                </text>
                                <text x="50" y="45" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    ロジック
                                </text>
                                <circle cx="-25" cy="5" r="14" fill="#ef4444" />
                                <text x="-25" y="10" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    3
                                </text>
                            </g>

                            <!-- Model -->
                            <g transform="translate(255, 280)">
                                <rect
                                    x="0"
                                    y="0"
                                    width="100"
                                    height="60"
                                    rx="8"
                                    fill="#3b82f6"
                                    stroke="#2563eb"
                                    stroke-width="2"
                                />
                                <text x="50" y="35" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    Model
                                </text>
                                <circle cx="205" cy="15" r="14" fill="#ef4444" />
                                <text x="205" y="20" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    4
                                </text>
                            </g>

                            <!-- ビュー -->
                            <g transform="translate(90, 180)">
                                <rect
                                    x="0"
                                    y="0"
                                    width="100"
                                    height="60"
                                    rx="8"
                                    fill="#10b981"
                                    stroke="#059669"
                                    stroke-width="2"
                                />
                                <text x="50" y="35" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    ビュー
                                </text>
                                <circle cx="175" cy="5" r="14" fill="#ef4444" />
                                <text x="175" y="10" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                    5
                                </text>
                            </g>

                            <!-- 矢印 -->
                            <!-- 1: クライアント → DispatcherServlet -->
                            <path
                                d="M110 90 L245 90"
                                stroke="#64748b"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow-gray)"
                            />
                            <circle cx="165" cy="70" r="14" fill="#ef4444" />
                            <text x="165" y="75" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                1
                            </text>

                            <!-- 2: DispatcherServlet → コントローラ -->
                            <path
                                d="M380 90 L435 90"
                                stroke="#0ea5e9"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow-blue)"
                            />

                            <!-- 3: コントローラ → ビジネスロジック -->
                            <path
                                d="M545 90 L590 90"
                                stroke="#0ea5e9"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow-blue)"
                            />

                            <!-- 4: コントローラ → Model -->
                            <path
                                d="M490 120 L490 310 L365 310"
                                stroke="#0ea5e9"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow-blue)"
                            />
                            <text x="420" y="155" font-size="9" fill="#64748b">ビュー名</text>

                            <!-- 5: DispatcherServlet → ビュー -->
                            <path
                                d="M305 135 L305 210 L190 210"
                                stroke="#0ea5e9"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow-blue)"
                            />

                            <!-- 6: ビュー → クライアント -->
                            <path
                                d="M90 210 L65 210 L65 125"
                                stroke="#64748b"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow-gray)"
                            />
                            <circle cx="38" cy="170" r="14" fill="#ef4444" />
                            <text x="38" y="175" text-anchor="middle" font-size="11" fill="white" font-weight="700">
                                6
                            </text>

                            <defs>
                                <marker
                                    id="arrow-gray"
                                    markerWidth="10"
                                    markerHeight="7"
                                    refX="9"
                                    refY="3.5"
                                    orient="auto"
                                >
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                                </marker>
                                <marker
                                    id="arrow-blue"
                                    markerWidth="10"
                                    markerHeight="7"
                                    refX="9"
                                    refY="3.5"
                                    orient="auto"
                                >
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#0ea5e9" />
                                </marker>
                            </defs>
                        </svg>

                        <!-- 凡例 -->
                        <div style="display: flex; justify-content: center; gap: 40px; margin-top: 24px; flex-wrap: wrap;">
                            <div style="display: flex; align-items: center; gap: 12px; padding: 12px 20px; background: #f0f9ff; border-radius: 8px; border: 2px solid #0ea5e9;">
                                <span style="font-size: 14px; font-weight: 600; color: #0369a1;">Spring MVCが提供</span>
                                <span style="font-size: 12px; color: #64748b;">DispatcherServlet、Model</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px; padding: 12px 20px; background: #fefce8; border-radius: 8px; border: 2px solid #eab308;">
                                <span style="font-size: 14px; font-weight: 600; color: #a16207;">自分で作成</span>
                                <span style="font-size: 12px; color: #64748b;">コントローラ、ビジネスロジック、ビュー</span>
                            </div>
                        </div>
                    </div>

                <!-- 6-1-2 Modelインターフェースとは？ -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-1-2</span>
                        <h3 class="subsection-title">Modelインターフェースとは？</h3>
                    </div>

                    <p>
                        Spring
                        MVCの「Model」インターフェースについて、ビギナーにわかりやすく説明します。一言でいうと、「Model」はデータをWebページに表示するための便利なツールです。
                    </p>

                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>特徴</th>
                                    <th>内容</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>データの運び屋</strong></td>
                                    <td>
                                        「Model」は、プログラムで処理したデータをウェブページ（ビュー）に表示するために使います。要するに、データをビューに渡す「運び屋」のような役割を果たします
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>自動管理</strong></td>
                                    <td>
                                        Spring
                                        MVCがこの「Model」を自動で管理してくれます。つまり、プログラムで使いたいデータを簡単に「設定・取得」ができます
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>使い方が容易</strong></td>
                                    <td>
                                        「Model」を使用する時は、関数（リクエストハンドラメソッド）の引数に「Model型」を指定するだけです。すると、Spring
                                        MVCが勝手に設定してくれます
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- リクエストハンドラメソッドとは -->
                    <div style="margin-top: 30px; padding: 25px; background: #eff6ff; border-radius: 12px; border: 1px solid #93c5fd;">
                        <h4 style="color: #1e40af; margin-bottom: 20px; font-size: 18px;">リクエストハンドラメソッドとは？</h4>

                        <p style="margin-bottom: 20px; color: #1e3a8a; line-height: 1.8;">
                            「リクエストハンドラメソッド」とは、<strong>ブラウザからのリクエスト（URL）に対応して呼び出されるメソッド</strong>のことです。
                            通常のメソッドとは異なり、<code style="background:#bfdbfe; padding:2px 6px; border-radius:4px; color:#1e40af;">@GetMapping</code>や<code style="background:#bfdbfe; padding:2px 6px; border-radius:4px; color:#1e40af;">@PostMapping</code>などのアノテーションを付けることで、Spring MVCが自動的に呼び出してくれます。
                        </p>

                        <!-- 比較図 -->
                        <div class="diagram-container" style="margin: 20px 0;">
                            <div class="diagram-title">通常のメソッド vs リクエストハンドラメソッド</div>
                            <svg viewBox="0 0 750 320" style="max-width: 100%; height: auto;">
                                <defs>
                                    <linearGradient id="normalMethodGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color: #94a3b8" />
                                        <stop offset="100%" style="stop-color: #64748b" />
                                    </linearGradient>
                                    <linearGradient id="handlerMethodGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color: #3b82f6" />
                                        <stop offset="100%" style="stop-color: #1d4ed8" />
                                    </linearGradient>
                                    <linearGradient id="springGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color: #22c55e" />
                                        <stop offset="100%" style="stop-color: #16a34a" />
                                    </linearGradient>
                                    <marker id="arrowNormal" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                                    </marker>
                                    <marker id="arrowSpring" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e" />
                                    </marker>
                                </defs>

                                <!-- 左側：通常のメソッド -->
                                <rect x="20" y="20" width="340" height="280" rx="12" fill="#f8fafc" stroke="#cbd5e1" stroke-width="2" />
                                <rect x="20" y="20" width="340" height="40" rx="12" fill="url(#normalMethodGrad)" />
                                <text x="190" y="47" text-anchor="middle" font-size="14" fill="white" font-weight="bold">通常のメソッド</text>

                                <!-- 通常メソッドのコード -->
                                <rect x="40" y="75" width="280" height="80" rx="8" fill="#1e1e1e" />
                                <text x="55" y="100" font-family="monospace" font-size="11" fill="#9ca3af">// 通常のメソッド</text>
                                <text x="55" y="120" font-family="monospace" font-size="11" fill="#c586c0">public</text>
                                <text x="100" y="120" font-family="monospace" font-size="11" fill="#4ec9b0">String</text>
                                <text x="145" y="120" font-family="monospace" font-size="11" fill="#dcdcaa">sayHello</text>
                                <text x="200" y="120" font-family="monospace" font-size="11" fill="#d4d4d4">() {</text>
                                <text x="65" y="140" font-family="monospace" font-size="11" fill="#c586c0">return</text>
                                <text x="110" y="140" font-family="monospace" font-size="11" fill="#ce9178">"Hello"</text>
                                <text x="160" y="140" font-family="monospace" font-size="11" fill="#d4d4d4">;</text>
                                <text x="55" y="150" font-family="monospace" font-size="11" fill="#d4d4d4">}</text>

                                <!-- 呼び出し方 -->
                                <text x="40" y="180" font-size="12" fill="#475569" font-weight="bold">呼び出し方：</text>
                                <rect x="40" y="190" width="280" height="35" rx="6" fill="#fee2e2" stroke="#fca5a5" stroke-width="1" />
                                <text x="55" y="213" font-family="monospace" font-size="12" fill="#991b1b">自分で呼び出す必要がある</text>

                                <!-- 例 -->
                                <rect x="40" y="235" width="280" height="50" rx="6" fill="#1e1e1e" />
                                <text x="55" y="255" font-family="monospace" font-size="11" fill="#9ca3af">// どこかで自分で呼ぶ</text>
                                <text x="55" y="275" font-family="monospace" font-size="11" fill="#d4d4d4">String result = sayHello();</text>

                                <!-- 右側：リクエストハンドラメソッド -->
                                <rect x="390" y="20" width="340" height="280" rx="12" fill="#eff6ff" stroke="#93c5fd" stroke-width="2" />
                                <rect x="390" y="20" width="340" height="40" rx="12" fill="url(#handlerMethodGrad)" />
                                <text x="560" y="47" text-anchor="middle" font-size="14" fill="white" font-weight="bold">リクエストハンドラメソッド</text>

                                <!-- ハンドラメソッドのコード -->
                                <rect x="410" y="75" width="300" height="80" rx="8" fill="#1e1e1e" />
                                <text x="425" y="95" font-family="monospace" font-size="11" fill="#4ec9b0">@GetMapping</text>
                                <text x="505" y="95" font-family="monospace" font-size="11" fill="#d4d4d4">(</text>
                                <text x="512" y="95" font-family="monospace" font-size="11" fill="#ce9178">"/hello"</text>
                                <text x="565" y="95" font-family="monospace" font-size="11" fill="#d4d4d4">)</text>
                                <text x="425" y="115" font-family="monospace" font-size="11" fill="#c586c0">public</text>
                                <text x="470" y="115" font-family="monospace" font-size="11" fill="#4ec9b0">String</text>
                                <text x="515" y="115" font-family="monospace" font-size="11" fill="#dcdcaa">hello</text>
                                <text x="550" y="115" font-family="monospace" font-size="11" fill="#d4d4d4">() {</text>
                                <text x="435" y="135" font-family="monospace" font-size="11" fill="#c586c0">return</text>
                                <text x="480" y="135" font-family="monospace" font-size="11" fill="#ce9178">"hello"</text>
                                <text x="525" y="135" font-family="monospace" font-size="11" fill="#d4d4d4">;</text>
                                <text x="425" y="150" font-family="monospace" font-size="11" fill="#d4d4d4">}</text>

                                <!-- 呼び出し方 -->
                                <text x="410" y="180" font-size="12" fill="#1e40af" font-weight="bold">呼び出し方：</text>
                                <rect x="410" y="190" width="300" height="35" rx="6" fill="#dcfce7" stroke="#86efac" stroke-width="1" />
                                <text x="425" y="213" font-family="monospace" font-size="12" fill="#166534">Spring MVCが自動で呼び出す</text>

                                <!-- ブラウザからのリクエスト -->
                                <rect x="410" y="235" width="300" height="50" rx="6" fill="#fef3c7" stroke="#fbbf24" stroke-width="1" />
                                <text x="425" y="255" font-size="11" fill="#92400e">ブラウザで以下にアクセスすると呼ばれる：</text>
                                <text x="425" y="275" font-family="monospace" font-size="12" fill="#b45309" font-weight="bold">http://localhost:8080/hello</text>
                            </svg>
                        </div>

                        <!-- 違いの表 -->
                        <div class="table-wrapper" style="margin-top: 20px;">
                            <table>
                                <thead>
                                    <tr>
                                        <th style="width: 25%;">比較項目</th>
                                        <th style="width: 37%;">通常のメソッド</th>
                                        <th style="width: 38%;">リクエストハンドラメソッド</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>アノテーション</strong></td>
                                        <td>不要</td>
                                        <td><code style="background:#dbeafe; padding:2px 6px; border-radius:4px; color:#1e40af;">@GetMapping</code> 等が必要</td>
                                    </tr>
                                    <tr>
                                        <td><strong>呼び出し方</strong></td>
                                        <td>自分でコード内から呼び出す</td>
                                        <td>Spring MVCが<strong>自動</strong>で呼び出す</td>
                                    </tr>
                                    <tr>
                                        <td><strong>呼び出しタイミング</strong></td>
                                        <td>コードで指定した時</td>
                                        <td>ブラウザからURLにアクセスした時</td>
                                    </tr>
                                    <tr>
                                        <td><strong>引数</strong></td>
                                        <td>呼び出す側が渡す</td>
                                        <td>Springが<strong>自動で注入</strong>（Model等）</td>
                                    </tr>
                                    <tr>
                                        <td><strong>戻り値の意味</strong></td>
                                        <td>呼び出し元に返す値</td>
                                        <td><strong>ビュー名</strong>として解釈される</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 主なアノテーション -->
                        <div style="margin-top: 25px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #e2e8f0;">
                            <h5 style="color: #1e40af; margin-bottom: 12px;">主なアノテーション</h5>
                            <div style="display: grid; gap: 10px;">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <code style="background:#dbeafe; padding:4px 10px; border-radius:4px; color:#1e40af; font-weight:bold; min-width: 120px;">@GetMapping</code>
                                    <span style="color: #475569;">GETリクエスト（ページ表示、データ取得）</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <code style="background:#dcfce7; padding:4px 10px; border-radius:4px; color:#166534; font-weight:bold; min-width: 120px;">@PostMapping</code>
                                    <span style="color: #475569;">POSTリクエスト（フォーム送信、データ登録）</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <code style="background:#fef3c7; padding:4px 10px; border-radius:4px; color:#92400e; font-weight:bold; min-width: 120px;">@RequestMapping</code>
                                    <span style="color: #475569;">すべてのHTTPメソッドに対応（汎用的）</span>
                                </div>
                            </div>
                        </div>

                        <!-- ポイント -->
                        <div style="margin-top: 20px; padding: 12px 15px; background: #fef9c3; border-radius: 8px; border-left: 4px solid #eab308;">
                            <p style="margin: 0; color: #854d0e; font-size: 14px;">
                                <strong>💡 ポイント：</strong>リクエストハンドラメソッドの引数に<code style="background:#fef3c7; padding:2px 6px; border-radius:4px;">Model</code>を書くと、Springが自動でインスタンスを渡してくれます。これが「通常のメソッドとの大きな違い」です。
                            </p>
                        </div>
                    </div>

                    <!-- Modelクラスの詳細 -->
                    <div class="info-box" style="margin-top: 25px; background: #fdf4ff; border-left: 4px solid #a855f7;">
                        <h4 style="color: #7c3aed; margin-bottom: 15px;">Modelインターフェースの基本情報</h4>

                        <div style="margin-bottom: 15px;">
                            <strong style="color: #6b21a8;">パッケージとimport</strong>
                            <p style="margin: 8px 0;">Modelを使用するには、以下のimport文が必要です。</p>
                            <pre style="background: #1e1e1e; color: #d4d4d4; padding: 12px 15px; border-radius: 8px; font-size: 13px; overflow-x: auto;"><code><span style="color: #c586c0;">import</span> <span style="color: #4ec9b0;">org.springframework.ui.Model</span>;</code></pre>
                        </div>

                        <div style="margin-bottom: 15px;">
                            <strong style="color: #6b21a8;">インターフェースとは？</strong>
                            <p style="margin: 8px 0;">
                                <code style="background:#f3e8ff; padding:2px 6px; border-radius:4px; color:#7c3aed;">Model</code>は「インターフェース」です。
                                インターフェースとは「こういうメソッドを持っていますよ」という<strong>設計図</strong>のようなものです。
                                実際の処理は、Springが用意した実装クラスが行います。
                            </p>
                        </div>

                        <div>
                            <strong style="color: #6b21a8;">なぜnewしなくていいの？</strong>
                            <p style="margin: 8px 0;">
                                メソッドの引数に<code style="background:#f3e8ff; padding:2px 6px; border-radius:4px; color:#7c3aed;">Model model</code>と書くだけで、
                                Spring MVCが<strong>自動的に</strong>Modelのインスタンスを作成して渡してくれます。
                                これは「DI（依存性の注入）」の仕組みによるものです。
                            </p>
                        </div>
                    </div>

                    <!-- 使用例コード -->
                    <div style="margin-top: 20px;">
                        <p style="font-weight: 500; margin-bottom: 10px;">基本的な使い方</p>
                        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px 20px; border-radius: 10px; font-size: 13px; overflow-x: auto; line-height: 1.6;"><code><span style="color: #c586c0;">import</span> <span style="color: #4ec9b0;">org.springframework.ui.Model</span>;  <span style="color: #6a9955;">// ← importは必要</span>

<span style="color: #4ec9b0;">@Controller</span>
<span style="color: #c586c0;">public class</span> <span style="color: #4ec9b0;">HelloController</span> {

    <span style="color: #4ec9b0;">@GetMapping</span>(<span style="color: #ce9178;">"/hello"</span>)
    <span style="color: #c586c0;">public</span> <span style="color: #4ec9b0;">String</span> <span style="color: #dcdcaa;">hello</span>(<span style="color: #4ec9b0;">Model</span> <span style="color: #9cdcfe;">model</span>) {  <span style="color: #6a9955;">// ← newは不要！Springが自動で渡す</span>
        <span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"msg"</span>, <span style="color: #ce9178;">"Hello World!"</span>);
        <span style="color: #c586c0;">return</span> <span style="color: #ce9178;">"hello"</span>;  <span style="color: #6a9955;">// ← ビュー名を返す</span>
    }
}</code></pre>
                    </div>

                    <!-- Spring MVC内でのModelの動き 図解 -->
                    <div class="diagram-container" style="margin-top: 30px">
                        <div class="diagram-title">図6.3 Spring MVC内でのModelの動き</div>
                        <svg viewBox="0 0 820 480" style="max-width: 100%; height: auto">
                            <defs>
                                <!-- グラデーション定義 -->
                                <linearGradient id="clientGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #60a5fa" />
                                    <stop offset="100%" style="stop-color: #3b82f6" />
                                </linearGradient>
                                <linearGradient id="dispatcherGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #a78bfa" />
                                    <stop offset="100%" style="stop-color: #8b5cf6" />
                                </linearGradient>
                                <linearGradient id="controllerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #fbbf24" />
                                    <stop offset="100%" style="stop-color: #f59e0b" />
                                </linearGradient>
                                <linearGradient id="modelGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #f472b6" />
                                    <stop offset="100%" style="stop-color: #ec4899" />
                                </linearGradient>
                                <linearGradient id="viewGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #34d399" />
                                    <stop offset="100%" style="stop-color: #10b981" />
                                </linearGradient>
                                <!-- 矢印マーカー -->
                                <marker id="arrowModel" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                                </marker>
                                <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6" />
                                </marker>
                                <marker id="arrowPink" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#ec4899" />
                                </marker>
                                <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#10b981" />
                                </marker>
                                <marker id="arrowCyan" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#0ea5e9" />
                                </marker>
                            </defs>

                            <!-- 背景のSpring Framework枠 -->
                            <rect x="160" y="30" width="640" height="380" rx="15" fill="#f8fafc" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5" />
                            <text x="180" y="55" font-size="14" fill="#64748b" font-weight="bold">Spring Framework</text>

                            <!-- ① クライアント（ブラウザ） -->
                            <rect x="20" y="90" width="110" height="70" rx="10" fill="url(#clientGrad)" />
                            <text x="75" y="120" text-anchor="middle" font-size="12" fill="white" font-weight="bold">ブラウザ</text>
                            <text x="75" y="140" text-anchor="middle" font-size="10" fill="white">(クライアント)</text>
                            <circle cx="35" cy="75" r="18" fill="#3b82f6" />
                            <text x="35" y="80" text-anchor="middle" font-size="12" fill="white" font-weight="bold">1</text>

                            <!-- ② DispatcherServlet -->
                            <rect x="200" y="90" width="130" height="70" rx="10" fill="url(#dispatcherGrad)" />
                            <text x="265" y="120" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Dispatcher</text>
                            <text x="265" y="138" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Servlet</text>
                            <circle cx="215" cy="75" r="18" fill="#8b5cf6" />
                            <text x="215" y="80" text-anchor="middle" font-size="12" fill="white" font-weight="bold">2</text>

                            <!-- ③ Controller -->
                            <rect x="400" y="70" width="170" height="100" rx="10" fill="white" stroke="#f59e0b" stroke-width="2" />
                            <rect x="400" y="70" width="170" height="30" rx="10" fill="url(#controllerGrad)" />
                            <text x="485" y="92" text-anchor="middle" font-size="12" fill="white" font-weight="bold">Controller</text>
                            <text x="415" y="120" font-size="10" fill="#64748b" font-family="monospace">@GetMapping</text>
                            <text x="415" y="140" font-size="10" fill="#1e293b" font-family="monospace">public String show(</text>
                            <text x="425" y="158" font-size="10" fill="#ec4899" font-family="monospace" font-weight="bold">Model model</text>
                            <text x="510" y="158" font-size="10" fill="#1e293b" font-family="monospace">)</text>
                            <circle cx="415" cy="55" r="18" fill="#f59e0b" />
                            <text x="415" y="60" text-anchor="middle" font-size="12" fill="white" font-weight="bold">3</text>

                            <!-- ④ Model（データの運び屋） -->
                            <rect x="400" y="210" width="170" height="80" rx="10" fill="white" stroke="#ec4899" stroke-width="2" />
                            <rect x="400" y="210" width="170" height="30" rx="10" fill="url(#modelGrad)" />
                            <text x="485" y="232" text-anchor="middle" font-size="12" fill="white" font-weight="bold">Model（運び屋）</text>
                            <text x="420" y="260" font-size="10" fill="#64748b" font-family="monospace">addAttribute(</text>
                            <text x="420" y="278" font-size="10" fill="#1e293b" font-family="monospace">"msg", "Hello!")</text>
                            <circle cx="415" cy="195" r="18" fill="#ec4899" />
                            <text x="415" y="200" text-anchor="middle" font-size="12" fill="white" font-weight="bold">4</text>

                            <!-- ⑤ View (Thymeleaf) -->
                            <rect x="620" y="210" width="160" height="80" rx="10" fill="white" stroke="#10b981" stroke-width="2" />
                            <rect x="620" y="210" width="160" height="30" rx="10" fill="url(#viewGrad)" />
                            <text x="700" y="232" text-anchor="middle" font-size="12" fill="white" font-weight="bold">View (Thymeleaf)</text>
                            <text x="635" y="260" font-size="10" fill="#64748b" font-family="monospace">&lt;p th:text=</text>
                            <text x="635" y="278" font-size="10" fill="#1e293b" font-family="monospace">"${msg}"&gt;&lt;/p&gt;</text>
                            <circle cx="635" cy="195" r="18" fill="#10b981" />
                            <text x="635" y="200" text-anchor="middle" font-size="12" fill="white" font-weight="bold">5</text>

                            <!-- ⑥ HTML生成・レスポンス -->
                            <rect x="620" y="330" width="160" height="60" rx="10" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2" />
                            <text x="700" y="355" text-anchor="middle" font-size="11" fill="#0369a1" font-weight="bold">HTML レスポンス</text>
                            <text x="700" y="375" text-anchor="middle" font-size="10" fill="#0369a1">&lt;p&gt;Hello!&lt;/p&gt;</text>
                            <circle cx="635" cy="315" r="18" fill="#0ea5e9" />
                            <text x="635" y="320" text-anchor="middle" font-size="12" fill="white" font-weight="bold">6</text>

                            <!-- 矢印：①→② リクエスト -->
                            <path d="M130 125 L190 125" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)" />
                            <text x="160" y="115" text-anchor="middle" font-size="9" fill="#3b82f6">リクエスト</text>

                            <!-- 矢印：②→③ 呼び出し -->
                            <path d="M330 120 L390 120" stroke="#64748b" stroke-width="2" marker-end="url(#arrowModel)" />
                            <text x="360" y="110" text-anchor="middle" font-size="9" fill="#64748b">呼び出し</text>

                            <!-- 矢印：③→④ データ設定 -->
                            <path d="M485 170 L485 200" stroke="#ec4899" stroke-width="2" marker-end="url(#arrowPink)" />
                            <text x="520" y="188" font-size="9" fill="#ec4899">データ設定</text>

                            <!-- 矢印：④→⑤ データ渡し -->
                            <path d="M570 250 L610 250" stroke="#ec4899" stroke-width="2" marker-end="url(#arrowPink)" />
                            <text x="590" y="240" text-anchor="middle" font-size="9" fill="#ec4899">データ渡し</text>

                            <!-- 矢印：⑤→⑥ HTML生成 -->
                            <path d="M700 290 L700 320" stroke="#10b981" stroke-width="2" marker-end="url(#arrowGreen)" />
                            <text x="735" y="308" font-size="9" fill="#10b981">HTML生成</text>

                            <!-- 矢印：⑥→① レスポンス（下部を回る） -->
                            <path d="M620 360 L75 360 L75 170" stroke="#0ea5e9" stroke-width="2" marker-end="url(#arrowCyan)" fill="none" />
                            <text x="350" y="352" text-anchor="middle" font-size="9" fill="#0ea5e9">レスポンス返却</text>

                            <!-- 説明テキスト -->
                            <rect x="180" y="400" width="600" height="50" rx="8" fill="#fef3c7" stroke="#fbbf24" stroke-width="1" />
                            <text x="200" y="420" font-size="11" fill="#92400e" font-weight="bold">ポイント:</text>
                            <text x="200" y="438" font-size="10" fill="#78350f">Modelはコントローラーとビューの間でデータを運ぶ「橋渡し役」です。</text>
                        </svg>
                    </div>

                    <!-- 流れの説明リスト -->
                    <div class="info-box" style="margin-top: 20px; background: #f0f9ff; border-left: 4px solid #0ea5e9;">
                        <h4 style="color: #0369a1; margin-bottom: 15px;">Modelの動き（6つのステップ）</h4>
                        <ol style="margin: 0; padding-left: 20px; line-height: 1.8;">
                            <li><strong>リクエスト送信</strong>：ブラウザからサーバーにリクエストが送られます</li>
                            <li><strong>DispatcherServlet</strong>：Spring MVCの「司令塔」がリクエストを受け取り、適切なコントローラーを探します</li>
                            <li><strong>Controller呼び出し</strong>：対応するメソッドが呼ばれ、引数の<code style="background:#fdf2f8; padding:2px 6px; border-radius:4px; color:#be185d;">Model</code>が自動で渡されます</li>
                            <li><strong>データ設定</strong>：<code style="background:#fdf2f8; padding:2px 6px; border-radius:4px; color:#be185d;">model.addAttribute()</code>でビューに渡したいデータを設定します</li>
                            <li><strong>ビューへデータ渡し</strong>：Modelに格納されたデータがThymeleafテンプレートに渡されます</li>
                            <li><strong>HTML生成・レスポンス</strong>：テンプレートがHTMLを生成し、ブラウザに返します</li>
                        </ol>
                    </div>
                </div>

                <!-- 6-1-3 覚えて欲しいメソッド -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-1-3</span>
                        <h3 class="subsection-title">覚えて欲しいメソッド</h3>
                    </div>

                    <p>
                        「Model」にオブジェクトを格納するためのメソッドは色々用意されていますが、まずは以下を覚えてください。
                    </p>

                    <div class="th-attr-card">
                        <span class="th-attr-name">addAttribute</span>
                        <p>
                            指定された名前に対して、指定された値を設定します。格納したい値に対して、ニックネームを付けているイメージです。「ビュー」ではニックネームに使用した「名前」を利用します。
                        </p>

                        <!-- 図6.2 「名前」を使用する -->
                        <div class="diagram-container" style="margin-top: 20px">
                            <div class="diagram-title">図6.2 「名前」を使用する</div>
                            <svg viewBox="0 0 600 200" style="max-width: 100%; height: auto">
                                <defs>
                                    <linearGradient id="methodGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color: #fbbf24" />
                                        <stop offset="100%" style="stop-color: #f59e0b" />
                                    </linearGradient>
                                    <linearGradient id="templateGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color: #10b981" />
                                        <stop offset="100%" style="stop-color: #059669" />
                                    </linearGradient>
                                </defs>

                                <!-- リクエストハンドラメソッド -->
                                <rect
                                    x="20"
                                    y="30"
                                    width="250"
                                    height="130"
                                    rx="12"
                                    fill="white"
                                    stroke="#fbbf24"
                                    stroke-width="2"
                                />
                                <rect x="20" y="30" width="250" height="35" rx="12" fill="url(#methodGrad)" />
                                <text
                                    x="145"
                                    y="54"
                                    text-anchor="middle"
                                    font-size="11"
                                    fill="white"
                                    font-weight="bold"
                                >
                                    リクエストハンドラメソッド
                                </text>

                                <text x="35" y="85" font-size="10" fill="#64748b">// 「Model」にデータを格納する</text>
                                <text x="35" y="105" font-size="11" fill="#1e293b" font-family="monospace">
                                    model.addAttribute(
                                </text>
                                <text x="55" y="125" font-size="11" fill="#e11d48" font-family="monospace">"msg"</text>
                                <text x="100" y="125" font-size="11" fill="#1e293b" font-family="monospace">,</text>
                                <text x="115" y="125" font-size="11" fill="#059669" font-family="monospace">
                                    "タイムリーフ!!!"
                                </text>
                                <text x="215" y="125" font-size="11" fill="#1e293b" font-family="monospace">);</text>

                                <!-- 矢印 -->
                                <path
                                    d="M270 95 L330 95"
                                    stroke="#0ea5e9"
                                    stroke-width="3"
                                    marker-end="url(#arrowhead2)"
                                />
                                <text
                                    x="300"
                                    y="85"
                                    text-anchor="middle"
                                    font-size="10"
                                    fill="#0ea5e9"
                                    font-weight="bold"
                                >
                                    バインド
                                </text>

                                <defs>
                                    <marker
                                        id="arrowhead2"
                                        markerWidth="10"
                                        markerHeight="7"
                                        refX="9"
                                        refY="3.5"
                                        orient="auto"
                                    >
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#0ea5e9" />
                                    </marker>
                                </defs>

                                <!-- テンプレート -->
                                <rect
                                    x="330"
                                    y="30"
                                    width="250"
                                    height="130"
                                    rx="12"
                                    fill="white"
                                    stroke="#10b981"
                                    stroke-width="2"
                                />
                                <rect x="330" y="30" width="250" height="35" rx="12" fill="url(#templateGrad)" />
                                <text
                                    x="455"
                                    y="54"
                                    text-anchor="middle"
                                    font-size="12"
                                    fill="white"
                                    font-weight="bold"
                                >
                                    テンプレート
                                </text>

                                <text x="345" y="85" font-size="11" fill="#64748b" font-family="monospace">
                                    &lt;body&gt;
                                </text>
                                <text x="355" y="110" font-size="11" fill="#1e293b" font-family="monospace">
                                    &lt;h1 th:text=
                                </text>
                                <text x="445" y="110" font-size="11" fill="#e11d48" font-family="monospace">
                                    "${msg}"
                                </text>
                                <text x="505" y="110" font-size="11" fill="#1e293b" font-family="monospace">&gt;</text>
                                <text x="365" y="130" font-size="11" fill="#64748b" font-family="monospace">
                                    表示される部分&lt;/h1&gt;
                                </text>
                                <text x="345" y="150" font-size="11" fill="#64748b" font-family="monospace">
                                    &lt;/body&gt;
                                </text>
                            </svg>
                        </div>
                    </div>

                    <p>
                        メソッドを使用することができます。「addAttribute」メソッドでは、引数で「名前：msg」、「値：タイムリーフ!!!」を格納します。
                    </p>

                    <!-- addAttributeの詳細説明 -->
                    <div style="margin-top: 25px; padding: 20px; background: #fffbeb; border: 1px solid #fbbf24; border-radius: 10px;">
                        <h4 style="color: #b45309; margin-bottom: 15px;">addAttribute メソッドの詳細</h4>

                        <!-- 構文1 -->
                        <div style="margin-bottom: 20px;">
                            <p style="font-weight: 600; color: #92400e; margin-bottom: 8px;">構文1：名前と値を指定（基本形）</p>
                            <pre style="background: #1e1e1e; color: #d4d4d4; padding: 12px 15px; border-radius: 8px; font-size: 13px;"><code><span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"名前"</span>, <span style="color: #9cdcfe;">値</span>);</code></pre>
                            <p style="margin-top: 8px; color: #78350f; font-size: 14px;">
                                第1引数の「名前」はビュー側で<code style="background:#fef3c7; padding:2px 6px; border-radius:4px;">${名前}</code>として使用します。
                            </p>
                            <pre style="background: #1e1e1e; color: #d4d4d4; padding: 12px 15px; border-radius: 8px; font-size: 13px; margin-top: 10px;"><code><span style="color: #6a9955;">// 例：文字列を渡す</span>
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"message"</span>, <span style="color: #ce9178;">"こんにちは"</span>);

<span style="color: #6a9955;">// 例：数値を渡す</span>
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"count"</span>, <span style="color: #b5cea8;">100</span>);

<span style="color: #6a9955;">// 例：オブジェクトを渡す</span>
<span style="color: #4ec9b0;">User</span> <span style="color: #9cdcfe;">user</span> = <span style="color: #c586c0;">new</span> <span style="color: #4ec9b0;">User</span>(<span style="color: #ce9178;">"田中"</span>, <span style="color: #b5cea8;">25</span>);
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"user"</span>, <span style="color: #9cdcfe;">user</span>);</code></pre>
                        </div>

                        <!-- 構文2 -->
                        <div>
                            <p style="font-weight: 600; color: #92400e; margin-bottom: 8px;">構文2：値のみを指定（名前を省略）</p>
                            <pre style="background: #1e1e1e; color: #d4d4d4; padding: 12px 15px; border-radius: 8px; font-size: 13px;"><code><span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #9cdcfe;">値</span>);</code></pre>
                            <p style="margin-top: 8px; color: #78350f; font-size: 14px;">
                                名前を省略すると、<strong>クラス名の先頭を小文字にした名前</strong>が自動で付けられます。
                            </p>
                            <pre style="background: #1e1e1e; color: #d4d4d4; padding: 12px 15px; border-radius: 8px; font-size: 13px; margin-top: 10px;"><code><span style="color: #6a9955;">// Userクラスの場合 → 名前は「user」になる</span>
<span style="color: #4ec9b0;">User</span> <span style="color: #9cdcfe;">user</span> = <span style="color: #c586c0;">new</span> <span style="color: #4ec9b0;">User</span>(<span style="color: #ce9178;">"田中"</span>, <span style="color: #b5cea8;">25</span>);
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #9cdcfe;">user</span>);  <span style="color: #6a9955;">// ビューでは ${user} で参照</span>

<span style="color: #6a9955;">// String型の場合 → 名前は「string」になる</span>
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"Hello"</span>);  <span style="color: #6a9955;">// ビューでは ${string} で参照</span></code></pre>
                            <p style="margin-top: 10px; padding: 8px 12px; background: #fef9c3; border-radius: 6px; font-size: 13px; color: #854d0e;">
                                <strong>💡 ヒント：</strong>初心者のうちは、わかりやすい「構文1（名前を明示）」を使うことをおすすめします。
                            </p>
                        </div>
                    </div>

                    <!-- その他のメソッド -->
                    <div style="margin-top: 30px;">
                        <h4 style="color: #1e40af; margin-bottom: 15px;">その他のメソッド（参考）</h4>
                        <p style="margin-bottom: 15px; color: #64748b;">
                            addAttribute以外にも便利なメソッドがあります。必要に応じて使ってみましょう。
                        </p>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th style="width: 35%;">メソッド</th>
                                        <th>説明</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code style="background:#dbeafe; padding:3px 8px; border-radius:4px; color:#1e40af; font-size:12px;">containsAttribute(String name)</code></td>
                                        <td>
                                            指定した名前の属性がModelに存在するかを確認します。<br>
                                            <span style="color: #64748b; font-size: 13px;">戻り値：true（存在する）/ false（存在しない）</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><code style="background:#dbeafe; padding:3px 8px; border-radius:4px; color:#1e40af; font-size:12px;">getAttribute(String name)</code></td>
                                        <td>
                                            指定した名前の属性値を取得します。<br>
                                            <span style="color: #64748b; font-size: 13px;">戻り値：Object型（存在しない場合はnull）</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><code style="background:#dbeafe; padding:3px 8px; border-radius:4px; color:#1e40af; font-size:12px;">addAllAttributes(Map&lt;String, ?&gt;)</code></td>
                                        <td>
                                            Mapの全要素をまとめてModelに追加します。<br>
                                            <span style="color: #64748b; font-size: 13px;">複数のデータを一度に設定したい場合に便利です</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><code style="background:#dbeafe; padding:3px 8px; border-radius:4px; color:#1e40af; font-size:12px;">asMap()</code></td>
                                        <td>
                                            Model内のすべての属性をMap形式で取得します。<br>
                                            <span style="color: #64748b; font-size: 13px;">デバッグ時に中身を確認したい場合などに使えます</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 使用例 -->
                        <div style="margin-top: 20px;">
                            <p style="font-weight: 500; margin-bottom: 10px; color: #374151;">使用例</p>
                            <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px 20px; border-radius: 10px; font-size: 13px; overflow-x: auto; line-height: 1.6;"><code><span style="color: #4ec9b0;">@GetMapping</span>(<span style="color: #ce9178;">"/example"</span>)
<span style="color: #c586c0;">public</span> <span style="color: #4ec9b0;">String</span> <span style="color: #dcdcaa;">example</span>(<span style="color: #4ec9b0;">Model</span> <span style="color: #9cdcfe;">model</span>) {
    <span style="color: #6a9955;">// データを追加</span>
    <span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"name"</span>, <span style="color: #ce9178;">"山田太郎"</span>);
    <span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"age"</span>, <span style="color: #b5cea8;">30</span>);

    <span style="color: #6a9955;">// 属性が存在するかチェック</span>
    <span style="color: #c586c0;">if</span> (<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">containsAttribute</span>(<span style="color: #ce9178;">"name"</span>)) {
        <span style="color: #4ec9b0;">System</span>.out.<span style="color: #dcdcaa;">println</span>(<span style="color: #ce9178;">"nameは設定済みです"</span>);
    }

    <span style="color: #6a9955;">// 属性の値を取得</span>
    <span style="color: #4ec9b0;">Object</span> <span style="color: #9cdcfe;">nameValue</span> = <span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">getAttribute</span>(<span style="color: #ce9178;">"name"</span>);
    <span style="color: #4ec9b0;">System</span>.out.<span style="color: #dcdcaa;">println</span>(<span style="color: #9cdcfe;">nameValue</span>);  <span style="color: #6a9955;">// 出力: 山田太郎</span>

    <span style="color: #c586c0;">return</span> <span style="color: #ce9178;">"example"</span>;
}</code></pre>
                        </div>
                    </div>

                    <!-- Object型の説明 -->
                    <div class="info-box" style="margin-top: 25px; background: #f0f9ff; border-left: 4px solid #0ea5e9;">
                        <h4>📦 Object型とは？</h4>
                        <p style="margin-bottom: 15px;">
                            <strong>Object型</strong>は、Javaにおける<strong>すべてのクラスの親（スーパークラス）</strong>です。
                            つまり、String、Integer、List、自作クラスなど、Java のすべてのオブジェクトは Object型として扱うことができます。
                        </p>
                        <div style="background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <p style="font-weight: 500; margin-bottom: 10px; color: #374151;">イメージ図</p>
                            <pre style="background: #f8fafc; padding: 15px; border-radius: 8px; font-size: 13px; line-height: 1.8; margin: 0;">
        Object （すべての型の親）
           ├── String （文字列）
           ├── Integer （整数）
           ├── List （リスト）
           └── その他すべてのクラス...</pre>
                        </div>
                        <p style="margin-bottom: 10px;">
                            <strong>なぜObject型が必要？</strong><br>
                            「どんな型のデータが来るかわからない」場合に、Object型を使うことで柔軟に対応できます。
                        </p>
                    </div>

                    <!-- getAttributeがObject型を返す理由 -->
                    <div class="info-box" style="margin-top: 20px; background: #fefce8; border-left: 4px solid #eab308;">
                        <h4>💡 model.getAttribute() が Object型を返す理由</h4>
                        <p style="margin-bottom: 15px;">
                            <code style="background:#dbeafe; padding:3px 8px; border-radius:4px; color:#1e40af;">getAttribute()</code> メソッドは、
                            Modelに保存されたデータを取り出すメソッドですが、<strong>戻り値はObject型</strong>です。
                        </p>
                        <p style="margin-bottom: 15px;">
                            これは、Modelには<strong>様々な型のデータ</strong>（String、Integer、List、独自クラスなど）を保存できるため、
                            「どんな型でも受け取れる」Object型で返すように設計されているからです。
                        </p>
                        <div style="background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <p style="font-weight: 500; margin-bottom: 10px; color: #374151;">具体例</p>
                            <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; font-size: 13px; line-height: 1.6;"><code><span style="color: #6a9955;">// Modelには色々な型を保存できる</span>
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"name"</span>, <span style="color: #ce9178;">"山田太郎"</span>);     <span style="color: #6a9955;">// String型</span>
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"age"</span>, <span style="color: #b5cea8;">30</span>);               <span style="color: #6a9955;">// Integer型</span>
<span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"items"</span>, <span style="color: #9cdcfe;">itemList</span>);      <span style="color: #6a9955;">// List型</span>

<span style="color: #6a9955;">// 取り出すときはObject型で返ってくる</span>
<span style="color: #4ec9b0;">Object</span> <span style="color: #9cdcfe;">value</span> = <span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">getAttribute</span>(<span style="color: #ce9178;">"name"</span>);

<span style="color: #6a9955;">// 元の型として使いたい場合はキャスト（型変換）が必要</span>
<span style="color: #4ec9b0;">String</span> <span style="color: #9cdcfe;">name</span> = (<span style="color: #4ec9b0;">String</span>) <span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">getAttribute</span>(<span style="color: #ce9178;">"name"</span>);</code></pre>
                        </div>
                        <p style="color: #64748b; font-size: 13px;">
                            ※ 実際の開発では、Thymeleafがビュー側で自動的に型を処理してくれるため、
                            コントローラー内で<code style="background:#e2e8f0; padding:2px 6px; border-radius:4px;">getAttribute()</code>を使う機会は少ないです。
                        </p>
                    </div>

                    <div class="info-box warning" style="margin-top: 25px;">
                        <h4>⚠️ インポートについて</h4>
                        <p>
                            もしソースコードに「×印」が出た場合は、インポートの編成を行い、「import
                            org.springframework.ui.Model;」をインポートしてください。
                        </p>
                    </div>
                </div>
            </section>

            <!-- Section 6-2 -->
            <section id="section-6-2" class="section">
                <div class="section-header">
                    <span class="section-number">Section 6-2</span>
                    <h2 class="section-title">Modelを使ったプログラムを作成しよう</h2>
                </div>

                <!-- プロジェクトの作成 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-2-1</span>
                        <h3 class="subsection-title">プロジェクトの作成</h3>
                    </div>

                    <p>
                        Spring Initializrを使用してプロジェクトを作成します。ブラウザで <a href="https://start.spring.io" target="_blank" style="color: #3b82f6; font-weight: bold;">https://start.spring.io</a> にアクセスしてください。
                    </p>

                    <!-- 設定値テーブル -->
                    <div class="table-wrapper" style="margin-top: 25px;">
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 30%;">設定項目</th>
                                    <th>値</th>
                                    <th style="width: 35%;">説明</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Project</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">Maven</code></td>
                                    <td>ビルドツール</td>
                                </tr>
                                <tr>
                                    <td><strong>Language</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">Java</code></td>
                                    <td>プログラミング言語</td>
                                </tr>
                                <tr>
                                    <td><strong>Spring Boot</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">3.4.x</code></td>
                                    <td>最新の安定版を選択</td>
                                </tr>
                                <tr>
                                    <td><strong>Artifact</strong></td>
                                    <td><code style="background:#fef3c7; padding:2px 8px; border-radius:4px; color:#92400e;">SpringMVCViewSample</code></td>
                                    <td>プロジェクト名</td>
                                </tr>
                                <tr>
                                    <td><strong>Packaging</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">Jar</code></td>
                                    <td>パッケージ形式</td>
                                </tr>
                                <tr>
                                    <td><strong>Java</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">21</code></td>
                                    <td>Javaバージョン</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Dependencies -->
                    <div style="margin-top: 20px; padding: 20px; background: #ecfdf5; border-radius: 10px; border: 1px solid #6ee7b7;">
                        <h5 style="color: #065f46; margin-bottom: 15px;">追加する Dependencies（依存関係）</h5>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            <span style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: white; border-radius: 20px; border: 2px solid #10b981; color: #065f46; font-weight: 500;">
                                <span style="color: #10b981;">✓</span> Spring Web
                            </span>
                            <span style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: white; border-radius: 20px; border: 2px solid #10b981; color: #065f46; font-weight: 500;">
                                <span style="color: #10b981;">✓</span> Thymeleaf
                            </span>
                            <span style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: white; border-radius: 20px; border: 2px solid #10b981; color: #065f46; font-weight: 500;">
                                <span style="color: #10b981;">✓</span> Spring Boot DevTools
                            </span>
                        </div>
                    </div>
                </div>

                <!-- th:text 表 -->
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>書式</th>
                                <th>説明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>&lt;タグ名 th:text="文字列"&gt;&lt;/タグ名&gt;</code></td>
                                <td>文字列を表示する</td>
                            </tr>
                            <tr>
                                <td><code>&lt;タグ名 th:text="${名前}"&gt;&lt;/タグ名&gt;</code></td>
                                <td>設定した「名前」で「値」を表示する</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- コントローラーの作成 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-2-2</span>
                        <h3 class="subsection-title">コントローラーの作成</h3>
                    </div>

                    <p>
                        Modelを使用してビューにデータを渡すコントローラーを作成します。controllerフォルダに「HelloViewController.java」を作成してください。
                    </p>

                    <!-- VSCode手順 -->
                    <div style="margin: 15px 0; padding: 20px; background: #fff7ed; border-radius: 10px; border: 1px solid #fdba74;">
                        <h5 style="color: #c2410c; margin-bottom: 15px;">VSCodeでのフォルダ・ファイル作成手順</h5>
                        <ol style="margin: 0; padding-left: 20px; line-height: 2; color: #9a3412;">
                            <li><code style="background:#fed7aa; padding:2px 8px; border-radius:4px; color:#9a3412;">src/main/java/com/example/demo</code> フォルダを右クリック</li>
                            <li>「<strong>新しいフォルダー</strong>」を選択し、<code style="background:#fef3c7; padding:2px 8px; border-radius:4px; color:#92400e;">controller</code> と入力</li>
                            <li>作成した <code style="background:#fed7aa; padding:2px 8px; border-radius:4px; color:#9a3412;">controller</code> フォルダを右クリック</li>
                            <li>「<strong>新しいファイル</strong>」を選択</li>
                            <li>ファイル名を <code style="background:#fef3c7; padding:2px 8px; border-radius:4px; color:#92400e;">HelloViewController.java</code> として作成</li>
                        </ol>
                    </div>

                    <div class="prompt-box">
                        <div class="prompt-box-header">
                            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
                            <span class="prompt-box-title">プロンプト</span>
                            <button class="prompt-copy-btn">コピー</button>
                        </div>
                        <div class="prompt-box-content">
                            <pre><code>## 機能
Modelを使用してビューにデータを渡すコントローラを作成

## 実装要件
- URLパス「/hello/model」へのGETリクエストを処理
- Modelにメッセージ「タイムリーフ!!!」を「msg」という名前で格納
- ビュー名「helloThymeleaf」を返す

## 使用するSpring構文/アノテーション
- @Controller
- @GetMapping
- Model.addAttribute()</code></pre>
                        </div>
                    </div>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">リスト6.1 HelloViewController.java</span>
                            <span class="code-lang">Java</span>
                        </div>
                        <div class="code-content">
                            <pre><span style="color: #c586c0;">package</span> <span style="color: #4ec9b0;">com.example.demo.controller</span>;

<span style="color: #c586c0;">import</span> <span style="color: #4ec9b0;">org.springframework.stereotype.Controller</span>;
<span style="color: #c586c0;">import</span> <span style="color: #4ec9b0;">org.springframework.ui.Model</span>;
<span style="color: #c586c0;">import</span> <span style="color: #4ec9b0;">org.springframework.web.bind.annotation.GetMapping</span>;

<span style="color: #4ec9b0;">@Controller</span>
<span style="color: #c586c0;">public class</span> <span style="color: #4ec9b0;">HelloViewController</span> {

    <span style="color: #4ec9b0;">@GetMapping</span>(<span style="color: #ce9178;">"/hello/model"</span>)
    <span style="color: #c586c0;">public</span> <span style="color: #4ec9b0;">String</span> <span style="color: #dcdcaa;">helloView</span>(<span style="color: #4ec9b0;">Model</span> <span style="color: #9cdcfe;">model</span>) {
        <span style="color: #9cdcfe;">model</span>.<span style="color: #dcdcaa;">addAttribute</span>(<span style="color: #ce9178;">"msg"</span>, <span style="color: #ce9178;">"タイムリーフ!!!"</span>);
        <span style="color: #c586c0;">return</span> <span style="color: #ce9178;">"helloThymeleaf"</span>;
    }
}</pre>
                        </div>
                    </div>

                    <div class="info-box" style="margin-top: 20px;">
                        <h4>コード解説</h4>
                        <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                            <li><code style="background:#dbeafe; padding:2px 6px; border-radius:4px; color:#1e40af;">@Controller</code>：このクラスがコントローラーであることを示します</li>
                            <li><code style="background:#dbeafe; padding:2px 6px; border-radius:4px; color:#1e40af;">@GetMapping("/hello/model")</code>：URLパス「/hello/model」へのGETリクエストを処理します</li>
                            <li><code style="background:#dbeafe; padding:2px 6px; border-radius:4px; color:#1e40af;">Model model</code>：ビューにデータを渡すためのオブジェクトを受け取ります</li>
                            <li><code style="background:#dbeafe; padding:2px 6px; border-radius:4px; color:#1e40af;">addAttribute("msg", "タイムリーフ!!!")</code>：「msg」という名前で値を設定します（ビューの<code>${msg}</code>と対応）</li>
                            <li><code style="background:#dbeafe; padding:2px 6px; border-radius:4px; color:#1e40af;">return "helloThymeleaf"</code>：ビュー名を返します（templates/helloThymeleaf.htmlと対応）</li>
                        </ul>
                    </div>
                </div>

                <!-- ビューの作成 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-2-3</span>
                        <h3 class="subsection-title">ビューの作成</h3>
                    </div>

                    <p>
                        「helloView」メソッドの戻り値「ビュー名：helloThymeleaf」に対する「helloThymeleaf.html」を作成し、「resources/templates」フォルダに配置します。
                    </p>

                    <!-- VSCode手順 -->
                    <div style="margin: 15px 0; padding: 20px; background: #eff6ff; border-radius: 10px; border: 1px solid #93c5fd;">
                        <h5 style="color: #1e40af; margin-bottom: 15px;">VSCodeでのファイル作成手順</h5>
                        <ol style="margin: 0; padding-left: 20px; line-height: 2; color: #1e3a8a;">
                            <li><code style="background:#dbeafe; padding:2px 8px; border-radius:4px; color:#1e40af;">src/main/resources/templates</code> フォルダを右クリック</li>
                            <li>「<strong>新しいファイル</strong>」を選択</li>
                            <li>ファイル名を <code style="background:#fef3c7; padding:2px 8px; border-radius:4px; color:#92400e;">helloThymeleaf.html</code> として作成</li>
                        </ol>
                    </div>

                    <!-- フォルダ構造図解 -->
                    <div class="diagram-container" style="margin: 25px 0;">
                        <div class="diagram-title">Spring Bootプロジェクトのフォルダ構成</div>
                        <svg viewBox="0 0 750 400" style="max-width: 100%; height: auto;">
                            <defs>
                                <linearGradient id="templatesGrad2" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #8b5cf6" />
                                    <stop offset="100%" style="stop-color: #7c3aed" />
                                </linearGradient>
                                <linearGradient id="staticGrad2" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #f59e0b" />
                                    <stop offset="100%" style="stop-color: #d97706" />
                                </linearGradient>
                            </defs>

                            <!-- 外枠 -->
                            <rect x="5" y="5" width="740" height="390" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" />

                            <!-- 左側：フォルダツリー（黒背景） -->
                            <rect x="20" y="20" width="320" height="360" rx="10" fill="#1e1e1e" />

                            <!-- フォルダツリーのテキスト -->
                            <text x="35" y="50" font-family="monospace" font-size="13" fill="#e5e5e5">SpringMVCViewSample/</text>
                            <text x="47" y="72" font-family="monospace" font-size="13" fill="#9ca3af">src/</text>
                            <text x="59" y="94" font-family="monospace" font-size="13" fill="#9ca3af">main/</text>
                            <text x="71" y="116" font-family="monospace" font-size="13" fill="#9ca3af">java/</text>
                            <text x="83" y="138" font-family="monospace" font-size="13" fill="#94a3b8">com/example/demo/</text>
                            <text x="95" y="160" font-family="monospace" font-size="13" fill="#fbbf24">controller/</text>
                            <text x="107" y="182" font-family="monospace" font-size="13" fill="#f97316">HelloViewController.java</text>
                            <text x="71" y="208" font-family="monospace" font-size="13" fill="#9ca3af">resources/</text>

                            <!-- templates バッジ -->
                            <rect x="83" y="220" width="90" height="22" rx="4" fill="url(#templatesGrad2)" />
                            <text x="95" y="236" font-family="monospace" font-size="12" fill="white" font-weight="bold">templates/</text>

                            <text x="95" y="260" font-family="monospace" font-size="13" fill="#22c55e">helloThymeleaf.html</text>
                            <text x="248" y="260" font-family="monospace" font-size="11" fill="#6b7280">← ビュー</text>

                            <!-- static バッジ -->
                            <rect x="83" y="278" width="65" height="22" rx="4" fill="url(#staticGrad2)" />
                            <text x="93" y="294" font-family="monospace" font-size="12" fill="white" font-weight="bold">static/</text>

                            <text x="95" y="318" font-family="monospace" font-size="13" fill="#60a5fa">css/</text>
                            <text x="107" y="340" font-family="monospace" font-size="13" fill="#38bdf8">style.css</text>
                            <text x="95" y="362" font-family="monospace" font-size="13" fill="#facc15">js/</text>

                            <!-- 右側：配置ルール -->
                            <rect x="360" y="20" width="370" height="360" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1" />

                            <text x="380" y="55" font-size="16" fill="#1e293b" font-weight="bold">配置ルール</text>

                            <!-- templates 説明 -->
                            <rect x="380" y="75" width="90" height="26" rx="5" fill="url(#templatesGrad2)" />
                            <text x="395" y="94" font-size="13" fill="white" font-weight="bold">templates</text>

                            <text x="480" y="88" font-size="13" fill="#374151">HTMLファイル（ビュー）を配置</text>
                            <text x="395" y="115" font-size="12" fill="#6b7280">戻り値：</text>
                            <rect x="450" y="102" width="70" height="20" rx="4" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1" />
                            <text x="462" y="117" font-family="monospace" font-size="11" fill="#374151">"hello"</text>

                            <!-- static 説明 -->
                            <rect x="380" y="145" width="65" height="26" rx="5" fill="url(#staticGrad2)" />
                            <text x="391" y="164" font-size="13" fill="white" font-weight="bold">static</text>

                            <text x="455" y="152" font-size="13" fill="#374151">CSS、JavaScript、画像を配置</text>
                            <text x="455" y="172" font-size="12" fill="#6b7280">直接アクセス可能</text>

                            <!-- サブフォルダ使用時 -->
                            <rect x="380" y="200" width="330" height="90" rx="8" fill="#fef9c3" stroke="#fbbf24" stroke-width="1" />
                            <text x="395" y="225" font-size="14" fill="#92400e" font-weight="bold">サブフォルダ使用時</text>

                            <text x="395" y="252" font-family="monospace" font-size="12" fill="#1e293b">user/login.html</text>

                            <text x="395" y="278" font-size="12" fill="#64748b">→ 戻り値：</text>
                            <rect x="470" y="264" width="100" height="22" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1" />
                            <text x="482" y="280" font-family="monospace" font-size="11" fill="#92400e">"user/login"</text>

                            <!-- 今回作成するファイル -->
                            <rect x="380" y="305" width="330" height="60" rx="8" fill="#ecfdf5" stroke="#10b981" stroke-width="2" />
                            <text x="395" y="330" font-size="13" fill="#065f46" font-weight="bold">今回作成するファイル</text>
                            <text x="395" y="352" font-family="monospace" font-size="12" fill="#047857">templates/helloThymeleaf.html</text>
                        </svg>
                    </div>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">リスト6.2 helloThymeleaf.html</span>
                            <span class="code-lang">HTML</span>
                        </div>
                        <div class="code-content">
                            <pre><span class="tag">&lt;!DOCTYPE html&gt;</span>
<span class="code-comment">&lt;!-- Thymeleafを使用することを宣言する --&gt;</span>
<span class="tag">&lt;html</span> <span class="attr">xmlns:th</span>=<span class="value">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span>
<span class="tag">&lt;head&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attr">charset</span>=<span class="value">"UTF-8"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;title&gt;</span>Hello Thymeleaf<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;/head&gt;</span>
<span class="tag">&lt;body&gt;</span>
    <span class="tag">&lt;h1</span> <span class="attr">th:text</span>=<span class="value">"${msg}"</span><span class="tag">&gt;</span>表示される部分<span class="tag">&lt;/h1&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre>
                        </div>
                    </div>

                    <p>
                        3行目に「Thymeleafを使用することを宣言」します。「Thymeleaf」の機能は「th:xxx属性名」の形式で埋め込みます。9行目で&lt;h1&gt;タグの内側に「th:text」属性を埋め込みます。th:textの使用メソッドを使用することができます。
                    </p>
                </div>

                <!-- 実行と確認 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-2-4</span>
                        <h3 class="subsection-title">実行と確認</h3>
                    </div>

                    <div class="info-box success">
                        <h4>🌿 ナチュラルテンプレート</h4>
                        <p>
                            Thymeleafは「ナチュラルテンプレート」とも呼ばれ、テンプレートをそのままのHTMLとしても見れるという利点があります。その利点を確認してみましょう。
                        </p>
                        <p>
                            VSCodeでHTMLファイルを直接プレビューするには、<code style="background:#e0e7ff; padding:2px 8px; border-radius:4px; color:#3730a3;">helloThymeleaf.html</code> を右クリックし、「<strong>Open with Live Server</strong>」を選択するか、ファイルを直接ブラウザにドラッグ＆ドロップします。
                        </p>
                    </div>

                    <p>
                        &lt;h1&gt;タグで囲まれた「表示される部分」という文字がブラウザに表示されます。これはアプリケーションを起動せずファイルの内容を表示しています。
                    </p>
                    <p>デザイン担当は、このような形で「ナチュラルテンプレート」を利用してデザインを調整します。</p>

                    <div class="info-box">
                        <h4>🚀 アプリケーション起動</h4>
                        <p>今度は、アプリケーションを起動して確認を行います。</p>

                        <!-- VSCode起動手順 -->
                        <div style="margin: 15px 0; padding: 15px; background: #E0F7FA; border-radius: 8px; border: 1px solid #86efac;">
                            <div style="color: #14532d;">
                                <p style="margin-bottom: 10px;"><strong>方法1: Spring Boot Dashboard を使用</strong></p>
                                <ol style="margin: 0 0 15px 0; padding-left: 20px; line-height: 2;">
                                    <li>左サイドバーの「<strong>Spring Boot Dashboard</strong>」アイコンをクリック</li>
                                    <li>プロジェクト名を右クリック →「<strong>Run</strong>」を選択</li>
                                </ol>
                                <p style="margin-bottom: 10px;"><strong>方法2: ターミナルを使用</strong></p>
                                <div style="background: #1e1e1e; padding: 10px 15px; border-radius: 6px; font-family: monospace; color: #4ade80;">
                                    ./mvnw spring-boot:run
                                </div>
                            </div>
                        </div>

                        <p style="margin-top: 15px;">
                            ターミナルに「Started ...Application」と表示されたら起動完了です。ブラウザを開き、アドレスバーに「<code style="background:#e0e7ff; padding:2px 8px; border-radius:4px; color:#3730a3;">http://localhost:8080/hello/model</code>」と入力してください。ブラウザに「タイムリーフ!!!」と表示されます。
                        </p>
                    </div>

                    <!-- 処理の流れ図 -->
                    <div class="diagram-container">
                        <div class="diagram-title">図6.7 処理の流れ</div>
                        <svg viewBox="0 0 750 320" style="max-width: 100%; height: auto">
                            <defs>
                                <linearGradient id="reqGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #06b6d4" />
                                    <stop offset="100%" style="stop-color: #0891b2" />
                                </linearGradient>
                                <linearGradient id="ctrlGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #f97316" />
                                    <stop offset="100%" style="stop-color: #ea580c" />
                                </linearGradient>
                                <linearGradient id="tmplGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #8b5cf6" />
                                    <stop offset="100%" style="stop-color: #7c3aed" />
                                </linearGradient>
                                <linearGradient id="engineGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #10b981" />
                                    <stop offset="100%" style="stop-color: #059669" />
                                </linearGradient>
                            </defs>

                            <!-- リクエスト -->
                            <rect x="20" y="10" width="100" height="60" rx="10" fill="url(#reqGrad)" />
                            <text x="70" y="35" text-anchor="middle" font-size="11" fill="white" font-weight="bold">
                                リクエスト
                            </text>
                            <text x="70" y="55" text-anchor="middle" font-size="9" fill="#e0f2fe">
                                GET /hello/model
                            </text>

                            <!-- 矢印1 -->
                            <line
                                x1="120"
                                y1="40"
                                x2="195"
                                y2="40"
                                stroke="#64748b"
                                stroke-width="2"
                                marker-end="url(#arrow3)"
                            />
                            <circle cx="148" cy="38" r="12" fill="#64748b" />
                            <text x="148" y="42" text-anchor="middle" font-size="10" fill="white" font-weight="bold">
                                1
                            </text>

                            <!-- コントローラ -->
                            <rect
                                x="200"
                                y="10"
                                width="210"
                                height="120"
                                rx="10"
                                fill="white"
                                stroke="#f97316"
                                stroke-width="2"
                            />
                            <rect x="200" y="10" width="210" height="30" rx="10" fill="url(#ctrlGrad)" />
                            <text x="305" y="25" text-anchor="middle" font-size="11" fill="white" font-weight="bold">
                                コントローラ
                            </text>
                            <text x="305" y="37" text-anchor="middle" font-size="10" fill="white" font-weight="bold">
                                HelloViewController.java
                            </text>

                            <text x="215" y="60" font-size="9" fill="#64748b">
                                GETかつURL「hello/model」に対応する
                            </text>
                            <text x="215" y="75" font-size="9" fill="#64748b">
                                リクエストハンドラメソッド「helloView」
                            </text>
                            <text x="215" y="90" font-size="9" fill="#64748b">が実行される</text>
                            <text x="215" y="108" font-size="9" fill="#1e293b">戻り値：「helloThymeleaf」</text>
                            <text x="215" y="121" font-size="9" fill="#64748b">※戻り値は「ビュー名」</text>

                            <!-- 矢印2 -->
                            <line
                                x1="410"
                                y1="40"
                                x2="495"
                                y2="40"
                                stroke="#64748b"
                                stroke-width="2"
                                marker-end="url(#arrow3)"
                            />
                            <circle cx="443" cy="38" r="12" fill="#64748b" />
                            <text x="443" y="42" text-anchor="middle" font-size="10" fill="white" font-weight="bold">
                                2
                            </text>

                            <!-- リクエストハンドラメソッド詳細 -->
                            <rect x="500" y="10" width="230" height="100" rx="10" fill="#fef3c7" stroke="#f59e0b" />
                            <text x="615" y="30" text-anchor="middle" font-size="10" fill="#92400e" font-weight="bold">
                                リクエストハンドラメソッド
                            </text>
                            <text x="515" y="50" font-size="9" fill="#64748b" font-family="monospace">
                                // 「Model」にデータを格納する
                            </text>
                            <text x="515" y="65" font-size="9" fill="#1e293b" font-family="monospace">
                                model.addAttribute(
                            </text>
                            <text x="530" y="80" font-size="9" fill="#e11d48" font-family="monospace">"msg"</text>
                            <text x="565" y="80" font-size="9" fill="#1e293b" font-family="monospace">,</text>
                            <text x="575" y="80" font-size="9" fill="#059669" font-family="monospace">
                                "タイムリーフ!!!"
                            </text>
                            <text x="670" y="80" font-size="9" fill="#1e293b" font-family="monospace">);</text>
                            <text x="515" y="100" font-size="9" fill="#1e293b" font-family="monospace">
                                return "helloThymeleaf";
                            </text>

                            <path d="M615 110 L615 170" stroke="#64748b" stroke-width="2" marker-end="url(#arrow3)" />
                            <text x="645" y="140" font-size="9" fill="#64748b" font-weight="bold">バインド</text>
                            <circle cx="615" cy="135" r="12" fill="#64748b" />
                            <text x="615" y="139" text-anchor="middle" font-size="10" fill="white" font-weight="bold">
                                3
                            </text>

                            <!-- テンプレート -->
                            <rect x="500" y="180" width="230" height="70" rx="10" fill="url(#tmplGrad)" />
                            <text x="615" y="200" text-anchor="middle" font-size="10" fill="white" font-weight="bold">
                                テンプレート
                            </text>
                            <text x="520" y="220" font-size="9" fill="#e9d5ff" font-family="monospace">
                                &lt;body&gt;
                            </text>
                            <text x="530" y="235" font-size="9" fill="#fde68a" font-family="monospace">
                                &lt;h1 th:text="${msg}"&gt;表示される部分&lt;/h1&gt;
                            </text>

                            <!-- 矢印4（生成） -->
                            <path
                                d="M500 215 L310 215 L310 260"
                                stroke="#64748b"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow3)"
                            />
                            <text x="395" y="195" font-size="9" fill="#64748b" font-weight="bold">生成</text>
                            <circle cx="405" cy="215" r="12" fill="#64748b" />
                            <text x="405" y="219" text-anchor="middle" font-size="10" fill="white" font-weight="bold">
                                4
                            </text>

                            <!-- テンプレートエンジン -->
                            <rect x="230" y="265" width="160" height="45" rx="10" fill="url(#engineGrad)" />
                            <text x="310" y="293" text-anchor="middle" font-size="11" fill="white" font-weight="bold">
                                テンプレートエンジン
                            </text>

                            <!-- 矢印5（レスポンス） -->
                            <path
                                d="M230 287 L70 287 L70 70"
                                stroke="#64748b"
                                stroke-width="2"
                                fill="none"
                                marker-end="url(#arrow3)"
                            />
                            <circle cx="150" cy="287" r="12" fill="#64748b" />
                            <text x="150" y="291" text-anchor="middle" font-size="10" fill="white" font-weight="bold">
                                5
                            </text>

                            <!-- レスポンス -->
                            <rect x="20" y="170" width="100" height="60" rx="10" fill="url(#reqGrad)" />
                            <text x="70" y="195" text-anchor="middle" font-size="11" fill="white" font-weight="bold">
                                レスポンス
                            </text>
                            <text x="70" y="215" text-anchor="middle" font-size="10" fill="#e0f2fe">タイムリーフ</text>

                            <defs>
                                <marker id="arrow3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                                </marker>
                            </defs>
                        </svg>
                    </div>

                    <p>
                        「リクエストハンドラメソッド」にて「ビュー」で「表示したいデータ」を「Model」のメソッド「addAttribute(名前,
                        値)」を使用して格納します。
                    </p>
                    <p>
                        「Thymeleaf」には「データを埋め込む場所」を「${名前}」を使用して設定します。気を付ける箇所は、「ビュー」で使用できるのは「addAttribute(名前,
                        値)」の「名前」だということです。
                    </p>
                </div>

                <!-- ModelAndViewの使用方法 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-2-5</span>
                        <h3 class="subsection-title">ModelAndViewの使用方法</h3>
                    </div>

                    <p>
                        Modelの仲間に「ModelAndView」があります。簡単に言うと、データ（Model）と表示する画面（View）を一緒に管理するクラスです。これを使うと、リクエストハンドラメソッドでデータと画面を一緒に設定できます。プログラムを作成しながら確認しましょう。
                    </p>

                    <div class="prompt-box">
                        <div class="prompt-box-header">
                            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
                            <span class="prompt-box-title">プロンプト</span>
                            <button class="prompt-copy-btn">コピー</button>
                        </div>
                        <div class="prompt-box-content">
                            <pre><code>## 機能
ModelAndViewを使用してデータとビューを一緒に返すメソッドを作成

## 実装要件
- URLパス「/modelandview」へのGETリクエストを処理
- ModelAndViewオブジェクトにメッセージ「タイムリーフ!!!」を「msg」という名前で格納
- ビュー名「helloThymeleaf」を設定して返す

## 使用するSpring構文/アノテーション
- @GetMapping
- ModelAndView
- ModelAndView.addObject()
- ModelAndView.setViewName()</code></pre>
                        </div>
                    </div>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">リスト6.3 HelloViewController（ModelAndView使用）</span>
                            <span class="code-lang">Java</span>
                        </div>
                        <div class="code-content">
                            <pre><span class="code-annotation">@GetMapping</span>(<span class="code-string">"modelandview"</span>)
<span class="code-keyword">public</span> ModelAndView helloView2(ModelAndView modelAndView) {
    <span class="code-comment">// データを格納する</span>
    modelAndView.addObject(<span class="code-string">"msg"</span>, <span class="code-string">"タイムリーフ!!!"</span>);
    <span class="code-comment">// 画面を設定する</span>
    modelAndView.setViewName(<span class="code-string">"helloThymeleaf"</span>);
    <span class="code-keyword">return</span> modelAndView;
}</pre>
                        </div>
                    </div>

                    <p>
                        2行目で「ModelAndView」を引数と設定することで、Springがこのオブジェクトを自動的に生成してくれます。
                    </p>
                    <p>
                        4行目「modelAndView.addObject("msg",
                        "タイムリーフ!!!")」でModelAndViewオブジェクトにビューで表示する「値」を追加しています。「msg」という名前で「タイムリーフ!!!」という値を設定しています。
                    </p>
                    <p>
                        6行目「modelAndView.setViewName("helloThymeleaf")」で表示するビュー（HTMLファイル）を指定します。この場合、先ほど作成した「helloThymeleaf.html」という名前のビューを設定しています。
                    </p>

                    <div class="info-box">
                        <h4>📝 ModelとModelAndViewの使い分け</h4>
                        <p>
                            Spring
                            MVCにおけるModelとModelAndViewは、どちらもWebアプリケーションでデータをビュー（HTMLページなど）に渡すために使われますが、使い方に違いがあります。
                        </p>
                        <table style="margin-top: 16px">
                            <thead>
                                <tr>
                                    <th>種類</th>
                                    <th>特徴</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Model</strong></td>
                                    <td>
                                        単にデータをビューに渡すだけの場合に便利です。コントローラーのメソッドの戻り値がビューの名前を直接返す場合によく使われます
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>ModelAndView</strong></td>
                                    <td>
                                        ビューの名前と一緒にデータを渡したい場合や、条件によって異なるビューを表示させたい場合に便利です。ビューとデータをより細かく制御したい場合に使います
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p style="margin-top: 16px">
                            簡単に言うと、Modelは「データを渡すためのバッグ」のようなもので、ModelAndViewは「データと行き先のビューの名前が書かれたバッグ」のようなものです。どちらを使うかは、アプリケーションの要件や好みによります。
                        </p>
                    </div>
                </div>
            </section>

            <!-- Section 6-3 -->
            <section id="section-6-3" class="section">
                <div class="section-header">
                    <span class="section-number">Section 6-3</span>
                    <h2 class="section-title">Thymeleafを使ってみよう</h2>
                </div>

                <p>
                    ここでは「Thymeleaf」の使用方法を、プログラムを作成しながら学習しましょう。Thymeleafを使うと「ビュー」側でも様々な処理が記述できます。まずは、どのような機能があるのか全体像を把握しましょう。
                </p>

                <!-- Thymeleaf機能一覧 -->
                <div style="margin: 25px 0; padding: 25px; background: #E0F7FA; border-radius: 12px; border: 1px solid #86efac;">
                    <h4 style="color: #166534; margin-bottom: 20px; font-size: 18px;">Thymeleafでできること</h4>

                    <!-- 機能一覧の図 -->
                    <div class="diagram-container" style="margin-bottom: 25px;">
                        <div class="diagram-title">Thymeleafの主な機能</div>
                        <svg viewBox="0 0 800 420" style="max-width: 100%; height: auto;">
                            <defs>
                                <linearGradient id="textGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #3b82f6" />
                                    <stop offset="100%" style="stop-color: #1d4ed8" />
                                </linearGradient>
                                <linearGradient id="condGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #f59e0b" />
                                    <stop offset="100%" style="stop-color: #d97706" />
                                </linearGradient>
                                <linearGradient id="loopGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #10b981" />
                                    <stop offset="100%" style="stop-color: #059669" />
                                </linearGradient>
                                <linearGradient id="attrGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #8b5cf6" />
                                    <stop offset="100%" style="stop-color: #7c3aed" />
                                </linearGradient>
                                <linearGradient id="formGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #ec4899" />
                                    <stop offset="100%" style="stop-color: #db2777" />
                                </linearGradient>
                                <linearGradient id="utilGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #06b6d4" />
                                    <stop offset="100%" style="stop-color: #0891b2" />
                                </linearGradient>
                            </defs>

                            <!-- 背景 -->
                            <rect x="5" y="5" width="790" height="410" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" />

                            <!-- 1. テキスト出力 -->
                            <rect x="20" y="25" width="245" height="115" rx="10" fill="white" stroke="#3b82f6" stroke-width="2" />
                            <rect x="20" y="25" width="245" height="35" rx="10" fill="url(#textGrad)" />
                            <text x="40" y="48" font-size="13" fill="white" font-weight="bold">1. テキスト出力</text>
                            <text x="175" y="48" font-family="monospace" font-size="11" fill="#bfdbfe">th:text</text>
                            <rect x="30" y="70" width="225" height="60" rx="6" fill="#1e1e1e" />
                            <text x="42" y="90" font-family="monospace" font-size="10" fill="#9ca3af">&lt;p</text>
                            <text x="58" y="90" font-family="monospace" font-size="10" fill="#4ec9b0">th:text</text>
                            <text x="105" y="90" font-family="monospace" font-size="10" fill="#d4d4d4">=</text>
                            <text x="112" y="90" font-family="monospace" font-size="10" fill="#ce9178">"${name}"</text>
                            <text x="168" y="90" font-family="monospace" font-size="10" fill="#9ca3af">&gt;&lt;/p&gt;</text>
                            <text x="42" y="108" font-size="10" fill="#64748b">→ Modelの値を表示</text>
                            <text x="42" y="122" font-size="10" fill="#3b82f6">例：「田中太郎」と表示される</text>

                            <!-- 2. 条件分岐 -->
                            <rect x="278" y="25" width="245" height="115" rx="10" fill="white" stroke="#f59e0b" stroke-width="2" />
                            <rect x="278" y="25" width="245" height="35" rx="10" fill="url(#condGrad)" />
                            <text x="298" y="48" font-size="13" fill="white" font-weight="bold">2. 条件分岐</text>
                            <text x="410" y="48" font-family="monospace" font-size="11" fill="#fef3c7">th:if / th:unless</text>
                            <rect x="288" y="70" width="225" height="60" rx="6" fill="#1e1e1e" />
                            <text x="300" y="90" font-family="monospace" font-size="10" fill="#9ca3af">&lt;p</text>
                            <text x="316" y="90" font-family="monospace" font-size="10" fill="#4ec9b0">th:if</text>
                            <text x="345" y="90" font-family="monospace" font-size="10" fill="#d4d4d4">=</text>
                            <text x="352" y="90" font-family="monospace" font-size="10" fill="#ce9178">"${age >= 20}"</text>
                            <text x="440" y="90" font-family="monospace" font-size="10" fill="#9ca3af">&gt;</text>
                            <text x="300" y="108" font-size="10" fill="#64748b">→ 条件がtrueの時だけ表示</text>
                            <text x="300" y="122" font-size="10" fill="#f59e0b">例：20歳以上なら表示</text>

                            <!-- 3. 繰り返し -->
                            <rect x="536" y="25" width="245" height="115" rx="10" fill="white" stroke="#10b981" stroke-width="2" />
                            <rect x="536" y="25" width="245" height="35" rx="10" fill="url(#loopGrad)" />
                            <text x="556" y="48" font-size="13" fill="white" font-weight="bold">3. 繰り返し</text>
                            <text x="680" y="48" font-family="monospace" font-size="11" fill="#d1fae5">th:each</text>
                            <rect x="546" y="70" width="225" height="60" rx="6" fill="#1e1e1e" />
                            <text x="558" y="90" font-family="monospace" font-size="10" fill="#9ca3af">&lt;li</text>
                            <text x="576" y="90" font-family="monospace" font-size="10" fill="#4ec9b0">th:each</text>
                            <text x="618" y="90" font-family="monospace" font-size="10" fill="#d4d4d4">=</text>
                            <text x="625" y="90" font-family="monospace" font-size="10" fill="#ce9178">"item : ${list}"</text>
                            <text x="720" y="90" font-family="monospace" font-size="10" fill="#9ca3af">&gt;</text>
                            <text x="558" y="108" font-size="10" fill="#64748b">→ リストの要素を繰り返し表示</text>
                            <text x="558" y="122" font-size="10" fill="#10b981">例：商品一覧を表示</text>

                            <!-- 4. 属性の設定 -->
                            <rect x="20" y="155" width="245" height="115" rx="10" fill="white" stroke="#8b5cf6" stroke-width="2" />
                            <rect x="20" y="155" width="245" height="35" rx="10" fill="url(#attrGrad)" />
                            <text x="40" y="178" font-size="13" fill="white" font-weight="bold">4. 属性の設定</text>
                            <text x="155" y="178" font-family="monospace" font-size="11" fill="#e9d5ff">th:href / th:src</text>
                            <rect x="30" y="200" width="225" height="60" rx="6" fill="#1e1e1e" />
                            <text x="42" y="220" font-family="monospace" font-size="10" fill="#9ca3af">&lt;a</text>
                            <text x="55" y="220" font-family="monospace" font-size="10" fill="#4ec9b0">th:href</text>
                            <text x="95" y="220" font-family="monospace" font-size="10" fill="#d4d4d4">=</text>
                            <text x="102" y="220" font-family="monospace" font-size="10" fill="#ce9178">"@{/user/{id}(id=${userId})}"</text>
                            <text x="42" y="238" font-size="10" fill="#64748b">→ 動的にURLを生成</text>
                            <text x="42" y="252" font-size="10" fill="#8b5cf6">例：/user/123 のリンクを生成</text>

                            <!-- 5. フォーム連携 -->
                            <rect x="278" y="155" width="245" height="115" rx="10" fill="white" stroke="#ec4899" stroke-width="2" />
                            <rect x="278" y="155" width="245" height="35" rx="10" fill="url(#formGrad)" />
                            <text x="298" y="178" font-size="13" fill="white" font-weight="bold">5. フォーム連携</text>
                            <text x="420" y="178" font-family="monospace" font-size="11" fill="#fbcfe8">th:object / th:field</text>
                            <rect x="288" y="200" width="225" height="60" rx="6" fill="#1e1e1e" />
                            <text x="300" y="220" font-family="monospace" font-size="10" fill="#9ca3af">&lt;input</text>
                            <text x="340" y="220" font-family="monospace" font-size="10" fill="#4ec9b0">th:field</text>
                            <text x="385" y="220" font-family="monospace" font-size="10" fill="#d4d4d4">=</text>
                            <text x="392" y="220" font-family="monospace" font-size="10" fill="#ce9178">"*{name}"</text>
                            <text x="445" y="220" font-family="monospace" font-size="10" fill="#9ca3af">/&gt;</text>
                            <text x="300" y="238" font-size="10" fill="#64748b">→ フォームとオブジェクトを連携</text>
                            <text x="300" y="252" font-size="10" fill="#ec4899">例：入力値を自動バインド</text>

                            <!-- 6. ユーティリティ -->
                            <rect x="536" y="155" width="245" height="115" rx="10" fill="white" stroke="#06b6d4" stroke-width="2" />
                            <rect x="536" y="155" width="245" height="35" rx="10" fill="url(#utilGrad)" />
                            <text x="556" y="178" font-size="13" fill="white" font-weight="bold">6. ユーティリティ</text>
                            <text x="680" y="178" font-family="monospace" font-size="11" fill="#cffafe">#dates など</text>
                            <rect x="546" y="200" width="225" height="60" rx="6" fill="#1e1e1e" />
                            <text x="558" y="220" font-family="monospace" font-size="10" fill="#ce9178">"${#dates.format(date,'yyyy/MM/dd')}"</text>
                            <text x="558" y="238" font-size="10" fill="#64748b">→ 日付や数値のフォーマット</text>
                            <text x="558" y="252" font-size="10" fill="#06b6d4">例：2024/01/15 と表示</text>

                            <!-- 式の種類 -->
                            <rect x="20" y="285" width="761" height="125" rx="10" fill="white" stroke="#64748b" stroke-width="1" />
                            <text x="40" y="310" font-size="14" fill="#1e293b" font-weight="bold">Thymeleafの式（Expression）</text>

                            <rect x="40" y="325" width="170" height="70" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="1" />
                            <text x="55" y="348" font-family="monospace" font-size="13" fill="#1e40af" font-weight="bold">${...}</text>
                            <text x="55" y="368" font-size="11" fill="#475569">変数式</text>
                            <text x="55" y="383" font-size="10" fill="#64748b">Modelの値を取得</text>

                            <rect x="225" y="325" width="170" height="70" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="1" />
                            <text x="240" y="348" font-family="monospace" font-size="13" fill="#b45309" font-weight="bold">*{...}</text>
                            <text x="240" y="368" font-size="11" fill="#475569">選択変数式</text>
                            <text x="240" y="383" font-size="10" fill="#64748b">th:objectの属性を参照</text>

                            <rect x="410" y="325" width="170" height="70" rx="8" fill="#dcfce7" stroke="#10b981" stroke-width="1" />
                            <text x="425" y="348" font-family="monospace" font-size="13" fill="#166534" font-weight="bold">@{...}</text>
                            <text x="425" y="368" font-size="11" fill="#475569">リンクURL式</text>
                            <text x="425" y="383" font-size="10" fill="#64748b">URLを動的に生成</text>

                            <rect x="595" y="325" width="170" height="70" rx="8" fill="#fdf4ff" stroke="#a855f7" stroke-width="1" />
                            <text x="610" y="348" font-family="monospace" font-size="13" fill="#7c3aed" font-weight="bold">#{...}</text>
                            <text x="610" y="368" font-size="11" fill="#475569">メッセージ式</text>
                            <text x="610" y="383" font-size="10" fill="#64748b">多言語対応のメッセージ</text>
                        </svg>
                    </div>

                    <!-- 機能詳細テーブル -->
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 18%;">機能</th>
                                    <th style="width: 22%;">属性</th>
                                    <th>説明</th>
                                    <th style="width: 25%;">使用例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong style="color: #3b82f6;">テキスト出力</strong></td>
                                    <td><code style="background:#dbeafe; padding:2px 6px; border-radius:4px; color:#1e40af;">th:text</code></td>
                                    <td>タグ内のテキストを動的に置き換える</td>
                                    <td><code style="font-size:11px;">th:text="${user.name}"</code></td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #f59e0b;">条件分岐</strong></td>
                                    <td>
                                        <code style="background:#fef3c7; padding:2px 6px; border-radius:4px; color:#92400e;">th:if</code><br>
                                        <code style="background:#fef3c7; padding:2px 6px; border-radius:4px; color:#92400e;">th:unless</code>
                                    </td>
                                    <td>条件がtrue/falseの時だけ要素を表示</td>
                                    <td><code style="font-size:11px;">th:if="${age >= 20}"</code></td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #f59e0b;">条件分岐（複数）</strong></td>
                                    <td>
                                        <code style="background:#fef3c7; padding:2px 6px; border-radius:4px; color:#92400e;">th:switch</code><br>
                                        <code style="background:#fef3c7; padding:2px 6px; border-radius:4px; color:#92400e;">th:case</code>
                                    </td>
                                    <td>複数の条件で分岐（switch文のような動作）</td>
                                    <td><code style="font-size:11px;">th:case="'admin'"</code></td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #10b981;">繰り返し</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 6px; border-radius:4px; color:#166534;">th:each</code></td>
                                    <td>リストやコレクションを繰り返し処理</td>
                                    <td><code style="font-size:11px;">th:each="item : ${items}"</code></td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #8b5cf6;">属性の設定</strong></td>
                                    <td>
                                        <code style="background:#f3e8ff; padding:2px 6px; border-radius:4px; color:#7c3aed;">th:href</code>
                                        <code style="background:#f3e8ff; padding:2px 6px; border-radius:4px; color:#7c3aed;">th:src</code><br>
                                        <code style="background:#f3e8ff; padding:2px 6px; border-radius:4px; color:#7c3aed;">th:value</code>
                                        <code style="background:#f3e8ff; padding:2px 6px; border-radius:4px; color:#7c3aed;">th:class</code>
                                    </td>
                                    <td>HTML属性を動的に設定</td>
                                    <td><code style="font-size:11px;">th:href="@{/users}"</code></td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #ec4899;">フォーム連携</strong></td>
                                    <td>
                                        <code style="background:#fce7f3; padding:2px 6px; border-radius:4px; color:#be185d;">th:object</code><br>
                                        <code style="background:#fce7f3; padding:2px 6px; border-radius:4px; color:#be185d;">th:field</code>
                                    </td>
                                    <td>フォームとJavaオブジェクトをバインド</td>
                                    <td><code style="font-size:11px;">th:field="*{email}"</code></td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #06b6d4;">フラグメント</strong></td>
                                    <td>
                                        <code style="background:#cffafe; padding:2px 6px; border-radius:4px; color:#0e7490;">th:fragment</code><br>
                                        <code style="background:#cffafe; padding:2px 6px; border-radius:4px; color:#0e7490;">th:insert</code>
                                    </td>
                                    <td>HTMLの部品を再利用（ヘッダー、フッター等）</td>
                                    <td><code style="font-size:11px;">th:insert="~{common::header}"</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- ユーティリティオブジェクト -->
                    <div style="margin-top: 25px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e2e8f0;">
                        <h5 style="color: #0891b2; margin-bottom: 15px; font-size: 15px;">便利なユーティリティオブジェクト</h5>
                        <p style="margin-bottom: 15px; color: #64748b; font-size: 14px;">
                            Thymeleafには、日付や数値のフォーマットなど、よく使う処理が組み込まれています。
                        </p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                            <div style="padding: 12px; background: #f0f9ff; border-radius: 8px; border-left: 3px solid #0ea5e9;">
                                <code style="color: #0369a1; font-weight: bold;">#dates</code>
                                <p style="margin: 5px 0 0; font-size: 12px; color: #475569;">日付のフォーマット・操作</p>
                            </div>
                            <div style="padding: 12px; background: #E0F7FA; border-radius: 8px; border-left: 3px solid #22c55e;">
                                <code style="color: #166534; font-weight: bold;">#numbers</code>
                                <p style="margin: 5px 0 0; font-size: 12px; color: #475569;">数値のフォーマット</p>
                            </div>
                            <div style="padding: 12px; background: #fefce8; border-radius: 8px; border-left: 3px solid #eab308;">
                                <code style="color: #a16207; font-weight: bold;">#strings</code>
                                <p style="margin: 5px 0 0; font-size: 12px; color: #475569;">文字列の操作</p>
                            </div>
                            <div style="padding: 12px; background: #fdf4ff; border-radius: 8px; border-left: 3px solid #a855f7;">
                                <code style="color: #7c3aed; font-weight: bold;">#lists</code>
                                <p style="margin: 5px 0 0; font-size: 12px; color: #475569;">リストの操作</p>
                            </div>
                        </div>
                    </div>

                    <!-- ポイント -->
                    <div style="margin-top: 20px; padding: 15px; background: #fef9c3; border-radius: 8px; border-left: 4px solid #eab308;">
                        <p style="margin: 0; color: #854d0e; font-size: 14px;">
                            <strong>💡 ポイント：</strong>最初からすべてを覚える必要はありません。まずは<code style="background:#fef3c7; padding:2px 6px; border-radius:4px;">th:text</code>（テキスト出力）と<code style="background:#fef3c7; padding:2px 6px; border-radius:4px;">th:each</code>（繰り返し）を使えるようになれば、基本的なページは作成できます。
                        </p>
                    </div>
                </div>

                <!-- プロジェクト設定 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-3-1</span>
                        <h3 class="subsection-title">Thymeleafを使ったプロジェクト</h3>
                    </div>

                    <p>
                        Spring Initializrを使用してプロジェクトを作成します。ブラウザで <a href="https://start.spring.io" target="_blank" style="color: #3b82f6; font-weight: bold;">https://start.spring.io</a> にアクセスしてください。
                    </p>

                    <!-- Spring Initializr 設定図解 -->
                    <div class="diagram-container" style="margin: 25px 0;">
                        <div class="diagram-title">Spring Initializr の設定</div>
                        <svg viewBox="0 0 800 480" style="max-width: 100%; height: auto;">
                            <defs>
                                <linearGradient id="initializrHeader" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #6db33f" />
                                    <stop offset="100%" style="stop-color: #5a9e2f" />
                                </linearGradient>
                            </defs>

                            <!-- 外枠 -->
                            <rect x="5" y="5" width="790" height="470" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" />

                            <!-- ヘッダー -->
                            <rect x="5" y="5" width="790" height="50" rx="12" fill="url(#initializrHeader)" />
                            <text x="30" y="38" font-size="20" fill="white" font-weight="bold">spring initializr</text>
                            <text x="200" y="35" font-size="12" fill="#d1fae5">https://start.spring.io</text>

                            <!-- 左側：プロジェクト設定 -->
                            <rect x="20" y="70" width="370" height="390" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1" />
                            <text x="40" y="100" font-size="14" fill="#1e293b" font-weight="bold">Project（プロジェクト）</text>

                            <!-- Project選択 -->
                            <rect x="40" y="115" width="80" height="30" rx="6" fill="#6db33f" stroke="#5a9e2f" stroke-width="2" />
                            <text x="60" y="135" font-size="12" fill="white" font-weight="bold">Maven</text>
                            <rect x="130" y="115" width="80" height="30" rx="6" fill="#e2e8f0" stroke="#cbd5e1" stroke-width="1" />
                            <text x="152" y="135" font-size="12" fill="#64748b">Gradle</text>

                            <!-- Language -->
                            <text x="40" y="170" font-size="14" fill="#1e293b" font-weight="bold">Language（言語）</text>
                            <rect x="40" y="180" width="70" height="28" rx="6" fill="#6db33f" stroke="#5a9e2f" stroke-width="2" />
                            <text x="60" y="199" font-size="12" fill="white" font-weight="bold">Java</text>
                            <rect x="120" y="180" width="70" height="28" rx="6" fill="#e2e8f0" stroke="#cbd5e1" stroke-width="1" />
                            <text x="138" y="199" font-size="12" fill="#64748b">Kotlin</text>
                            <rect x="200" y="180" width="70" height="28" rx="6" fill="#e2e8f0" stroke="#cbd5e1" stroke-width="1" />
                            <text x="215" y="199" font-size="12" fill="#64748b">Groovy</text>

                            <!-- Spring Boot -->
                            <text x="40" y="235" font-size="14" fill="#1e293b" font-weight="bold">Spring Boot</text>
                            <rect x="40" y="245" width="60" height="28" rx="6" fill="#6db33f" stroke="#5a9e2f" stroke-width="2" />
                            <text x="55" y="264" font-size="11" fill="white" font-weight="bold">3.4.1</text>
                            <text x="110" y="264" font-size="10" fill="#64748b">（最新の安定版を選択）</text>

                            <!-- Project Metadata -->
                            <text x="40" y="300" font-size="14" fill="#1e293b" font-weight="bold">Project Metadata</text>

                            <text x="40" y="325" font-size="11" fill="#64748b">Group</text>
                            <rect x="40" y="330" width="150" height="28" rx="4" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1" />
                            <text x="50" y="349" font-family="monospace" font-size="11" fill="#1e293b">com.example</text>

                            <text x="200" y="325" font-size="11" fill="#64748b">Artifact</text>
                            <rect x="200" y="330" width="170" height="28" rx="4" fill="#fef9c3" stroke="#fbbf24" stroke-width="2" />
                            <text x="210" y="349" font-family="monospace" font-size="11" fill="#92400e" font-weight="bold">ThymeleafSample</text>

                            <text x="40" y="380" font-size="11" fill="#64748b">Name</text>
                            <rect x="40" y="385" width="150" height="28" rx="4" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1" />
                            <text x="50" y="404" font-family="monospace" font-size="11" fill="#1e293b">ThymeleafSample</text>

                            <text x="200" y="380" font-size="11" fill="#64748b">Packaging</text>
                            <rect x="200" y="385" width="60" height="28" rx="4" fill="#6db33f" />
                            <text x="220" y="404" font-size="11" fill="white" font-weight="bold">Jar</text>

                            <text x="270" y="380" font-size="11" fill="#64748b">Java</text>
                            <rect x="270" y="385" width="50" height="28" rx="4" fill="#6db33f" />
                            <text x="287" y="404" font-size="11" fill="white" font-weight="bold">21</text>

                            <!-- 右側：Dependencies -->
                            <rect x="410" y="70" width="370" height="390" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1" />
                            <text x="430" y="100" font-size="14" fill="#1e293b" font-weight="bold">Dependencies（依存関係）</text>
                            <text x="430" y="118" font-size="11" fill="#64748b">ADD DEPENDENCIES... をクリックして以下を追加</text>

                            <!-- DevTools -->
                            <rect x="430" y="135" width="330" height="55" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="2" />
                            <text x="450" y="158" font-size="13" fill="#1e40af" font-weight="bold">Spring Boot DevTools</text>
                            <text x="450" y="178" font-size="11" fill="#64748b">開発時の自動リロード機能を提供</text>
                            <text x="720" y="165" font-size="16" fill="#3b82f6">🔧</text>

                            <!-- Lombok -->
                            <rect x="430" y="200" width="330" height="55" rx="8" fill="#fefce8" stroke="#eab308" stroke-width="2" />
                            <text x="450" y="223" font-size="13" fill="#a16207" font-weight="bold">Lombok</text>
                            <text x="450" y="243" font-size="11" fill="#64748b">getter/setterなどを自動生成</text>
                            <text x="720" y="230" font-size="16" fill="#eab308">📦</text>

                            <!-- Thymeleaf -->
                            <rect x="430" y="265" width="330" height="55" rx="8" fill="#E0F7FA" stroke="#22c55e" stroke-width="2" />
                            <text x="450" y="288" font-size="13" fill="#166534" font-weight="bold">Thymeleaf</text>
                            <text x="450" y="308" font-size="11" fill="#64748b">HTMLテンプレートエンジン</text>
                            <text x="720" y="295" font-size="16" fill="#22c55e">🌿</text>

                            <!-- Spring Web -->
                            <rect x="430" y="330" width="330" height="55" rx="8" fill="#fdf4ff" stroke="#a855f7" stroke-width="2" />
                            <text x="450" y="353" font-size="13" fill="#7c3aed" font-weight="bold">Spring Web</text>
                            <text x="450" y="373" font-size="11" fill="#64748b">Webアプリケーション開発に必須</text>
                            <text x="720" y="360" font-size="16" fill="#a855f7">🌐</text>

                            <!-- Generate ボタン -->
                            <rect x="430" y="400" width="150" height="45" rx="8" fill="#6db33f" />
                            <text x="465" y="430" font-size="14" fill="white" font-weight="bold">GENERATE</text>
                            <text x="600" y="425" font-size="11" fill="#64748b">← クリックして</text>
                            <text x="600" y="440" font-size="11" fill="#64748b">   ZIPをダウンロード</text>
                        </svg>
                    </div>

                    <!-- 手順説明 -->
                    <div style="margin-top: 25px; padding: 20px; background: #eff6ff; border-radius: 10px; border: 1px solid #93c5fd;">
                        <h4 style="color: #1e40af; margin-bottom: 15px;">VSCodeでプロジェクトを開く手順</h4>
                        <ol style="margin: 0; padding-left: 20px; line-height: 2; color: #1e3a8a;">
                            <li><strong>GENERATE</strong> ボタンをクリックしてZIPファイルをダウンロード</li>
                            <li>ダウンロードしたZIPファイルを<strong>解凍</strong>（展開）</li>
                            <li><strong>VSCode</strong>を起動</li>
                            <li>メニューから「<strong>ファイル</strong>」→「<strong>フォルダーを開く</strong>」を選択</li>
                            <li>解凍したフォルダ（<code style="background:#dbeafe; padding:2px 8px; border-radius:4px; color:#1e40af;">ThymeleafSample</code>）を選択して開く</li>
                        </ol>
                    </div>

                    <!-- 設定値テーブル -->
                    <div class="table-wrapper" style="margin-top: 25px;">
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 30%;">設定項目</th>
                                    <th>値</th>
                                    <th style="width: 35%;">説明</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Project</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">Maven</code></td>
                                    <td>ビルドツール</td>
                                </tr>
                                <tr>
                                    <td><strong>Language</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">Java</code></td>
                                    <td>プログラミング言語</td>
                                </tr>
                                <tr>
                                    <td><strong>Spring Boot</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">3.4.x</code></td>
                                    <td>最新の安定版を選択</td>
                                </tr>
                                <tr>
                                    <td><strong>Artifact</strong></td>
                                    <td><code style="background:#fef3c7; padding:2px 8px; border-radius:4px; color:#92400e;">ThymeleafSample</code></td>
                                    <td>プロジェクト名</td>
                                </tr>
                                <tr>
                                    <td><strong>Packaging</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">Jar</code></td>
                                    <td>パッケージ形式</td>
                                </tr>
                                <tr>
                                    <td><strong>Java</strong></td>
                                    <td><code style="background:#dcfce7; padding:2px 8px; border-radius:4px; color:#166534;">21</code></td>
                                    <td>Javaバージョン</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 依存関係 -->
                    <p style="margin-top: 25px; font-weight: 500;">依存関係（Dependencies）で以下を追加してください：</p>
                    <ul class="feature-list">
                        <li class="feature-item">
                            <div class="feature-icon">🔧</div>
                            <div class="feature-content">
                                <h4>Spring Boot DevTools</h4>
                                <p style="margin: 5px 0 0; color: #64748b; font-size: 14px;">開発時にコード変更を自動で反映（ホットリロード）</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">📦</div>
                            <div class="feature-content">
                                <h4>Lombok</h4>
                                <p style="margin: 5px 0 0; color: #64748b; font-size: 14px;">getter/setter、コンストラクタなどを自動生成</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">🌿</div>
                            <div class="feature-content">
                                <h4>Thymeleaf</h4>
                                <p style="margin: 5px 0 0; color: #64748b; font-size: 14px;">HTMLベースのテンプレートエンジン</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">🌐</div>
                            <div class="feature-content">
                                <h4>Spring Web</h4>
                                <p style="margin: 5px 0 0; color: #64748b; font-size: 14px;">Webアプリケーション開発に必要な機能一式</p>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Thymeleafの使用方法 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-3-2</span>
                        <h3 class="subsection-title">Thymeleafの使用方法</h3>
                    </div>

                    <p>最初に、Thymeleafの使用方法を説明します。その後にハンズオンを実施しましょう。</p>

                    <!-- 直接文字を埋め込む -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">th:text - 直接文字を埋め込む</span>
                        <p>直接文字を埋め込む例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.4 直接文字を埋め込む</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 01：直接文字を埋め込む --&gt;</span>
<span class="tag">&lt;h1</span> <span class="attr">th:text</span>=<span class="value">"'hello world'"</span><span class="tag">&gt;</span>表示する部分<span class="tag">&lt;/h1&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「th:text="【出力文字】"」とすることで、設定した文字を出力できます。また【出力文字】の部分は「Thymeleaf」独自式「${名前}」を使用できます。属性値の値設定で「"（ダブルクォーテーション）」を使用しているので、文字を設定する時は、「'（シングルクォーテーション）」で囲みます。
                        </p>
                    </div>

                    <!-- インライン処理 -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">[[${名前}]] - インライン処理</span>
                        <p>インライン処理の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.5 インライン処理</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 02：インライン処理 --&gt;</span>
<span class="tag">&lt;h1&gt;</span>こんにちは！[[${name}]]さん<span class="tag">&lt;/h1&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            [[${名前}]]を使用すると、タグの属性への追加ではなく本体へ変数を埋め込めます。「固定値」と「変数」を組み合わせたい場合には、こちらの方法が便利です。
                        </p>
                    </div>

                    <!-- 値結合 -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">+ 演算子 - 値結合</span>
                        <p>値結合の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.6 値結合</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 03：値結合 --&gt;</span>
<span class="tag">&lt;h1</span> <span class="attr">th:text</span>=<span class="value">"'明日は、' + '晴れ' + 'です。'"</span><span class="tag">&gt;</span>表示する部分<span class="tag">&lt;/h1&gt;</span></pre>
                            </div>
                        </div>
                        <p>「+」を利用して「値」の連結ができます。</p>
                    </div>

                    <!-- リテラル置換 -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">|文字| - 値結合（リテラル置換）</span>
                        <p>値結合（リテラル置換）の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.7 値結合（リテラル置換）</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 04：値結合（リテラル置換） --&gt;</span>
<span class="tag">&lt;h1</span> <span class="attr">th:text</span>=<span class="value">"|こんにちは！${name}さん、|"</span><span class="tag">&gt;</span>表示する部分<span class="tag">&lt;/h1&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            値結合はリテラル置換を使用することで、「|文字|」で記述ができます。文字の中で「${名前}」式も合わせて使用できます。
                        </p>
                    </div>

                    <!-- ローカル変数 -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">th:with - ローカル変数</span>
                        <p>ローカル変数の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.8 ローカル変数</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 05：ローカル変数 --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:with</span>=<span class="value">"a=1, b=2"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"|${a} + ${b} = ${a+b}|"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「th:with="変数名=値"」で変数に値を代入できます。変数のスコープ（変数を使用できる有効範囲）は定義されたタグ内部でのみ使用できます。また、算術演算子「+」、「-」、「*」、「/」、「%」が使用できます。
                        </p>
                    </div>

                    <!-- 比較と等価 -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">比較演算子 - 比較と等価</span>
                        <p>比較と等価の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.9 比較と等価</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 06：比較と等価 --&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"1 &gt; 10"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"1 &lt; 10"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"1 &gt;= 10"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"1 &lt;= 10"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"1 == 10"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"1 != 10"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"'太郎' == '太郎'"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"'太郎' != '太郎'"</span><span class="tag">&gt;&lt;/span&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            比較等価演算子「&gt;」、「&lt;」、「&gt;=」、「&lt;=」、「==」、「!=」が使用できます（文字列の比較もできます）。
                        </p>
                    </div>

                    <!-- 条件演算子 -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">三項演算子 - 条件演算子</span>
                        <p>条件演算子の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.10 条件演算子</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 07：条件演算子 --&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${name} == '太郎' ? '太郎さんです！' : '太郎さんではありません。'"</span><span class="tag">&gt;&lt;/p&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            三項演算子「【条件】?【値1】:【値2】」が利用できます。【条件】が「true」の場合は【値1】が、「false」の場合は【値2】が表示されます。
                        </p>
                    </div>

                    <!-- 条件分岐 (true) -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">th:if - 条件分岐（true）</span>
                        <p>条件分岐（true）の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.11 条件分岐（true）</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 08：条件分岐（true） --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:if</span>=<span class="value">"${name} == '太郎'"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>太郎さんです！<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「th:if="【条件】"」で「true（真）」となった場合、「th:if」を記述したタグと子要素を表示します。
                        </p>
                    </div>

                    <!-- 条件分岐 (false) -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">th:unless - 条件分岐（false）</span>
                        <p>条件分岐（false）の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.12 条件分岐（false）</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 09：条件分岐（false） --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:unless</span>=<span class="value">"${name} == '花子'"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>花子さんではありません。<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「th:unless="【条件】"」で「false（偽）」となった場合、「th:unless」を記述したタグと子要素を表示します。
                        </p>
                    </div>

                    <!-- switch -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">th:switch / th:case - switch文</span>
                        <p>switchの例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.13 switch</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 10：switch --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:switch</span>=<span class="value">"${name}"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p</span> <span class="attr">th:case</span>=<span class="value">"'太郎'"</span> <span class="attr">th:text</span>=<span class="value">"|${name}です！|"</span><span class="tag">&gt;&lt;/p&gt;</span>
    <span class="tag">&lt;p</span> <span class="attr">th:case</span>=<span class="value">"'ジロウ'"</span> <span class="attr">th:text</span>=<span class="value">"|${name}です！|"</span><span class="tag">&gt;&lt;/p&gt;</span>
    <span class="tag">&lt;p</span> <span class="attr">th:case</span>=<span class="value">"'花子'"</span> <span class="attr">th:text</span>=<span class="value">"|${name}です！|"</span><span class="tag">&gt;&lt;/p&gt;</span>
    <span class="tag">&lt;p</span> <span class="attr">th:case</span>=<span class="value">"'*'"</span><span class="tag">&gt;</span>名簿にありません<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            親要素の「th:switch」の値と、子要素に記述する「th:case」の値が等しい場合、HTML要素を出力します。どの値にも一致しない値を出力する場合は「th:case="*"」を指定します。
                        </p>
                    </div>

                    <!-- 参照（データをまとめたオブジェクト） -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">オブジェクト参照 - データをまとめたオブジェクト</span>
                        <p>参照（データをまとめたオブジェクト）の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.14 参照（データをまとめたオブジェクト）</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 11：参照（データをまとめたオブジェクト） --&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${mb.id}"</span><span class="tag">&gt;</span>ID<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${mb.name}"</span><span class="tag">&gt;</span>名前<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${mb['id']}"</span><span class="tag">&gt;</span>ID：[]でアクセス<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${mb['name']}"</span><span class="tag">&gt;</span>名前：[]でアクセス<span class="tag">&lt;/p&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「カプセル化」されているフィールドを参照する場合、アクセス修飾子「public」のgetXxx()というゲッターメソッドを作成しておくことで「オブジェクト名.フィールド」で参照できます。また「オブジェクト名['フィールド']」のように「角括弧」で参照することもできます。
                        </p>
                    </div>

                    <!-- th:object -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">th:object - オブジェクト参照の簡略化</span>
                        <p>参照（th:object）の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.15 th:object</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 12：参照（th:object） --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:object</span>=<span class="value">"${mb}"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"*{id}"</span><span class="tag">&gt;</span>ID<span class="tag">&lt;/p&gt;</span>
    <span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"*{name}"</span><span class="tag">&gt;</span>名前<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「データをまとめたオブジェクト」を「th:object」という形で設定することで、子要素にて「*{フィールド名}」でまとめることができます。また「*{'フィールド'}」のように「角括弧」で参照することもできます。
                        </p>
                    </div>

                    <!-- 参照（List） -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">List参照 - インデックスアクセス</span>
                        <p>参照（List）の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.16 List</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 13：参照（List） --&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${list[0]}"</span><span class="tag">&gt;</span>方角<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${list[1]}"</span><span class="tag">&gt;</span>方角<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${list[2]}"</span><span class="tag">&gt;</span>方角<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${list[3]}"</span><span class="tag">&gt;</span>方角<span class="tag">&lt;/p&gt;</span></pre>
                            </div>
                        </div>
                        <p>「List」や「配列」の要素を参照するには、「インデックス」を利用します。</p>
                    </div>

                    <!-- 参照（Map） -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">Map参照 - キーアクセス</span>
                        <p>参照（Map）の例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.17 Map</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 14：参照（Map） --&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${map.tanaka.name}"</span><span class="tag">&gt;</span>名前1<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${map.suzuki.name}"</span><span class="tag">&gt;</span>名前2<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${map['tanaka']['name']}"</span><span class="tag">&gt;</span>名前1：[]でアクセス<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;p</span> <span class="attr">th:text</span>=<span class="value">"${map['suzuki']['name']}"</span><span class="tag">&gt;</span>名前2：[]でアクセス<span class="tag">&lt;/p&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「Map」の要素を参照するには「キー」を利用して値を参照します。「map.キー」で参照できます。または「map['キー']」のように角括弧で参照することもできます。
                        </p>
                    </div>

                    <!-- 繰り返し -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">th:each - 繰り返し</span>
                        <p>繰り返しの例を以下に示します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.18 繰り返し</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 15：繰り返し --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:each</span>=<span class="value">"member : ${members}"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>[[${member.id}]]：[[${member.name}]]<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「th:each="【要素格納用変数】:
                            ${【繰り返し処理するオブジェクト】}"」で、繰り返し処理することができます。【要素格納用変数】は、繰り返し処理の中でのみ有効です。「Iterable」インターフェース（「for-eachループ」文の対象にすることができる）を実装したクラスであれば、「th:each」で繰り返し処理することができます。javaでいう「拡張for文」のようなイメージです。
                        </p>
                    </div>

                    <!-- 繰り返しのステータス -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">ステータス変数 - 繰り返しのステータス</span>
                        <p>
                            繰り返し処理では「今何番目？」「最初？最後？」といった<strong>状態（ステータス）</strong>を知りたいことがあります。
                            Thymeleafでは<strong>ステータス変数</strong>を使って、これらの情報を取得できます。
                        </p>

                        <!-- 構文の説明 -->
                        <div style="margin: 20px 0; padding: 20px; background: #fef3c7; border-radius: 10px; border: 2px solid #f59e0b;">
                            <h5 style="color: #92400e; margin-bottom: 15px;">📝 ステータス変数の書き方</h5>
                            <div style="background: #1e1e1e; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 14px; color: #d4d4d4; margin-bottom: 15px;">
                                th:each="<span style="color: #4ec9b0;">要素変数</span>, <span style="color: #f97316; font-weight: bold;">ステータス変数</span> : ${繰り返すリスト}"
                            </div>
                            <p style="color: #78350f; font-size: 14px; margin: 0;">
                                要素変数の後ろに<strong>カンマ（,）</strong>で区切って、ステータス変数を追加します。
                            </p>
                        </div>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.19 繰り返しのステータス</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 16：繰り返しのステータス --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:each</span>=<span class="value">"member, s : ${members}"</span> <span class="attr">th:object</span>=<span class="value">"${member}"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>
        index-&gt; [[${s.index}]], count-&gt; [[${s.count}]],
        size-&gt; [[${s.size}]], current-&gt; [[${s.current}]],
        even-&gt; [[${s.even}]], odd-&gt; [[${s.odd}]],
        first-&gt; [[${s.first}]], last-&gt; [[${s.last}]],
        [[*{id}]]：[[*{name}]]
    <span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                            </div>
                        </div>

                        <!-- コードの解説 -->
                        <div style="margin: 20px 0; padding: 20px; background: #ecfdf5; border-radius: 10px; border: 1px solid #6ee7b7;">
                            <h5 style="color: #065f46; margin-bottom: 15px;">🔍 コードの解説</h5>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                                <p style="margin: 0 0 10px 0; font-family: monospace; font-size: 14px; color: #1e1e1e;">
                                    th:each="<span style="background: #dbeafe; padding: 2px 6px; border-radius: 4px; color: #1e40af;">member</span>, <span style="background: #fed7aa; padding: 2px 6px; border-radius: 4px; color: #c2410c;">s</span> : <span style="background: #dcfce7; padding: 2px 6px; border-radius: 4px; color: #166534;">${members}</span>"
                                </p>
                                <ul style="margin: 10px 0 0 0; padding-left: 20px; line-height: 2; font-size: 14px;">
                                    <li><span style="background: #dbeafe; padding: 2px 6px; border-radius: 4px; color: #1e40af;">member</span> → 各要素を格納する変数（1件ずつのデータ）</li>
                                    <li><span style="background: #fed7aa; padding: 2px 6px; border-radius: 4px; color: #c2410c;">s</span> → <strong>ステータス変数</strong>（繰り返しの状態を持つ）</li>
                                    <li><span style="background: #dcfce7; padding: 2px 6px; border-radius: 4px; color: #166534;">${members}</span> → 繰り返し処理するリスト</li>
                                </ul>
                            </div>
                        </div>

                        <!-- 重要ポイント -->
                        <div style="margin: 20px 0; padding: 20px; background: #fef2f2; border-radius: 10px; border: 2px solid #ef4444; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2);">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <span style="font-size: 24px;">⭐</span>
                                <span style="color: #dc2626; font-weight: bold; font-size: 16px;">重要ポイント</span>
                            </div>
                            <p style="color: #991b1b; font-size: 15px; margin: 0; line-height: 1.8;">
                                ステータス変数「<code style="background: #fee2e2; padding: 3px 8px; border-radius: 4px; color: #dc2626; font-weight: bold; font-size: 16px;">s</code>」を使って、
                                <code style="background: #fee2e2; padding: 3px 8px; border-radius: 4px; color: #dc2626; font-weight: bold;">s.index</code>や<code style="background: #fee2e2; padding: 3px 8px; border-radius: 4px; color: #dc2626; font-weight: bold;">s.count</code>のように<strong>状態を取得</strong>できます。
                            </p>
                        </div>

                        <p style="margin-bottom: 15px;">
                            ステータス変数で使用できるプロパティの一覧です：
                        </p>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ステータス変数</th>
                                        <th>機能概要</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>index</code></td>
                                        <td>0から始まるインデックス、現在のインデックスを表示する</td>
                                    </tr>
                                    <tr>
                                        <td><code>count</code></td>
                                        <td>1から始まるインデックス、現在のインデックスを表示する</td>
                                    </tr>
                                    <tr>
                                        <td><code>size</code></td>
                                        <td>【繰り返し処理するオブジェクト】のサイズを表示する</td>
                                    </tr>
                                    <tr>
                                        <td><code>current</code></td>
                                        <td>現在の繰り返し要素のオブジェクトを表示する</td>
                                    </tr>
                                    <tr>
                                        <td><code>even</code></td>
                                        <td>
                                            現在の要素が偶数番目か判定する。偶数ならtrue、偶数じゃないならfalseを表示する
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><code>odd</code></td>
                                        <td>
                                            現在の要素が奇数番目か判定する。奇数ならtrue、奇数じゃないならfalseを表示する
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><code>first</code></td>
                                        <td>
                                            現在の要素が最初か判定する。最初ならtrue、最初じゃないならfalseを表示する
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><code>last</code></td>
                                        <td>
                                            現在の要素が最後か判定する。最後ならtrue、最後じゃないならfalseを表示する
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ユーティリティオブジェクト -->
                    <div class="th-attr-card">
                        <span class="th-attr-name">#オブジェクト - ユーティリティオブジェクト</span>
                        <p>
                            「Thymeleaf」は、よく使われるクラスを「#名前」という定数として定義しているため、変数式の中で利用することができます。データ出力時に、よく利用されるのが「数値、日時、文字列」のフォーマット変換です。
                        </p>

                        <!-- 構文の説明 -->
                        <div style="margin: 20px 0; padding: 20px; background: #f0f9ff; border-radius: 10px; border: 2px solid #0ea5e9;">
                            <h5 style="color: #0369a1; margin-bottom: 15px;">📝 使い方の構文</h5>
                            <div style="background: #1e1e1e; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 14px; color: #d4d4d4; margin-bottom: 15px;">
                                ${<span style="color: #f97316; font-weight: bold;">#オブジェクト名</span>.<span style="color: #4ade80;">メソッド名</span>(<span style="color: #facc15;">引数</span>)}
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <p style="margin: 0 0 10px 0; font-size: 14px; color: #0c4a6e;"><strong>例：数値を3桁区切りでフォーマット</strong></p>
                                <div style="background: #f0f9ff; padding: 10px 15px; border-radius: 6px; font-family: monospace; font-size: 13px; color: #1e1e1e;">
                                    ${<span style="color: #f97316; font-weight: bold;">#numbers</span>.<span style="color: #4ade80;">formatInteger</span>(<span style="color: #facc15;">x, 3, 'COMMA'</span>)}
                                </div>
                                <ul style="margin: 10px 0 0 0; padding-left: 20px; font-size: 13px; color: #475569; line-height: 1.8;">
                                    <li><span style="color: #f97316; font-weight: bold;">#numbers</span> → 数値用のユーティリティオブジェクト</li>
                                    <li><span style="color: #4ade80; font-weight: bold;">formatInteger</span> → 整数をフォーマットするメソッド</li>
                                    <li><span style="color: #facc15; font-weight: bold;">x, 3, 'COMMA'</span> → 引数（値, 桁数, 区切り文字）</li>
                                </ul>
                            </div>
                        </div>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ユーティリティオブジェクト</th>
                                        <th>機能概要</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>#strings</code></td>
                                        <td>Stringクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#numbers</code></td>
                                        <td>Numberクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#bools</code></td>
                                        <td>Booleanクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#dates</code></td>
                                        <td>Dateクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#objects</code></td>
                                        <td>Objectクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#arrays</code></td>
                                        <td>Arrayクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#lists</code></td>
                                        <td>Listクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#sets</code></td>
                                        <td>Setクラスの定数</td>
                                    </tr>
                                    <tr>
                                        <td><code>#maps</code></td>
                                        <td>Mapクラスの定数</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 数値フォーマット -->
                        <div style="margin-top: 25px; padding: 20px; background: #fef3c7; border-radius: 10px; border-left: 4px solid #f59e0b;">
                            <h5 style="color: #92400e; margin-bottom: 15px;">🔢 数値のフォーマット（#numbers）</h5>
                            <div class="code-block" style="margin-bottom: 15px;">
                                <div class="code-header">
                                    <span class="code-title">リスト6.20 ユーティリティオブジェクト（数値）</span>
                                    <span class="code-lang">HTML</span>
                                </div>
                                <div class="code-content">
                                    <pre><span class="code-comment">&lt;!-- 17：ユーティリティオブジェクト（数値） --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:with</span>=<span class="value">"x=1000000, y=123456.789"</span><span class="tag">&gt;</span>
    整数のフォーマット：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#numbers.formatInteger(x, 3, 'COMMA')}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    浮動小数点のフォーマット：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#numbers.formatDecimal(y, 3, 'COMMA', 2, 'POINT')}"</span><span class="tag">&gt;&lt;/span&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                                </div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px; color: #92400e; font-weight: bold;">入力値</td>
                                        <td style="padding: 8px; color: #92400e; font-weight: bold;">メソッド</td>
                                        <td style="padding: 8px; color: #92400e; font-weight: bold;">出力結果</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>1000000</code></td>
                                        <td style="padding: 8px;"><code>#numbers.formatInteger</code></td>
                                        <td style="padding: 8px;"><strong>1,000,000</strong>（3桁区切り）</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px;"><code>123456.789</code></td>
                                        <td style="padding: 8px;"><code>#numbers.formatDecimal</code></td>
                                        <td style="padding: 8px;"><strong>123,456.79</strong>（3桁区切り＋小数点2桁）</td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <!-- 日時フォーマット -->
                        <div style="margin-top: 25px; padding: 20px; background: #dbeafe; border-radius: 10px; border-left: 4px solid #3b82f6;">
                            <h5 style="color: #1e40af; margin-bottom: 15px;">📅 日時のフォーマット（#dates）</h5>
                            <div class="code-block" style="margin-bottom: 15px;">
                                <div class="code-header">
                                    <span class="code-title">リスト6.21 ユーティリティオブジェクト（日時）</span>
                                    <span class="code-lang">HTML</span>
                                </div>
                                <div class="code-content">
                                    <pre><span class="code-comment">&lt;!-- 17：ユーティリティオブジェクト（日時） --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:with</span>=<span class="value">"today=${#dates.createNow()}"</span><span class="tag">&gt;</span>
    yyyy/mm/dd形式：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#dates.format(today, 'yyyy/MM/dd')}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    yyyy年mm月dd日形式：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#dates.format(today, 'yyyy年MM月dd日')}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    yyyy年：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#dates.year(today)}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    MM月：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#dates.month(today)}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    dd日：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#dates.day(today)}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    曜日：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#dates.dayOfWeek(today)}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                                </div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <p style="margin: 0 0 10px 0; font-size: 14px; color: #1e40af;"><strong>例：今日が 2024年12月25日（水）の場合</strong></p>
                                <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px; color: #1e40af; font-weight: bold;">メソッド</td>
                                        <td style="padding: 8px; color: #1e40af; font-weight: bold;">出力結果</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>#dates.format(today, 'yyyy/MM/dd')</code></td>
                                        <td style="padding: 8px;"><strong>2024/12/25</strong></td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>#dates.format(today, 'yyyy年MM月dd日')</code></td>
                                        <td style="padding: 8px;"><strong>2024年12月25日</strong></td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>#dates.year(today)</code></td>
                                        <td style="padding: 8px;"><strong>2024</strong>（年だけ取得）</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>#dates.month(today)</code></td>
                                        <td style="padding: 8px;"><strong>12</strong>（月だけ取得）</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>#dates.day(today)</code></td>
                                        <td style="padding: 8px;"><strong>25</strong>（日だけ取得）</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px;"><code>#dates.dayOfWeek(today)</code></td>
                                        <td style="padding: 8px;"><strong>4</strong>（曜日：日=1, 月=2, ..., 土=7）</td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <!-- 文字列操作 -->
                        <div style="margin-top: 25px; padding: 20px; background: #dcfce7; border-radius: 10px; border-left: 4px solid #22c55e;">
                            <h5 style="color: #166534; margin-bottom: 15px;">📝 文字列の操作（#strings）</h5>
                            <div class="code-block" style="margin-bottom: 15px;">
                                <div class="code-header">
                                    <span class="code-title">リスト6.22 ユーティリティオブジェクト（文字列）</span>
                                    <span class="code-lang">HTML</span>
                                </div>
                                <div class="code-content">
                                    <pre><span class="code-comment">&lt;!-- 17：ユーティリティオブジェクト（文字列） --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:with</span>=<span class="value">"str1='abcdef'"</span><span class="tag">&gt;</span>
    大文字変換：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#strings.toUpperCase(str1)}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    空文字判定：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#strings.isEmpty(str1)}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
    長さ：<span class="tag">&lt;span</span> <span class="attr">th:text</span>=<span class="value">"${#strings.length(str1)}"</span><span class="tag">&gt;&lt;/span&gt;&lt;br/&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                                </div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <p style="margin: 0 0 10px 0; font-size: 14px; color: #166534;"><strong>例：str1 = "abcdef" の場合</strong></p>
                                <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px; color: #166534; font-weight: bold;">メソッド</td>
                                        <td style="padding: 8px; color: #166534; font-weight: bold;">出力結果</td>
                                        <td style="padding: 8px; color: #166534; font-weight: bold;">説明</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>#strings.toUpperCase(str1)</code></td>
                                        <td style="padding: 8px;"><strong>ABCDEF</strong></td>
                                        <td style="padding: 8px;">大文字に変換</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 8px;"><code>#strings.isEmpty(str1)</code></td>
                                        <td style="padding: 8px;"><strong>false</strong></td>
                                        <td style="padding: 8px;">空文字かどうか判定</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px;"><code>#strings.length(str1)</code></td>
                                        <td style="padding: 8px;"><strong>6</strong></td>
                                        <td style="padding: 8px;">文字数を取得</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- HTMLファイルの部品化 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-3-3</span>
                        <h3 class="subsection-title">HTMLファイルの部品化（フラグメント）</h3>
                    </div>

                    <p>
                        コードに重複があるとメンテナンスが煩雑になります。「フラグメント」を使い共通部分を部品化してメンテナンスしやすいコードを書きましょう。「フラグメント」とは「断片」という意味です。フラグメントは、HTMLの一部分を切り出して再利用するための機能です。例えば、ヘッダーやフッターなど、複数のページで共通して使う部分を一箇所にまとめることができます。
                    </p>

                    <!-- フラグメントの図解 -->
                    <div class="diagram-container" style="margin: 25px 0;">
                        <div class="diagram-title">フラグメントのイメージ図</div>
                        <svg viewBox="0 0 750 320" style="max-width: 100%; height: auto;">
                            <defs>
                                <linearGradient id="commonGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #8b5cf6" />
                                    <stop offset="100%" style="stop-color: #7c3aed" />
                                </linearGradient>
                                <linearGradient id="mainGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color: #3b82f6" />
                                    <stop offset="100%" style="stop-color: #2563eb" />
                                </linearGradient>
                                <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #f97316" />
                                    <stop offset="100%" style="stop-color: #ea580c" />
                                </linearGradient>
                                <linearGradient id="footerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color: #22c55e" />
                                    <stop offset="100%" style="stop-color: #16a34a" />
                                </linearGradient>
                            </defs>

                            <!-- 背景 -->
                            <rect x="5" y="5" width="740" height="310" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" />

                            <!-- 左側：common.html（部品ファイル） -->
                            <rect x="30" y="30" width="220" height="260" rx="10" fill="white" stroke="url(#commonGrad)" stroke-width="3" />
                            <rect x="30" y="30" width="220" height="40" rx="10" fill="url(#commonGrad)" />
                            <text x="140" y="57" text-anchor="middle" font-size="14" fill="white" font-weight="bold">common.html</text>
                            <text x="140" y="95" text-anchor="middle" font-size="11" fill="#6b7280">（部品を定義するファイル）</text>

                            <!-- ヘッダー部品 -->
                            <rect x="50" y="115" width="180" height="50" rx="6" fill="url(#headerGrad)" />
                            <text x="140" y="137" text-anchor="middle" font-size="11" fill="white" font-weight="bold">🏷️ header</text>
                            <text x="140" y="155" text-anchor="middle" font-size="10" fill="white">th:fragment="header"</text>

                            <!-- フッター部品 -->
                            <rect x="50" y="180" width="180" height="50" rx="6" fill="url(#footerGrad)" />
                            <text x="140" y="202" text-anchor="middle" font-size="11" fill="white" font-weight="bold">🏷️ footer</text>
                            <text x="140" y="220" text-anchor="middle" font-size="10" fill="white">th:fragment="footer"</text>

                            <text x="140" y="260" text-anchor="middle" font-size="10" fill="#9ca3af">部品を名前で定義</text>

                            <!-- 矢印 -->
                            <path d="M 260 160 L 320 100" stroke="#f97316" stroke-width="3" fill="none" marker-end="url(#arrowOrange)" stroke-dasharray="8,4" />
                            <path d="M 260 190 L 320 250" stroke="#22c55e" stroke-width="3" fill="none" marker-end="url(#arrowGreen)" stroke-dasharray="8,4" />
                            <defs>
                                <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#f97316" />
                                </marker>
                                <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#22c55e" />
                                </marker>
                            </defs>

                            <!-- 中央：矢印ラベル -->
                            <text x="290" y="145" text-anchor="middle" font-size="10" fill="#f97316" font-weight="bold">呼び出し</text>
                            <text x="290" y="220" text-anchor="middle" font-size="10" fill="#22c55e" font-weight="bold">呼び出し</text>

                            <!-- 右側：main.html（利用するファイル） -->
                            <rect x="340" y="30" width="380" height="260" rx="10" fill="white" stroke="url(#mainGrad)" stroke-width="3" />
                            <rect x="340" y="30" width="380" height="40" rx="10" fill="url(#mainGrad)" />
                            <text x="530" y="57" text-anchor="middle" font-size="14" fill="white" font-weight="bold">main.html</text>

                            <!-- ヘッダー挿入位置 -->
                            <rect x="360" y="85" width="340" height="45" rx="6" fill="#fff7ed" stroke="#f97316" stroke-width="2" stroke-dasharray="4,2" />
                            <text x="530" y="105" text-anchor="middle" font-size="11" fill="#c2410c" font-weight="bold">🔗 ヘッダーが挿入される</text>
                            <text x="530" y="120" text-anchor="middle" font-size="9" fill="#9a3412">th:insert="~{common :: header}"</text>

                            <!-- コンテンツ -->
                            <rect x="360" y="140" width="340" height="60" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1" />
                            <text x="530" y="165" text-anchor="middle" font-size="12" fill="#475569" font-weight="bold">📄 ページ固有のコンテンツ</text>
                            <text x="530" y="185" text-anchor="middle" font-size="10" fill="#64748b">（各ページで異なる内容）</text>

                            <!-- フッター挿入位置 -->
                            <rect x="360" y="210" width="340" height="45" rx="6" fill="#E0F7FA" stroke="#22c55e" stroke-width="2" stroke-dasharray="4,2" />
                            <text x="530" y="230" text-anchor="middle" font-size="11" fill="#166534" font-weight="bold">🔗 フッターが挿入される</text>
                            <text x="530" y="245" text-anchor="middle" font-size="9" fill="#15803d">th:insert="~{common :: footer}"</text>

                            <text x="530" y="280" text-anchor="middle" font-size="10" fill="#64748b">部品を名前で呼び出して使う</text>
                        </svg>
                    </div>

                    <!-- メリットの説明 -->
                    <div style="margin: 20px 0; padding: 20px; background: #E0F7FA; border-radius: 10px; border: 1px solid #86efac;">
                        <h5 style="color: #166534; margin-bottom: 15px;">✨ フラグメントのメリット</h5>
                        <ul style="margin: 0; padding-left: 20px; line-height: 2; color: #166534;">
                            <li><strong>一箇所で管理</strong>：ヘッダーを変更したい時、common.html だけ修正すればOK</li>
                            <li><strong>重複を削減</strong>：同じコードを何度も書く必要がない</li>
                            <li><strong>ミスを防止</strong>：修正漏れによるページ間の不一致を防げる</li>
                        </ul>
                    </div>

                    <p>
                        ファイル「common.html」に共通で使う部分を記述し、共通で使う部分を利用するファイルを「main.html」とします。「フラグメント」を利用するには「th:fragment」属性を利用します。「th:fragment」属性を指定した要素内の子要素がフラグメント対象になります。属性にはフラグメントを「識別する名称」を指定します。
                    </p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">リスト6.23 フラグメントの定義</span>
                            <span class="code-lang">HTML</span>
                        </div>
                        <div class="code-content">
                            <pre><span class="code-comment">&lt;!-- common.html --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:fragment</span>=<span class="value">"header"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;h1&gt;</span>=== 【ヘッダー】 ===<span class="tag">&lt;/h1&gt;</span>
<span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:fragment</span>=<span class="value">"footer"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;h1&gt;</span>=== 【フッター】 ===<span class="tag">&lt;/h1&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                        </div>
                    </div>

                    <p>
                        2行目「th:fragment="header"」、5行目「th:fragment="footer"」でフラグメントの「識別する名称」を定義しています。
                    </p>

                    <div class="th-attr-card">
                        <span class="th-attr-name">th:insert - フラグメントの挿入</span>
                        <p>フラグメントのインクルードには「th:insert」を使用します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.24 フラグメントの挿入</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- main.html --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:insert</span>=<span class="value">"common :: header"</span><span class="tag">&gt;&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「th:insert」を使うと、「common.html」の中にある「header」フラグメントを挿入します。「::」の左辺に「フラグメントのファイル名」、右辺に「th:fragment属性に定義された【識別名称】」を指定します。
                        </p>
                    </div>

                    <div class="th-attr-card">
                        <span class="th-attr-name">th:replace - フラグメントの置換</span>
                        <p>フラグメントの置換には「th:replace」を使用します。</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.25 フラグメントの置換</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- main.html --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">th:replace</span>=<span class="value">"common :: footer"</span><span class="tag">&gt;&lt;/div&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            「th:replace」を使うと、このdivタグ自体が「common.html」の「footer」フラグメントに置き換わります。
                        </p>
                    </div>

                    <div class="th-attr-card">
                        <span class="th-attr-name">th:block - 余計なタグを残さない</span>
                        <p>
                            「th:if」や「th:unless」の処理を書くためだけに&lt;div&gt;タグを増やす処理をしたくない場合は、「&lt;th:block&gt;」タグの属性に「th:if」や「th:unless」を記述します。「&lt;th:block&gt;」タグは、レンダリング後に消去され、「HTML」のソースに残りません。
                        </p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-title">リスト6.26 th:blockの例</span>
                                <span class="code-lang">HTML</span>
                            </div>
                            <div class="code-content">
                                <pre><span class="code-comment">&lt;!-- 08：条件分岐（true） --&gt;</span>
<span class="tag">&lt;th:block</span> <span class="attr">th:if</span>=<span class="value">"${name} == '太郎'"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>太郎さんです！<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/th:block&gt;</span></pre>
                            </div>
                        </div>
                        <p>
                            確認は、ブラウザの開発者ツールを利用することで確認できます。本書ではブラウザに「Google
                            Chrome」を利用しているので、ブラウザ上でマウスの「右クリック→検証」をクリックすることで開発者ツールを起動し、確認しています。
                        </p>
                    </div>
                </div>

                <!-- コントローラとビューの作成 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-3-4</span>
                        <h3 class="subsection-title">コントローラとビューの作成</h3>
                    </div>

                    <div class="step">
                        <div class="step-number">01</div>
                        <div class="step-content">
                            <h4>コントローラの作成</h4>
                            <p>
                                「コントローラ」を作成します。VSCodeで以下の手順でファイルを作成します。
                            </p>

                            <!-- VSCode手順 -->
                            <div style="margin: 15px 0; padding: 20px; background: #eff6ff; border-radius: 10px; border: 1px solid #93c5fd;">
                                <h5 style="color: #1e40af; margin-bottom: 15px;">VSCodeでのファイル作成手順</h5>
                                <ol style="margin: 0; padding-left: 20px; line-height: 2; color: #1e3a8a;">
                                    <li><code style="background:#dbeafe; padding:2px 8px; border-radius:4px; color:#1e40af;">src/main/java/com/example/demo</code> フォルダを右クリック</li>
                                    <li>「<strong>新しいフォルダー</strong>」を選択し、<code style="background:#dbeafe; padding:2px 8px; border-radius:4px; color:#1e40af;">controller</code> を作成</li>
                                    <li><code style="background:#dbeafe; padding:2px 8px; border-radius:4px; color:#1e40af;">controller</code> フォルダを右クリック →「<strong>新しいファイル</strong>」を選択</li>
                                    <li>ファイル名を <code style="background:#fef3c7; padding:2px 8px; border-radius:4px; color:#92400e;">ThymeleafController.java</code> として作成</li>
                                </ol>
                            </div>

                            <!-- フォルダ構成図 -->
                            <div style="margin: 15px 0; padding: 15px; background: #1e1e1e; border-radius: 8px; font-family: monospace; font-size: 13px; color: #d4d4d4;">
                                <div style="color: #9ca3af;">src/main/java/com/example/demo/</div>
                                <div style="padding-left: 20px;">
                                    <span style="color: #fbbf24;">controller/</span><span style="color: #6b7280;"> ← 新規作成</span><br>
                                    <span style="padding-left: 20px; color: #4ade80;">ThymeleafController.java</span><span style="color: #6b7280;"> ← 新規作成</span>
                                </div>
                            </div>
                            <div class="prompt-box">
                                <div class="prompt-box-header">
                                    <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
                                    <span class="prompt-box-title">プロンプト</span>
                                    <button class="prompt-copy-btn">コピー</button>
                                </div>
                                <div class="prompt-box-content">
                                    <pre><code>## 機能
Thymeleafテンプレートを表示するための基本コントローラを作成

## 実装要件
- URLパス「/show」へのGETリクエストを処理
- 引数にModelを受け取る（後でデータ追加のため）
- ビュー名「main」を返す

## 使用するSpring構文/アノテーション
- @Controller
- @GetMapping
- Model（引数として受け取り）</code></pre>
                                </div>
                            </div>

                            <div class="code-block">
                                <div class="code-header">
                                    <span class="code-title">リスト6.27 ThymeleafController</span>
                                    <span class="code-lang">Java</span>
                                </div>

                                <div class="code-content">
                                    <pre><span class="code-keyword">package</span> com.example.demo.controller;

<span class="code-keyword">import</span> org.springframework.stereotype.Controller;
<span class="code-keyword">import</span> org.springframework.ui.Model;
<span class="code-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;

<span class="code-annotation">@Controller</span>
<span class="code-keyword">public class</span> ThymeleafController {
    <span class="code-annotation">@GetMapping</span>(<span class="code-string">"show"</span>)
    <span class="code-keyword">public</span> String showView(Model model) {
        <span class="code-comment">// 戻り値は「ビュー名」を返す</span>
        <span class="code-keyword">return</span> <span class="code-string">"main"</span>;
    }
}</pre>
                                </div>
                            </div>
                            <p>
                                クライアントからURL「http://localhost:8080/show」がGETメソッドで送信されると、「ThymeleafController」クラスの「showView」メソッドが呼ばれ、12行目で戻り値として「ビュー名：main」を返します。後で使用するので、10行目の引数に「Model型」を設定します。
                            </p>
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">02</div>
                        <div class="step-content">
                            <h4>ビューの作成</h4>
                            <p>
                                「showView」メソッドの戻り値「ビュー名:main」に対する「main.html」を作成し、「resources/templates」フォルダに配置します。「main.html」の内容は以下になります。2行目に「Thymeleafを使用すること」を宣言します。
                            </p>

                            <!-- VSCode手順 -->
                            <div style="margin: 15px 0; padding: 20px; background: #eff6ff; border-radius: 10px; border: 1px solid #93c5fd;">
                                <h5 style="color: #1e40af; margin-bottom: 15px;">VSCodeでのファイル作成手順</h5>
                                <ol style="margin: 0; padding-left: 20px; line-height: 2; color: #1e3a8a;">
                                    <li><code style="background:#dbeafe; padding:2px 8px; border-radius:4px; color:#1e40af;">src/main/resources/templates</code> フォルダを右クリック</li>
                                    <li>「<strong>新しいファイル</strong>」を選択</li>
                                    <li>ファイル名を <code style="background:#fef3c7; padding:2px 8px; border-radius:4px; color:#92400e;">main.html</code> として作成</li>
                                </ol>
                            </div>

                            <!-- フォルダ構成図 -->
                            <div style="margin: 15px 0; padding: 15px; background: #1e1e1e; border-radius: 8px; font-family: monospace; font-size: 13px; color: #d4d4d4;">
                                <div style="color: #9ca3af;">src/main/resources/</div>
                                <div style="padding-left: 20px;">
                                    <span style="color: #fbbf24;">templates/</span><br>
                                    <span style="padding-left: 20px; color: #4ade80;">main.html</span><span style="color: #6b7280;"> ← 新規作成</span>
                                </div>
                            </div>

                            <div class="code-block">
                                <div class="code-header">
                                    <span class="code-title">リスト6.28 main.html</span>
                                    <span class="code-lang">HTML</span>
                                </div>
                                <div class="code-content">
                                    <pre><span class="tag">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attr">xmlns:th</span>=<span class="value">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span>
<span class="tag">&lt;head&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attr">charset</span>=<span class="value">"UTF-8"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;title&gt;</span>Thymeleaf Sample<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;/head&gt;</span>
<span class="tag">&lt;body&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 実例：直接文字を埋め込むから値結合 -->
                <div class="subsection">
                    <div class="subsection-header">
                        <span class="subsection-number">6-3-5</span>
                        <h3 class="subsection-title">「直接文字を埋め込む」から「値結合」の実例</h3>
                    </div>

                    <div class="step">
                        <div class="step-number">01</div>
                        <div class="step-content">
                            <h4>コントローラへの追記</h4>
                            <p>「コントローラ：ThymeleafController」の「showView」メソッドに以下の内容を追記します。</p>
                            <div class="prompt-box">
                                <div class="prompt-box-header">
                                    <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
                                    <span class="prompt-box-title">プロンプト</span>
                                    <button class="prompt-copy-btn">コピー</button>
                                </div>
                                <div class="prompt-box-content">
                                    <pre><code>## 機能
Modelにデータを格納してビューに渡すメソッドに修正

## 実装要件
- URLパス「/show」へのGETリクエストを処理
- Modelに名前「太郎」を「name」というキーで格納
- ビュー名「main」を返す

## 使用するSpring構文/アノテーション
- @GetMapping
- Model.addAttribute()</code></pre>
                                </div>
                            </div>

                            <div class="code-block">
                                <div class="code-header">
                                    <span class="code-title">リスト6.29 ThymeleafControllerの追記</span>
                                    <span class="code-lang">Java</span>
                                </div>
                                <div class="code-content">
                                    <pre><span class="code-annotation">@GetMapping</span>(<span class="code-string">"show"</span>)
<span class="code-keyword">public</span> String showView(Model model) {
    <span class="code-comment">// 「Model」にデータを格納する</span>
    model.addAttribute(<span class="code-string">"name"</span>, <span class="code-string">"太郎"</span>);
    <span class="code-comment">// 戻り値は「ビュー名」を返す</span>
    <span class="code-keyword">return</span> <span class="code-string">"main"</span>;
}</pre>
                                </div>
                            </div>
                            <p>
                                4行目「リクエストハンドラメソッド」内にて「ビュー」で「表示したいデータ」を「Model」のメソッド「addAttribute(名前,
                                値)」を使用して格納します。「名前：name」、「値：太郎」を設定しました。Thymeleafでは「データを埋め込む場所」を「${名前}」を使用して表示します。
                            </p>
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">02</div>
                        <div class="step-content">
                            <h4>ビューへの追記</h4>
                            <p>「ビュー：main.html」の「bodyタグの中」に以下の内容を追記します。</p>
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="code-title">リスト6.30 main.htmlへの追記</span>
                                    <span class="code-lang">HTML</span>
                                </div>
                                <div class="code-content">
                                    <pre><span class="code-comment">&lt;!-- 01：直接文字を埋め込む --&gt;</span>
<span class="tag">&lt;h1</span> <span class="attr">th:text</span>=<span class="value">"'hello world'"</span><span class="tag">&gt;</span>表示する部分<span class="tag">&lt;/h1&gt;</span>
<span class="code-comment">&lt;!-- 02：インライン処理 --&gt;</span>
<span class="tag">&lt;h1&gt;</span>こんにちは！[[${name}]]さん<span class="tag">&lt;/h1&gt;</span>
<span class="code-comment">&lt;!-- 03：値結合 --&gt;</span>
<span class="tag">&lt;h1</span> <span class="attr">th:text</span>=<span class="value">"'明日は、' + '晴れ' + 'です。'"</span><span class="tag">&gt;</span>表示する部分<span class="tag">&lt;/h1&gt;</span></pre>
                                </div>
                            </div>
                            <p>
                                4行目でModelに「値：太郎」を格納した時に設定した、「名前：name」を${name}の形で使用します。また[[
                                ${name} ]]の形で使用すると、タグの属性への追加ではなく本体へ変数を埋め込めます。
                            </p>
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">03</div>
                        <div class="step-content">
                            <h4>確認</h4>
                            <p>
                                アプリケーションを起動して動作確認を行います。
                            </p>

                            <!-- VSCode起動手順 -->
                            <div style="margin: 15px 0; padding: 20px; background: #E0F7FA; border-radius: 10px; border: 1px solid #86efac;">
                                <h5 style="color: #166534; margin-bottom: 15px;">🚀 VSCodeでの起動方法</h5>
                                <div style="color: #14532d;">
                                    <p style="margin-bottom: 10px;"><strong>方法1: Spring Boot Dashboard を使用</strong></p>
                                    <ol style="margin: 0 0 15px 0; padding-left: 20px; line-height: 2;">
                                        <li>左サイドバーの「<strong>Spring Boot Dashboard</strong>」アイコンをクリック</li>
                                        <li>プロジェクト名を右クリック →「<strong>Run</strong>」を選択</li>
                                    </ol>
                                    <p style="margin-bottom: 10px;"><strong>方法2: ターミナルを使用</strong></p>
                                    <div style="background: #1e1e1e; padding: 10px 15px; border-radius: 6px; font-family: monospace; color: #4ade80;">
                                        ./mvnw spring-boot:run
                                    </div>
                                </div>
                            </div>

                            <p style="margin: 15px 0;">
                                起動後、ブラウザを開き、アドレスバーに「<code style="background:#e0e7ff; padding:2px 8px; border-radius:4px; color:#3730a3;">http://localhost:8080/show</code>」と入力します。
                            </p>

                            <div class="info-box success">
                                <h4>✅ 表示結果</h4>
                                <p><strong>hello world</strong></p>
                                <p><strong>こんにちは！太郎さん</strong></p>
                                <p><strong>明日は、晴れです。</strong></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- フッター -->
        <footer class="footer">
            <p>第6章 テンプレートエンジン（Thymeleaf）を知ろう</p>
        </footer>

        <div class="page-nav">
            <a href="5mvc-tutorial.html" class="page-nav-btn prev">
                <span>←</span>
                <div>
                    <div class="page-nav-label">前の章</div>
                    <div class="page-nav-title">第5章</div>
                </div>
            </a>

            <a href="7ServerDataSubmission.html" class="page-nav-btn next">
                <div>
                    <div class="page-nav-label">次の章</div>
                    <div class="page-nav-title">第7章</div>
                </div>
                <span>→</span>
            </a>
        </div>

        <script>
            function toggleMenu() {
                const toggle = document.querySelector(".nav-toggle");
                const menu = document.querySelector(".nav-menu");
                toggle.classList.toggle("active");
                menu.classList.toggle("active");
            }

            document.addEventListener("click", function (e) {
                const nav = document.querySelector(".global-nav");
                const toggle = document.querySelector(".nav-toggle");
                const menu = document.querySelector(".nav-menu");

                if (!nav.contains(e.target) && menu.classList.contains("active")) {
                    toggle.classList.remove("active");
                    menu.classList.remove("active");
                }
            });

            window.addEventListener("resize", function () {
                if (window.innerWidth >= 1024) {
                    const toggle = document.querySelector(".nav-toggle");
                    const menu = document.querySelector(".nav-menu");
                    toggle.classList.remove("active");
                    menu.classList.remove("active");
                }
            });
        </script>
    </body>
</html>
