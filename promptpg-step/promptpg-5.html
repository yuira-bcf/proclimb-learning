<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Step 5: ãƒ‡ãƒ¼ã‚¿ç™»éŒ²</title>

        <link
            href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&family=M+PLUS+Rounded+1c:wght@400;500;700&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="../shared/common.css" />
        <style>
  :root {
    --primary: #AF52DE;
    --primary-dark: #9333EA;
    --primary-light: #FAF5FF;
    --primary-lighter: #E9D5FF;
  }
  .nav-category-links { display: none; }
</style>
        <style>
            .download-btn {
                background: #22c55e;
                color: white;
                border: none;
                padding: 6px 14px;
                border-radius: 6px;
                font-size: 12px;
                font-weight: 600;
                cursor: pointer;
                margin-left: auto;
            }
            .code-header { display: flex; align-items: center; justify-content: space-between; }
            .step-indicator { display: flex; justify-content: center; gap: 0.5rem; margin: 2rem 0; flex-wrap: wrap; }
            .step-dot { width: 36px; height: 36px; border-radius: 50%; background: #e2e8f0; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; color: #64748b; }
            .step-dot.active { background: #3b82f6; color: white; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4); }
            .step-dot.completed { background: #22c55e; color: white; }
            .file-badge { display: inline-block; background: #3b82f6; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-right: 8px; }
            .file-badge.new { background: #22c55e; }
            .file-badge.modified { background: #f59e0b; }
        </style>
    </head>
    <body>
        <nav class="global-nav"></nav>
        <script src="../shared/js/nav-promptpg-step.js"></script>

        <div class="container">
            <div class="step-indicator">
                <div class="step-dot completed">1</div>
                <div class="step-dot completed">2</div>
                <div class="step-dot completed">3</div>
                <div class="step-dot completed">4</div>
                <div class="step-dot active">5</div>
                <div class="step-dot">6</div>
                <div class="step-dot">7</div>
                <div class="step-dot">8</div>
            </div>

            <header class="chapter-header">
                <div class="chapter-badge">ğŸš€ Step</div>
                <div class="chapter-number">5</div>
                <h1 class="chapter-title">ãƒ‡ãƒ¼ã‚¿ç™»éŒ²</h1>
            </header>

            <nav class="toc">
                <h2 class="toc-title"><span class="material-icons">list_alt</span> ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã®å†…å®¹</h2>
                <ul class="toc-list">
                    <li class="toc-item"><span class="toc-number">5-1</span><span>æ¦‚è¦</span></li>
                    <li class="toc-item"><span class="toc-number">5-2</span><span>ä»•æ§˜</span></li>
                    <li class="toc-item"><span class="toc-number">5-3</span><span>ã‚¢ãƒ—ãƒªä»•æ§˜</span></li>
                    <li class="toc-item"><span class="toc-number">5-4</span><span>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ç”Ÿæˆ</span></li>
                    <li class="toc-item"><span class="toc-number">5-5</span><span>è¿½åŠ ãƒ»å¤‰æ›´ç®‡æ‰€ã®è§£èª¬</span></li>
                </ul>
            </nav>

            <!-- æ¦‚è¦ -->
            <section class="section">
                <div class="section-header">
                    <span class="section-number">Section 5-1</span>
                    <h2 class="section-title">æ¦‚è¦</h2>
                </div>

                <div class="intro-text">
                    <p>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€<strong>ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å…¥åŠ›ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç™»éŒ²</strong>ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                    <p>Serviceã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã—ã€ç™»éŒ²å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚</p>
                </div>

                <h3>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å­¦ã¶ã“ã¨</h3>
                <div class="module-list">
                    <div class="module-item">
                        <div class="module-icon">âš™ï¸</div>
                        <div class="module-content">
                            <h4>Serviceã‚¯ãƒ©ã‚¹</h4>
                            <p>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ‹…å½“ã™ã‚‹ã‚¯ãƒ©ã‚¹ã®ä½œæˆ</p>
                        </div>
                    </div>
                    <div class="module-item">
                        <div class="module-icon">ğŸ’¾</div>
                        <div class="module-content">
                            <h4>ãƒ‡ãƒ¼ã‚¿ä¿å­˜</h4>
                            <p>Repositoryã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹æ–¹æ³•</p>
                        </div>
                    </div>
                    <div class="module-item">
                        <div class="module-icon">ğŸ”„</div>
                        <div class="module-content">
                            <h4>Formâ†’Entityå¤‰æ›</h4>
                            <p>ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å¤‰æ›ã—ã¦ä¿å­˜</p>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-box-header">
                        <span class="info-box-icon"><span class="material-icons">lightbulb</span></span>
                        <span class="info-box-title">ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã®ã‚´ãƒ¼ãƒ«</span>
                    </div>
                    <p>å…¥åŠ› â†’ ç¢ºèª â†’ ç™»éŒ² ã®æµã‚Œã§ã€ãƒ‡ãƒ¼ã‚¿ãŒH2ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã‚Œã°OKã§ã™ï¼<br>
                    H2ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
                </div>
            </section>

            <!-- ä»•æ§˜ -->
            <section class="section">
                <div class="section-header">
                    <span class="section-number">Section 5-2</span>
                    <h2 class="section-title">ä»•æ§˜</h2>
                </div>

                <h3>å‡¦ç†ã®æµã‚Œ</h3>
                <div class="screen-flow-diagram" style="display: flex; justify-content: center; margin: 2rem 0;">
                    <svg viewBox="0 0 600 180" width="600" height="180">
                        <rect width="600" height="180" fill="#f8fafc" rx="8" />

                        <rect x="20" y="30" width="100" height="50" rx="6" fill="#22c55e" />
                        <text x="70" y="60" text-anchor="middle" font-size="11" fill="white" font-weight="bold">å…¥åŠ›ç”»é¢</text>

                        <rect x="160" y="30" width="100" height="50" rx="6" fill="#f59e0b" />
                        <text x="210" y="60" text-anchor="middle" font-size="11" fill="white" font-weight="bold">ç¢ºèªç”»é¢</text>

                        <rect x="300" y="30" width="100" height="50" rx="6" fill="#8b5cf6" />
                        <text x="350" y="60" text-anchor="middle" font-size="11" fill="white" font-weight="bold">å®Œäº†ç”»é¢</text>

                        <rect x="300" y="110" width="100" height="50" rx="6" fill="#3b82f6" />
                        <text x="350" y="140" text-anchor="middle" font-size="11" fill="white" font-weight="bold">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</text>

                        <path d="M 120 55 L 155 55" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)" />
                        <path d="M 260 55 L 295 55" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)" />
                        <path d="M 350 80 L 350 105" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow-green)" />

                        <text x="350" y="95" text-anchor="middle" font-size="9" fill="#22c55e" font-weight="bold">ä¿å­˜</text>

                        <defs>
                            <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                                <polygon points="0 0, 8 3, 0 6" fill="#64748b" />
                            </marker>
                            <marker id="arrow-green" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                                <polygon points="0 0, 8 3, 0 6" fill="#22c55e" />
                            </marker>
                        </defs>
                    </svg>
                </div>
            </section>

            <!-- ã‚¢ãƒ—ãƒªä»•æ§˜ -->
            <section class="section">
                <div class="section-header">
                    <span class="section-number">Section 5-3</span>
                    <h2 class="section-title">ã‚¢ãƒ—ãƒªä»•æ§˜</h2>
                </div>

                <h3>ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ</h3>
                <div class="code-block">
                    <div class="code-header"><span class="code-title">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ</span></div>
                    <div class="code-content">
                        <pre>src/main/java/com/example/todo/
â”œâ”€â”€ TodoApplication.java
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ TodoController.java      â† å¤‰æ›´
â”œâ”€â”€ form/
â”‚   â””â”€â”€ TodoForm.java
â”œâ”€â”€ entity/
â”‚   â””â”€â”€ Todo.java
â”œâ”€â”€ repository/
â”‚   â””â”€â”€ TodoRepository.java
â””â”€â”€ service/
    â””â”€â”€ TodoService.java         â† æ–°è¦è¿½åŠ </pre>
                    </div>
                </div>
            </section>

            <!-- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ -->
            <section class="section">
                <div class="section-header">
                    <span class="section-number">Section 5-4</span>
                    <h2 class="section-title">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ç”Ÿæˆ</h2>
                </div>

                <div class="code-block" id="prompt-1">
                    <div class="code-header">
                        <span class="code-title">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹</span>
                        <button class="download-btn" onclick="downloadPrompt('prompt-1', 'step5_save.txt')">ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                    </div>
                    <div class="code-content">
                        <pre>ã‚ãªãŸã¯Javaãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã§ã™ã€‚

Step 4ã§ä½œæˆã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã€ãƒ‡ãƒ¼ã‚¿ç™»éŒ²æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

ã€è¦ä»¶ã€‘
1. ç¢ºèªç”»é¢ã§ã€Œç™»éŒ²ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã™ã‚‹
2. Serviceã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¦ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢ã™ã‚‹
3. ä¿å­˜æ™‚ã«ä½œæˆæ—¥æ™‚ã‚’è‡ªå‹•è¨­å®šã™ã‚‹

ã€Serviceã‚¯ãƒ©ã‚¹ï¼ˆTodoService.javaï¼‰ã€‘
ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸: com.example.todo.service
ãƒ¡ã‚½ãƒƒãƒ‰:
- save(TodoForm form): Formã‚’Entityã«å¤‰æ›ã—ã¦ä¿å­˜

ã€Controllerã®å¤‰æ›´ã€‘
- å®Œäº†ç”»é¢(complete)ã§TodoServiceã‚’å‘¼ã³å‡ºã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
- PRGãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã¦äºŒé‡ç™»éŒ²ã‚’é˜²æ­¢

ã€å‡¦ç†ã®æµã‚Œã€‘
1. ç¢ºèªç”»é¢ã§ã€Œç™»éŒ²ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ControllerãŒTodoServiceã®saveãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™
3. TodoServiceãŒTodoFormã‚’Todoã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å¤‰æ›
4. TodoRepositoryã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
5. å®Œäº†ç”»é¢ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

å„ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚</pre>
                    </div>
                </div>
            </section>

            <!-- è§£èª¬ -->
            <section class="section">
                <div class="section-header">
                    <span class="section-number">Section 5-5</span>
                    <h2 class="section-title">è¿½åŠ ãƒ»å¤‰æ›´ç®‡æ‰€ã®è§£èª¬</h2>
                </div>

                <h3>ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ä¸€è¦§</h3>
                <table class="data-table">
                    <thead><tr><th>ãƒ•ã‚¡ã‚¤ãƒ«</th><th>çŠ¶æ…‹</th><th>å¤‰æ›´å†…å®¹</th></tr></thead>
                    <tbody>
                        <tr><td><code>TodoService.java</code></td><td><span class="file-badge new">æ–°è¦</span></td><td>ç™»éŒ²å‡¦ç†ã‚’å®Ÿè£…</td></tr>
                        <tr><td><code>TodoController.java</code></td><td><span class="file-badge modified">å¤‰æ›´</span></td><td>Serviceå‘¼ã³å‡ºã—è¿½åŠ </td></tr>
                    </tbody>
                </table>

                <h3>Serviceã‚¯ãƒ©ã‚¹ã®ä¾‹</h3>
                <div class="code-block">
                    <div class="code-header"><span class="code-title">TodoService.java</span></div>
                    <div class="code-content">
                        <pre>@Service
public class TodoService {

    @Autowired
    private TodoRepository todoRepository;

    public void save(TodoForm form) {
        Todo todo = new Todo();
        todo.setAuthor(form.getAuthor());
        todo.setTitle(form.getTitle());
        todo.setDetail(form.getDetail());
        todo.setCreatedAt(LocalDateTime.now());
        todoRepository.save(todo);
    }
}</pre>
                    </div>
                </div>

                <div class="column">
                    <div class="column-header">
                        <span class="column-badge">Column</span>
                        <span class="column-title">PRGãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯</span>
                    </div>
                    <p><strong>PRGï¼ˆPost-Redirect-Getï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³</strong>ã¯ã€ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å¾Œã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã“ã¨ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®æ›´æ–°ãƒœã‚¿ãƒ³ã«ã‚ˆã‚‹äºŒé‡é€ä¿¡ã‚’é˜²ãè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚</p>
                    <ol class="step-list">
                        <li>POST: ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡</li>
                        <li>Redirect: å‡¦ç†å¾Œã«åˆ¥ã®URLã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ</li>
                        <li>GET: ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã®ç”»é¢ã‚’è¡¨ç¤º</li>
                    </ol>
                </div>

                <div class="info-box" style="background: #f0fdf4; border-color: #22c55e;">
                    <div class="info-box-header">
                        <span class="info-box-icon">âœ…</span>
                        <span class="info-box-title">å®Œäº†ãƒã‚§ãƒƒã‚¯</span>
                    </div>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
                        <li>å…¥åŠ› â†’ ç¢ºèª â†’ ç™»éŒ² ã®æµã‚Œã§æ“ä½œã§ãã‚‹</li>
                        <li>H2ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ‡ãƒ¼ã‚¿ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹</li>
                        <li>ãƒ–ãƒ©ã‚¦ã‚¶æ›´æ–°ã§äºŒé‡ç™»éŒ²ã•ã‚Œãªã„</li>
                    </ul>
                </div>
            </section>
        </div>

        <footer class="footer"><p>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</p></footer>

        <div class="page-nav">
            <a href="promptpg-4.html" class="page-nav-btn prev">
                <span>â†</span>
                <div><div class="page-nav-label">å‰ã®ã‚¹ãƒ†ãƒƒãƒ—</div><div class="page-nav-title">Step 4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š</div></div>
            </a>
            <a href="promptpg-6.html" class="page-nav-btn next">
                <div><div class="page-nav-label">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</div><div class="page-nav-title">Step 6: ä¸€è¦§è¡¨ç¤º</div></div>
                <span>â†’</span>
            </a>
        </div>

        <script>
            function toggleMenu() { document.querySelector(".nav-toggle").classList.toggle("active"); document.querySelector(".nav-menu").classList.toggle("active"); }
            function downloadPrompt(elementId, filename) {
                const element = document.getElementById(elementId);
                const text = element.querySelector('pre').textContent;
                const blob = new Blob([text], { type: 'text/plain; charset=utf-8' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = filename;
                a.click();
            }
        </script>
    </body>
</html>
