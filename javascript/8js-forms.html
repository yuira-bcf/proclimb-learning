<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chapter 8: フォーム処理とバリデーション - JavaScript入門</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../shared/common.css">
  <style>
    :root {
      --primary: #007AFF;
      --primary-dark: #0062CC;
      --primary-light: #EFF6FF;
      --primary-lighter: #BFDBFE;
    }
    .nav-category-links { display: none; }
  </style>
</head>
<body>
  <nav class="global-nav"></nav>
  <script src="../shared/js/nav-javascript.js"></script>

  <div class="container">
    <!-- チャプターヘッダー -->
    <header class="chapter-header">
      <div class="chapter-badge">Chapter</div>
      <div class="chapter-number">8</div>
      <h1 class="chapter-title">フォーム処理とバリデーション</h1>
      <p class="chapter-subtitle">ユーザー入力を安全に処理する</p>
    </header>

    <!-- 目次 -->
    <nav class="toc">
      <h2 class="toc-title">この章の内容</h2>
      <ul class="toc-list">
        <li class="toc-item"><span class="toc-number">8-1</span>フォーム要素と値の取得</li>
        <li class="toc-item"><span class="toc-number">8-2</span>フォームイベント</li>
        <li class="toc-item"><span class="toc-number">8-3</span>バリデーション基礎</li>
        <li class="toc-item"><span class="toc-number">8-4</span>正規表現</li>
        <li class="toc-item"><span class="toc-number">8-5</span>実習：会員登録フォーム</li>
        <li class="toc-item"><span class="toc-number">練習</span>練習問題</li>
      </ul>
    </nav>

    <!-- 構文説明ボックス -->
    <div class="syntax-box">
      <div class="syntax-box-header">
        <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
        <span class="syntax-box-title">構文説明</span>
      </div>
      <div class="syntax-box-content">
        <div class="syntax-item">
          <h4>form要素とsubmitイベント</h4>
          <div class="syntax-pattern"><span class="keyword">const</span> <span class="variable">form</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">'form'</span>);

<span class="variable">form</span>.<span class="method">addEventListener</span>(<span class="string">'submit'</span>, (<span class="variable">e</span>) => {
  <span class="variable">e</span>.<span class="method">preventDefault</span>();  <span class="comment">// ページ遷移を防止</span>

  <span class="comment">// FormDataでフォームの全データを取得</span>
  <span class="keyword">const</span> <span class="variable">formData</span> = <span class="keyword">new</span> <span class="method">FormData</span>(<span class="variable">form</span>);
  <span class="keyword">const</span> <span class="variable">data</span> = <span class="variable">Object</span>.<span class="method">fromEntries</span>(<span class="variable">formData</span>);

  <span class="comment">// フォームをリセット</span>
  <span class="variable">form</span>.<span class="method">reset</span>();
});</div>
          <p>フォーム送信時に<code>submit</code>イベントが発火します。<code>preventDefault()</code>でデフォルトのページ遷移を防ぎ、JavaScriptで処理します。<code>FormData</code>でフォームの全入力値を一括取得できます。</p>
        </div>
        <div class="syntax-item">
          <h4>input.value</h4>
          <div class="syntax-pattern"><span class="keyword">const</span> <span class="variable">input</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">'#username'</span>);

<span class="comment">// 値の取得</span>
<span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">input</span>.<span class="variable">value</span>;

<span class="comment">// 値の設定</span>
<span class="variable">input</span>.<span class="variable">value</span> = <span class="string">'新しい値'</span>;

<span class="comment">// 入力をクリア</span>
<span class="variable">input</span>.<span class="variable">value</span> = <span class="string">''</span>;

<span class="comment">// チェックボックス・ラジオボタンの場合</span>
<span class="keyword">const</span> <span class="variable">isChecked</span> = <span class="variable">checkbox</span>.<span class="variable">checked</span>;  <span class="comment">// true/false</span></div>
          <p><code>value</code>プロパティでテキスト入力の値を取得・設定します。チェックボックスやラジオボタンは<code>checked</code>プロパティ（boolean）を使用します。</p>
        </div>
        <div class="syntax-item">
          <h4>バリデーション（required, pattern）</h4>
          <div class="syntax-pattern"><span class="comment">// HTML属性でのバリデーション</span>
<span class="comment">// &lt;input type="email" required pattern="[a-z]+@[a-z]+\.[a-z]+"&gt;</span>

<span class="comment">// JavaScriptでの検証</span>
<span class="keyword">const</span> <span class="variable">input</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">'#email'</span>);

<span class="comment">// 個別の検証状態を確認</span>
<span class="variable">input</span>.<span class="variable">validity</span>.<span class="variable">valueMissing</span>;   <span class="comment">// required違反</span>
<span class="variable">input</span>.<span class="variable">validity</span>.<span class="variable">patternMismatch</span>; <span class="comment">// pattern不一致</span>
<span class="variable">input</span>.<span class="variable">validity</span>.<span class="variable">typeMismatch</span>;    <span class="comment">// type不一致（email形式など）</span>

<span class="comment">// 全体の検証結果</span>
<span class="keyword">if</span> (<span class="variable">input</span>.<span class="method">checkValidity</span>()) {
  <span class="comment">// 有効</span>
}

<span class="comment">// カスタムエラーメッセージを設定</span>
<span class="variable">input</span>.<span class="method">setCustomValidity</span>(<span class="string">'独自のエラーメッセージ'</span>);</div>
          <p>HTML5のフォームバリデーション属性（<code>required</code>, <code>pattern</code>, <code>min</code>, <code>max</code>など）と、JavaScriptの<code>validity</code>オブジェクトで入力を検証できます。</p>
        </div>
        <div class="syntax-item">
          <h4>正規表現（/pattern/）</h4>
          <div class="syntax-pattern"><span class="comment">// 正規表現リテラル</span>
<span class="keyword">const</span> <span class="variable">emailPattern</span> = /^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}$/;
<span class="keyword">const</span> <span class="variable">phonePattern</span> = /^\d{2,4}-\d{2,4}-\d{4}$/;

<span class="comment">// test(): マッチするか確認（true/false）</span>
<span class="variable">emailPattern</span>.<span class="method">test</span>(<span class="string">'user@example.com'</span>);  <span class="comment">// true</span>
<span class="variable">phonePattern</span>.<span class="method">test</span>(<span class="string">'090-1234-5678'</span>);    <span class="comment">// true</span>

<span class="comment">// match(): マッチした部分を取得</span>
<span class="keyword">const</span> <span class="variable">result</span> = <span class="string">'hello world'</span>.<span class="method">match</span>(/\w+/g);  <span class="comment">// ['hello', 'world']</span>

<span class="comment">// replace(): 置換</span>
<span class="string">'hello'</span>.<span class="method">replace</span>(/l/g, <span class="string">'L'</span>);  <span class="comment">// 'heLLo'</span>

<span class="comment">// よく使うパターン</span>
/^\d+$/           <span class="comment">// 数字のみ</span>
/^[a-zA-Z]+$/     <span class="comment">// アルファベットのみ</span>
/^.{8,}$/         <span class="comment">// 8文字以上</span></div>
          <p>正規表現はパターンマッチングのための記法です。<code>test()</code>でパターンに一致するか確認、<code>match()</code>で一致部分を抽出、<code>replace()</code>で置換できます。</p>
        </div>
      </div>
    </div>

    <!-- Section 8-1 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 8-1</span>
        <h2 class="section-title">フォーム要素と値の取得</h2>
      </div>

      <div class="intro-text">
        <p>Webアプリケーションでは、ユーザーからの入力を受け取るためにフォームを使用します。JavaScriptでフォーム要素の値を取得・設定する方法を学びましょう。</p>
      </div>

      <div class="subsection">
        <h3>テキスト入力（input type="text"）</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
テキスト入力欄の値と状態を操作

## 実装要件
- `value` プロパティで値を取得・設定
- 入力欄をクリア
- プレースホルダーを変更
- 読み取り専用（`readonly`）を設定
- 無効化（`disabled`）を設定

## 使用するAPI
- `HTMLInputElement.value`
- `HTMLInputElement.placeholder`
- `HTMLInputElement.readOnly`
- `HTMLInputElement.disabled`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">テキスト入力の操作</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// HTML: &lt;input type="text" id="username"&gt;</span>
<span class="keyword">const</span> <span class="variable">input</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'username'</span>);

<span class="comment">// 値の取得</span>
<span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">input</span>.<span class="variable">value</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">value</span>);

<span class="comment">// 値の設定</span>
<span class="variable">input</span>.<span class="variable">value</span> = <span class="string">"新しい値"</span>;

<span class="comment">// 入力をクリア</span>
<span class="variable">input</span>.<span class="variable">value</span> = <span class="string">""</span>;

<span class="comment">// プレースホルダーの変更</span>
<span class="variable">input</span>.<span class="variable">placeholder</span> = <span class="string">"ここに入力..."</span>;

<span class="comment">// 読み取り専用にする</span>
<span class="variable">input</span>.<span class="variable">readOnly</span> = <span class="keyword">true</span>;

<span class="comment">// 無効化する</span>
<span class="variable">input</span>.<span class="variable">disabled</span> = <span class="keyword">true</span>;</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>様々なinputタイプ</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
様々なinputタイプから値を取得

## 実装要件
- `type="number"` から数値を取得
- `type="email"` からメールアドレスを取得
- `type="password"` からパスワードを取得
- `type="date"` から日付を取得
- `type="range"` からスライダー値を取得
- `type="color"` から色を取得
- `parseInt()` で文字列を数値に変換

## 使用するAPI
- `HTMLInputElement.value`
- `parseInt()` / `parseFloat()`
- `HTMLInputElement.valueAsNumber`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">様々なinputの値取得</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 数値入力</span>
<span class="comment">// &lt;input type="number" id="age" min="0" max="120"&gt;</span>
<span class="keyword">const</span> <span class="variable">age</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'age'</span>).<span class="variable">value</span>;
<span class="keyword">const</span> <span class="variable">ageNum</span> = <span class="method">parseInt</span>(<span class="variable">age</span>, <span class="number">10</span>);  <span class="comment">// 数値に変換</span>

<span class="comment">// メールアドレス</span>
<span class="comment">// &lt;input type="email" id="email"&gt;</span>
<span class="keyword">const</span> <span class="variable">email</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'email'</span>).<span class="variable">value</span>;

<span class="comment">// パスワード</span>
<span class="comment">// &lt;input type="password" id="password"&gt;</span>
<span class="keyword">const</span> <span class="variable">password</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'password'</span>).<span class="variable">value</span>;

<span class="comment">// 日付</span>
<span class="comment">// &lt;input type="date" id="birthday"&gt;</span>
<span class="keyword">const</span> <span class="variable">date</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'birthday'</span>).<span class="variable">value</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">date</span>);  <span class="comment">// "2024-01-15" (YYYY-MM-DD形式)</span>

<span class="comment">// 範囲（スライダー）</span>
<span class="comment">// &lt;input type="range" id="volume" min="0" max="100"&gt;</span>
<span class="keyword">const</span> <span class="variable">volume</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'volume'</span>).<span class="variable">value</span>;

<span class="comment">// 色選択</span>
<span class="comment">// &lt;input type="color" id="color"&gt;</span>
<span class="keyword">const</span> <span class="variable">color</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'color'</span>).<span class="variable">value</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">color</span>);  <span class="comment">// "#ff0000"</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>チェックボックスとラジオボタン</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
チェックボックスとラジオボタンの操作

## 実装要件
- `checked` プロパティでチェック状態を取得・設定
- `querySelectorAll()` で複数チェックボックスを取得
- 選択された値を配列で取得
- ラジオボタンの選択値を取得

## 使用するAPI
- `HTMLInputElement.checked`
- `document.querySelectorAll()`
- `Array.from()` / `filter()` / `map()`
- `document.querySelector('input[name="xxx"]:checked')`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">チェックボックスとラジオボタン</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// チェックボックス</span>
<span class="comment">// &lt;input type="checkbox" id="agree"&gt; 同意する</span>
<span class="keyword">const</span> <span class="variable">checkbox</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'agree'</span>);
<span class="keyword">const</span> <span class="variable">isChecked</span> = <span class="variable">checkbox</span>.<span class="variable">checked</span>;  <span class="comment">// true または false</span>

<span class="comment">// チェック状態を変更</span>
<span class="variable">checkbox</span>.<span class="variable">checked</span> = <span class="keyword">true</span>;

<span class="comment">// 複数のチェックボックス</span>
<span class="comment">// &lt;input type="checkbox" name="hobby" value="読書"&gt;</span>
<span class="comment">// &lt;input type="checkbox" name="hobby" value="映画"&gt;</span>
<span class="keyword">const</span> <span class="variable">hobbies</span> = <span class="variable">document</span>.<span class="method">querySelectorAll</span>(<span class="string">'input[name="hobby"]:checked'</span>);
<span class="keyword">const</span> <span class="variable">selectedHobbies</span> = <span class="variable">Array</span>.<span class="method">from</span>(<span class="variable">hobbies</span>).<span class="method">map</span>(<span class="variable">h</span> => <span class="variable">h</span>.<span class="variable">value</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">selectedHobbies</span>);  <span class="comment">// ["読書", "映画"]</span>

<span class="comment">// ラジオボタン</span>
<span class="comment">// &lt;input type="radio" name="gender" value="male"&gt; 男性</span>
<span class="comment">// &lt;input type="radio" name="gender" value="female"&gt; 女性</span>
<span class="keyword">const</span> <span class="variable">selectedGender</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">'input[name="gender"]:checked'</span>);
<span class="keyword">if</span> (<span class="variable">selectedGender</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">selectedGender</span>.<span class="variable">value</span>);  <span class="comment">// "male" または "female"</span>
}</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>セレクトボックスとテキストエリア</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
セレクトボックスとテキストエリアの操作

## 実装要件
- セレクトボックスの選択値を取得
- 選択されたオプションの表示テキストを取得
- プログラムで選択を変更
- 複数選択（`multiple`）の値を取得
- テキストエリアの値を取得
- 文字数をカウント

## 使用するAPI
- `HTMLSelectElement.value`
- `HTMLSelectElement.selectedOptions`
- `HTMLSelectElement.selectedIndex`
- `HTMLTextAreaElement.value`
- `String.prototype.length`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">selectとtextarea</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// セレクトボックス</span>
<span class="comment">// &lt;select id="prefecture"&gt;</span>
<span class="comment">//   &lt;option value=""&gt;選択してください&lt;/option&gt;</span>
<span class="comment">//   &lt;option value="tokyo"&gt;東京&lt;/option&gt;</span>
<span class="comment">//   &lt;option value="osaka"&gt;大阪&lt;/option&gt;</span>
<span class="comment">// &lt;/select&gt;</span>
<span class="keyword">const</span> <span class="variable">select</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'prefecture'</span>);
<span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">select</span>.<span class="variable">value</span>;                  <span class="comment">// "tokyo"</span>
<span class="keyword">const</span> <span class="variable">text</span> = <span class="variable">select</span>.<span class="variable">options</span>[<span class="variable">select</span>.<span class="variable">selectedIndex</span>].<span class="variable">text</span>;  <span class="comment">// "東京"</span>

<span class="comment">// 選択肢を変更</span>
<span class="variable">select</span>.<span class="variable">value</span> = <span class="string">"osaka"</span>;

<span class="comment">// 複数選択</span>
<span class="comment">// &lt;select id="colors" multiple&gt;</span>
<span class="keyword">const</span> <span class="variable">multiSelect</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'colors'</span>);
<span class="keyword">const</span> <span class="variable">selectedOptions</span> = <span class="variable">Array</span>.<span class="method">from</span>(<span class="variable">multiSelect</span>.<span class="variable">selectedOptions</span>)
  .<span class="method">map</span>(<span class="variable">opt</span> => <span class="variable">opt</span>.<span class="variable">value</span>);

<span class="comment">// テキストエリア</span>
<span class="comment">// &lt;textarea id="message" rows="4"&gt;&lt;/textarea&gt;</span>
<span class="keyword">const</span> <span class="variable">textarea</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'message'</span>);
<span class="keyword">const</span> <span class="variable">message</span> = <span class="variable">textarea</span>.<span class="variable">value</span>;

<span class="comment">// 文字数を取得</span>
<span class="keyword">const</span> <span class="variable">charCount</span> = <span class="variable">textarea</span>.<span class="variable">value</span>.<span class="variable">length</span>;</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 8-2 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 8-2</span>
        <h2 class="section-title">フォームイベント</h2>
      </div>

      <div class="intro-text">
        <p>フォームには様々なイベントがあり、ユーザーの操作に応じてリアルタイムで処理を行うことができます。</p>
      </div>

      <div class="subsection">
        <h3>主要なフォームイベント</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>イベント</th>
                <th>発火タイミング</th>
                <th>用途</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>submit</code></td>
                <td>フォーム送信時</td>
                <td>送信前の検証、非同期送信</td>
              </tr>
              <tr>
                <td><code>input</code></td>
                <td>値が変更されるたび</td>
                <td>リアルタイム検証、文字数カウント</td>
              </tr>
              <tr>
                <td><code>change</code></td>
                <td>値が確定した時</td>
                <td>select、checkbox、radioの変更検知</td>
              </tr>
              <tr>
                <td><code>focus</code></td>
                <td>フォーカスを得た時</td>
                <td>入力ヒントの表示</td>
              </tr>
              <tr>
                <td><code>blur</code></td>
                <td>フォーカスを失った時</td>
                <td>入力完了時の検証</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
フォームイベントの処理

## 実装要件
- `submit` イベントで送信を防いで値を取得
- `FormData` でフォーム全体の値を取得
- `input` イベントでリアルタイム入力を検知
- `change` イベントでセレクトボックスの変更を検知
- `focus` / `blur` イベントでフォーカス状態を検知

## 使用するAPI
- `Event.preventDefault()`
- `new FormData(form)`
- `addEventListener('input', handler)`
- `addEventListener('change', handler)`
- `addEventListener('focus', handler)` / `blur`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">フォームイベントの実装</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// フォーム送信イベント</span>
<span class="keyword">const</span> <span class="variable">form</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'myForm'</span>);
<span class="variable">form</span>.<span class="method">addEventListener</span>(<span class="string">'submit'</span>, (<span class="variable">e</span>) => {
  <span class="variable">e</span>.<span class="method">preventDefault</span>();  <span class="comment">// デフォルトの送信を阻止</span>

  <span class="comment">// フォームデータを取得</span>
  <span class="keyword">const</span> <span class="variable">formData</span> = <span class="keyword">new</span> <span class="method">FormData</span>(<span class="variable">form</span>);
  <span class="keyword">const</span> <span class="variable">data</span> = <span class="variable">Object</span>.<span class="method">fromEntries</span>(<span class="variable">formData</span>);
  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">data</span>);

  <span class="comment">// 検証やAPI送信の処理...</span>
});

<span class="comment">// リアルタイム入力イベント</span>
<span class="keyword">const</span> <span class="variable">input</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'username'</span>);
<span class="variable">input</span>.<span class="method">addEventListener</span>(<span class="string">'input'</span>, (<span class="variable">e</span>) => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'入力中:'</span>, <span class="variable">e</span>.<span class="variable">target</span>.<span class="variable">value</span>);
  <span class="comment">// 文字数表示の更新など</span>
});

<span class="comment">// 変更確定イベント</span>
<span class="keyword">const</span> <span class="variable">select</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'category'</span>);
<span class="variable">select</span>.<span class="method">addEventListener</span>(<span class="string">'change'</span>, (<span class="variable">e</span>) => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'選択されました:'</span>, <span class="variable">e</span>.<span class="variable">target</span>.<span class="variable">value</span>);
});

<span class="comment">// フォーカスイベント</span>
<span class="variable">input</span>.<span class="method">addEventListener</span>(<span class="string">'focus'</span>, () => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'入力欄にフォーカス'</span>);
});

<span class="variable">input</span>.<span class="method">addEventListener</span>(<span class="string">'blur'</span>, () => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'入力欄からフォーカスが外れた'</span>);
  <span class="comment">// 入力完了時の検証</span>
});</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>inputとchangeの違い</h3>
        <p><code>input</code>はキー入力ごとに発火し、<code>change</code>は入力が確定（フォーカスが外れる）した時に発火します。</p>

        <div class="demo-area" style="padding: 20px;">
          <div style="max-width: 400px; margin: 0 auto;">
            <div style="margin-bottom: 16px;">
              <label style="display: block; margin-bottom: 8px; font-weight: 600;">inputイベント:</label>
              <input type="text" id="demo-input-event" style="width: 100%; padding: 8px; border: 2px solid #e2e8f0; border-radius: 6px;" placeholder="入力してください">
              <div id="demo-input-log" style="margin-top: 8px; padding: 8px; background: #f8fafc; border-radius: 4px; font-size: 14px;">入力中の値がここに表示されます</div>
            </div>
            <div>
              <label style="display: block; margin-bottom: 8px; font-weight: 600;">changeイベント:</label>
              <input type="text" id="demo-change-event" style="width: 100%; padding: 8px; border: 2px solid #e2e8f0; border-radius: 6px;" placeholder="入力してフォーカスを外してください">
              <div id="demo-change-log" style="margin-top: 8px; padding: 8px; background: #f8fafc; border-radius: 4px; font-size: 14px;">確定した値がここに表示されます</div>
            </div>
          </div>
        </div>

        <script>
          document.getElementById('demo-input-event').addEventListener('input', (e) => {
            document.getElementById('demo-input-log').textContent = 'input: ' + e.target.value;
          });
          document.getElementById('demo-change-event').addEventListener('change', (e) => {
            document.getElementById('demo-change-log').textContent = 'change: ' + e.target.value;
          });
        </script>
      </div>
    </section>

    <!-- Section 8-3 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 8-3</span>
        <h2 class="section-title">バリデーション基礎</h2>
      </div>

      <div class="intro-text">
        <p>バリデーション（入力検証）は、ユーザーが入力したデータが正しい形式かどうかをチェックする重要な処理です。HTML5のバリデーション属性とJavaScriptを組み合わせて使いましょう。</p>
      </div>

      <div class="subsection">
        <h3>HTML5のバリデーション属性</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>属性</th>
                <th>説明</th>
                <th>例</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>required</code></td>
                <td>必須入力</td>
                <td><code>&lt;input required&gt;</code></td>
              </tr>
              <tr>
                <td><code>minlength / maxlength</code></td>
                <td>文字数制限</td>
                <td><code>&lt;input minlength="3" maxlength="20"&gt;</code></td>
              </tr>
              <tr>
                <td><code>min / max</code></td>
                <td>数値の範囲</td>
                <td><code>&lt;input type="number" min="0" max="100"&gt;</code></td>
              </tr>
              <tr>
                <td><code>pattern</code></td>
                <td>正規表現パターン</td>
                <td><code>&lt;input pattern="[0-9]{3}-[0-9]{4}"&gt;</code></td>
              </tr>
              <tr>
                <td><code>type="email"</code></td>
                <td>メール形式チェック</td>
                <td><code>&lt;input type="email"&gt;</code></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
HTML5バリデーション属性を使ったフォーム

## 実装要件
- ユーザー名: 必須、3-20文字
- メールアドレス: 必須、`type="email"`
- パスワード: 必須、8文字以上
- 電話番号: パターン指定（正規表現）

## 使用するAPI
- `required` 属性
- `minlength` / `maxlength` 属性
- `pattern` 属性
- `type="email"` / `type="tel"`
- `:valid` / `:invalid` 疑似クラス</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">HTML5バリデーション</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">HTML</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="tag">&lt;form</span> <span class="attr">id</span>=<span class="value">"signup"</span><span class="tag">&gt;</span>
  <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"text"</span> <span class="attr">name</span>=<span class="value">"username"</span>
         <span class="attr">required</span>
         <span class="attr">minlength</span>=<span class="value">"3"</span>
         <span class="attr">maxlength</span>=<span class="value">"20"</span>
         <span class="attr">placeholder</span>=<span class="value">"ユーザー名"</span><span class="tag">&gt;</span>

  <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"email"</span> <span class="attr">name</span>=<span class="value">"email"</span>
         <span class="attr">required</span>
         <span class="attr">placeholder</span>=<span class="value">"メールアドレス"</span><span class="tag">&gt;</span>

  <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"password"</span> <span class="attr">name</span>=<span class="value">"password"</span>
         <span class="attr">required</span>
         <span class="attr">minlength</span>=<span class="value">"8"</span>
         <span class="attr">placeholder</span>=<span class="value">"パスワード（8文字以上）"</span><span class="tag">&gt;</span>

  <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"tel"</span> <span class="attr">name</span>=<span class="value">"phone"</span>
         <span class="attr">pattern</span>=<span class="value">"[0-9]{3}-[0-9]{4}-[0-9]{4}"</span>
         <span class="attr">placeholder</span>=<span class="value">"電話番号 (090-1234-5678)"</span><span class="tag">&gt;</span>

  <span class="tag">&lt;button</span> <span class="attr">type</span>=<span class="value">"submit"</span><span class="tag">&gt;</span>登録<span class="tag">&lt;/button&gt;</span>
<span class="tag">&lt;/form&gt;</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>JavaScriptでのバリデーション</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
カスタムバリデーション関数の実装

## 実装要件
- ユーザー名: 必須、3-20文字の検証
- メールアドレス: 正規表現でフォーマットチェック
- パスワード: 8文字以上の検証
- 年齢: 0-120の数値範囲チェック
- エラーメッセージをオブジェクトで返す

## 使用するAPI
- `String.prototype.length`
- `RegExp.prototype.test()`
- 正規表現リテラル `/pattern/`
- オブジェクトリテラル `{}`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">カスタムバリデーション</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// バリデーション関数</span>
<span class="keyword">function</span> <span class="method">validateForm</span>(<span class="variable">formData</span>) {
  <span class="keyword">const</span> <span class="variable">errors</span> = {};

  <span class="comment">// ユーザー名: 必須、3-20文字</span>
  <span class="keyword">if</span> (!<span class="variable">formData</span>.<span class="variable">username</span>) {
    <span class="variable">errors</span>.<span class="variable">username</span> = <span class="string">"ユーザー名を入力してください"</span>;
  } <span class="keyword">else if</span> (<span class="variable">formData</span>.<span class="variable">username</span>.<span class="variable">length</span> < <span class="number">3</span>) {
    <span class="variable">errors</span>.<span class="variable">username</span> = <span class="string">"ユーザー名は3文字以上で入力してください"</span>;
  } <span class="keyword">else if</span> (<span class="variable">formData</span>.<span class="variable">username</span>.<span class="variable">length</span> > <span class="number">20</span>) {
    <span class="variable">errors</span>.<span class="variable">username</span> = <span class="string">"ユーザー名は20文字以内で入力してください"</span>;
  }

  <span class="comment">// メール: 必須、形式チェック</span>
  <span class="keyword">const</span> <span class="variable">emailRegex</span> = <span class="string">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;
  <span class="keyword">if</span> (!<span class="variable">formData</span>.<span class="variable">email</span>) {
    <span class="variable">errors</span>.<span class="variable">email</span> = <span class="string">"メールアドレスを入力してください"</span>;
  } <span class="keyword">else if</span> (!<span class="variable">emailRegex</span>.<span class="method">test</span>(<span class="variable">formData</span>.<span class="variable">email</span>)) {
    <span class="variable">errors</span>.<span class="variable">email</span> = <span class="string">"有効なメールアドレスを入力してください"</span>;
  }

  <span class="comment">// パスワード: 必須、8文字以上、英数字含む</span>
  <span class="keyword">if</span> (!<span class="variable">formData</span>.<span class="variable">password</span>) {
    <span class="variable">errors</span>.<span class="variable">password</span> = <span class="string">"パスワードを入力してください"</span>;
  } <span class="keyword">else if</span> (<span class="variable">formData</span>.<span class="variable">password</span>.<span class="variable">length</span> < <span class="number">8</span>) {
    <span class="variable">errors</span>.<span class="variable">password</span> = <span class="string">"パスワードは8文字以上で入力してください"</span>;
  }

  <span class="comment">// 年齢: 数値、0-120</span>
  <span class="keyword">if</span> (<span class="variable">formData</span>.<span class="variable">age</span> !== <span class="string">''</span>) {
    <span class="keyword">const</span> <span class="variable">age</span> = <span class="method">parseInt</span>(<span class="variable">formData</span>.<span class="variable">age</span>, <span class="number">10</span>);
    <span class="keyword">if</span> (<span class="method">isNaN</span>(<span class="variable">age</span>) || <span class="variable">age</span> < <span class="number">0</span> || <span class="variable">age</span> > <span class="number">120</span>) {
      <span class="variable">errors</span>.<span class="variable">age</span> = <span class="string">"有効な年齢を入力してください"</span>;
    }
  }

  <span class="keyword">return</span> <span class="variable">errors</span>;
}

<span class="comment">// フォーム送信時の処理</span>
<span class="variable">form</span>.<span class="method">addEventListener</span>(<span class="string">'submit'</span>, (<span class="variable">e</span>) => {
  <span class="variable">e</span>.<span class="method">preventDefault</span>();

  <span class="keyword">const</span> <span class="variable">formData</span> = <span class="variable">Object</span>.<span class="method">fromEntries</span>(<span class="keyword">new</span> <span class="method">FormData</span>(<span class="variable">form</span>));
  <span class="keyword">const</span> <span class="variable">errors</span> = <span class="method">validateForm</span>(<span class="variable">formData</span>);

  <span class="keyword">if</span> (<span class="variable">Object</span>.<span class="method">keys</span>(<span class="variable">errors</span>).<span class="variable">length</span> > <span class="number">0</span>) {
    <span class="method">displayErrors</span>(<span class="variable">errors</span>);
    <span class="keyword">return</span>;
  }

  <span class="comment">// バリデーション成功、送信処理...</span>
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'送信データ:'</span>, <span class="variable">formData</span>);
});</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>エラー表示</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
バリデーションエラーの画面表示

## 実装要件
- 既存のエラー表示をクリア
- エラーがある入力欄にエラークラスを追加
- 対応するエラーメッセージ要素にテキストを表示
- `blur` イベントでリアルタイムにバリデーション実行

## 使用するAPI
- `Element.classList.add()` / `remove()`
- `Element.textContent`
- `addEventListener('blur', handler)`
- `document.getElementById()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">エラーメッセージの表示</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// エラーメッセージを表示</span>
<span class="keyword">function</span> <span class="method">displayErrors</span>(<span class="variable">errors</span>) {
  <span class="comment">// 既存のエラーをクリア</span>
  <span class="variable">document</span>.<span class="method">querySelectorAll</span>(<span class="string">'.error-message'</span>).<span class="method">forEach</span>(<span class="variable">el</span> => {
    <span class="variable">el</span>.<span class="variable">textContent</span> = <span class="string">''</span>;
  });
  <span class="variable">document</span>.<span class="method">querySelectorAll</span>(<span class="string">'.input-error'</span>).<span class="method">forEach</span>(<span class="variable">el</span> => {
    <span class="variable">el</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'input-error'</span>);
  });

  <span class="comment">// エラーを表示</span>
  <span class="variable">Object</span>.<span class="method">entries</span>(<span class="variable">errors</span>).<span class="method">forEach</span>(([<span class="variable">field</span>, <span class="variable">message</span>]) => {
    <span class="keyword">const</span> <span class="variable">input</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">`[name="${<span class="variable">field</span>}"]`</span>);
    <span class="keyword">const</span> <span class="variable">errorEl</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">`${<span class="variable">field</span>}-error`</span>);

    <span class="keyword">if</span> (<span class="variable">input</span>) {
      <span class="variable">input</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'input-error'</span>);
    }
    <span class="keyword">if</span> (<span class="variable">errorEl</span>) {
      <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="variable">message</span>;
    }
  });
}

<span class="comment">// リアルタイムバリデーション</span>
<span class="keyword">function</span> <span class="method">validateField</span>(<span class="variable">input</span>) {
  <span class="keyword">const</span> <span class="variable">field</span> = <span class="variable">input</span>.<span class="variable">name</span>;
  <span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">input</span>.<span class="variable">value</span>;
  <span class="keyword">const</span> <span class="variable">errorEl</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">`${<span class="variable">field</span>}-error`</span>);

  <span class="keyword">let</span> <span class="variable">error</span> = <span class="string">''</span>;

  <span class="keyword">switch</span> (<span class="variable">field</span>) {
    <span class="keyword">case</span> <span class="string">'username'</span>:
      <span class="keyword">if</span> (<span class="variable">value</span>.<span class="variable">length</span> < <span class="number">3</span>) <span class="variable">error</span> = <span class="string">'3文字以上入力してください'</span>;
      <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">'email'</span>:
      <span class="keyword">if</span> (<span class="variable">value</span> && !<span class="string">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.<span class="method">test</span>(<span class="variable">value</span>)) {
        <span class="variable">error</span> = <span class="string">'有効なメールアドレスを入力してください'</span>;
      }
      <span class="keyword">break</span>;
  }

  <span class="keyword">if</span> (<span class="variable">error</span>) {
    <span class="variable">input</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'input-error'</span>);
    <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="variable">error</span>;
  } <span class="keyword">else</span> {
    <span class="variable">input</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'input-error'</span>);
    <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="string">''</span>;
  }
}

<span class="comment">// 各入力欄にblurイベントを設定</span>
<span class="variable">document</span>.<span class="method">querySelectorAll</span>(<span class="string">'input'</span>).<span class="method">forEach</span>(<span class="variable">input</span> => {
  <span class="variable">input</span>.<span class="method">addEventListener</span>(<span class="string">'blur'</span>, () => <span class="method">validateField</span>(<span class="variable">input</span>));
});</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 8-4 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 8-4</span>
        <h2 class="section-title">正規表現</h2>
      </div>

      <div class="intro-text">
        <p>正規表現（Regular Expression）は、文字列のパターンを表現する強力なツールです。入力検証やテキスト処理に欠かせません。</p>
      </div>

      <div class="subsection">
        <h3>正規表現の基本</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
正規表現の基本操作

## 実装要件
- リテラル記法 `/pattern/` で正規表現を作成
- コンストラクタ `new RegExp()` で動的に作成
- `test()` でマッチ判定（true/false）
- `match()` でマッチ部分を取得
- `replace()` で置換
- フラグ `i`（大文字小文字無視）、`g`（全体検索）、`m`（複数行）

## 使用するAPI
- 正規表現リテラル `/pattern/flags`
- `new RegExp(pattern, flags)`
- `RegExp.prototype.test()`
- `String.prototype.match()` / `replace()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">正規表現の作成と使用</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 正規表現の作成方法</span>
<span class="keyword">const</span> <span class="variable">regex1</span> = <span class="string">/pattern/</span>;          <span class="comment">// リテラル記法</span>
<span class="keyword">const</span> <span class="variable">regex2</span> = <span class="keyword">new</span> <span class="method">RegExp</span>(<span class="string">'pattern'</span>);  <span class="comment">// コンストラクタ</span>

<span class="comment">// test(): マッチするかどうかを判定（true/false）</span>
<span class="keyword">const</span> <span class="variable">pattern</span> = <span class="string">/hello/</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">pattern</span>.<span class="method">test</span>(<span class="string">"hello world"</span>));  <span class="comment">// true</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">pattern</span>.<span class="method">test</span>(<span class="string">"hi there"</span>));    <span class="comment">// false</span>

<span class="comment">// match(): マッチした部分を配列で取得</span>
<span class="keyword">const</span> <span class="variable">str</span> = <span class="string">"私の電話番号は090-1234-5678です"</span>;
<span class="keyword">const</span> <span class="variable">phonePattern</span> = <span class="string">/\d{3}-\d{4}-\d{4}/</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">str</span>.<span class="method">match</span>(<span class="variable">phonePattern</span>));  <span class="comment">// ["090-1234-5678"]</span>

<span class="comment">// replace(): マッチした部分を置換</span>
<span class="keyword">const</span> <span class="variable">text</span> = <span class="string">"Hello World"</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">text</span>.<span class="method">replace</span>(<span class="string">/World/</span>, <span class="string">"JavaScript"</span>));  <span class="comment">// "Hello JavaScript"</span>

<span class="comment">// フラグ</span>
<span class="comment">// i: 大文字小文字を区別しない</span>
<span class="comment">// g: 全てのマッチを検索</span>
<span class="comment">// m: 複数行モード</span>
<span class="keyword">const</span> <span class="variable">caseInsensitive</span> = <span class="string">/hello/i</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">caseInsensitive</span>.<span class="method">test</span>(<span class="string">"HELLO"</span>));  <span class="comment">// true</span>

<span class="keyword">const</span> <span class="variable">globalReplace</span> = <span class="string">"aaa bbb aaa"</span>.<span class="method">replace</span>(<span class="string">/aaa/g</span>, <span class="string">"XXX"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">globalReplace</span>);  <span class="comment">// "XXX bbb XXX"</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>よく使うパターン</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>パターン</th>
                <th>意味</th>
                <th>例</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>\d</code></td>
                <td>数字（0-9）</td>
                <td><code>/\d+/</code> 数字1文字以上</td>
              </tr>
              <tr>
                <td><code>\w</code></td>
                <td>英数字とアンダースコア</td>
                <td><code>/\w+/</code></td>
              </tr>
              <tr>
                <td><code>\s</code></td>
                <td>空白文字</td>
                <td><code>/\s+/</code> スペース等</td>
              </tr>
              <tr>
                <td><code>.</code></td>
                <td>任意の1文字</td>
                <td><code>/a.b/</code> aXbなど</td>
              </tr>
              <tr>
                <td><code>^</code></td>
                <td>行頭</td>
                <td><code>/^Hello/</code></td>
              </tr>
              <tr>
                <td><code>$</code></td>
                <td>行末</td>
                <td><code>/World$/</code></td>
              </tr>
              <tr>
                <td><code>*</code></td>
                <td>0回以上の繰り返し</td>
                <td><code>/ab*/</code></td>
              </tr>
              <tr>
                <td><code>+</code></td>
                <td>1回以上の繰り返し</td>
                <td><code>/ab+/</code></td>
              </tr>
              <tr>
                <td><code>?</code></td>
                <td>0回または1回</td>
                <td><code>/ab?/</code></td>
              </tr>
              <tr>
                <td><code>{n,m}</code></td>
                <td>n回以上m回以下</td>
                <td><code>/\d{2,4}/</code></td>
              </tr>
              <tr>
                <td><code>[abc]</code></td>
                <td>文字クラス</td>
                <td><code>/[aeiou]/</code> 母音</td>
              </tr>
              <tr>
                <td><code>[^abc]</code></td>
                <td>否定文字クラス</td>
                <td><code>/[^0-9]/</code> 数字以外</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
フォームバリデーション用の正規表現パターン集

## 実装要件
- メールアドレスのパターン
- 電話番号（ハイフンあり）のパターン
- 郵便番号（ハイフンあり/なし両対応）のパターン
- パスワード（英字と数字を含む8文字以上）のパターン
- 半角英数字のみのパターン
- ひらがな・カタカナ・漢字のパターン

## 使用するAPI
- 正規表現リテラル `/pattern/`
- 文字クラス `[a-zA-Z0-9]`
- 量指定子 `+`, `*`, `{n,m}`
- アンカー `^`, `$`
- Unicode範囲 `[\u3040-\u309F]`（ひらがな等）</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">バリデーションパターン集</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// メールアドレス</span>
<span class="keyword">const</span> <span class="variable">emailRegex</span> = <span class="string">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">emailRegex</span>.<span class="method">test</span>(<span class="string">"user@example.com"</span>));  <span class="comment">// true</span>

<span class="comment">// 電話番号（ハイフンあり）</span>
<span class="keyword">const</span> <span class="variable">phoneRegex</span> = <span class="string">/^0\d{1,4}-\d{1,4}-\d{4}$/</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">phoneRegex</span>.<span class="method">test</span>(<span class="string">"090-1234-5678"</span>));  <span class="comment">// true</span>

<span class="comment">// 郵便番号</span>
<span class="keyword">const</span> <span class="variable">zipRegex</span> = <span class="string">/^\d{3}-?\d{4}$/</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">zipRegex</span>.<span class="method">test</span>(<span class="string">"123-4567"</span>));  <span class="comment">// true</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">zipRegex</span>.<span class="method">test</span>(<span class="string">"1234567"</span>));   <span class="comment">// true</span>

<span class="comment">// URL</span>
<span class="keyword">const</span> <span class="variable">urlRegex</span> = <span class="string">/^https?:\/\/[\w\-._~:/?#[\]@!$&'()*+,;=%]+$/</span>;

<span class="comment">// パスワード（英字と数字を含む8文字以上）</span>
<span class="keyword">const</span> <span class="variable">passwordRegex</span> = <span class="string">/^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z\d]{8,}$/</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">passwordRegex</span>.<span class="method">test</span>(<span class="string">"pass1234"</span>));  <span class="comment">// true</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">passwordRegex</span>.<span class="method">test</span>(<span class="string">"password"</span>));  <span class="comment">// false（数字なし）</span>

<span class="comment">// 半角英数字のみ</span>
<span class="keyword">const</span> <span class="variable">alphanumericRegex</span> = <span class="string">/^[a-zA-Z0-9]+$/</span>;

<span class="comment">// ひらがなのみ</span>
<span class="keyword">const</span> <span class="variable">hiraganaRegex</span> = <span class="string">/^[\u3040-\u309F]+$/</span>;

<span class="comment">// カタカナのみ</span>
<span class="keyword">const</span> <span class="variable">katakanaRegex</span> = <span class="string">/^[\u30A0-\u30FF]+$/</span>;

<span class="comment">// 漢字を含む</span>
<span class="keyword">const</span> <span class="variable">kanjiRegex</span> = <span class="string">/[\u4E00-\u9FFF]/</span>;</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 8-5 実習 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 8-5</span>
        <h2 class="section-title">実習：会員登録フォーム</h2>
      </div>

      <div class="intro-text">
        <p>リアルタイムバリデーションとパスワード強度メーターを備えた会員登録フォームを作成しましょう。</p>
      </div>

      <div class="subsection">
        <h3>完成イメージ</h3>
        <div class="demo-area" style="padding: 20px;">
          <div id="signup-demo" style="max-width: 400px; margin: 0 auto; font-family: sans-serif;">
            <form id="demo-signup-form" style="background: white; padding: 24px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
              <h2 style="margin-bottom: 20px; color: #1e293b;">会員登録</h2>

              <div style="margin-bottom: 16px;">
                <label style="display: block; margin-bottom: 6px; font-weight: 600; font-size: 14px;">ユーザー名</label>
                <input type="text" id="demo-username" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px;" placeholder="3文字以上">
                <div id="demo-username-error" style="color: #ef4444; font-size: 12px; margin-top: 4px;"></div>
              </div>

              <div style="margin-bottom: 16px;">
                <label style="display: block; margin-bottom: 6px; font-weight: 600; font-size: 14px;">メールアドレス</label>
                <input type="email" id="demo-email" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px;" placeholder="example@mail.com">
                <div id="demo-email-error" style="color: #ef4444; font-size: 12px; margin-top: 4px;"></div>
              </div>

              <div style="margin-bottom: 16px;">
                <label style="display: block; margin-bottom: 6px; font-weight: 600; font-size: 14px;">パスワード</label>
                <input type="password" id="demo-password" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px;" placeholder="8文字以上">
                <div id="demo-password-strength" style="margin-top: 8px;">
                  <div style="height: 4px; background: #e2e8f0; border-radius: 2px; overflow: hidden;">
                    <div id="demo-strength-bar" style="height: 100%; width: 0; background: #ef4444; transition: all 0.3s;"></div>
                  </div>
                  <div id="demo-strength-text" style="font-size: 12px; margin-top: 4px;"></div>
                </div>
                <div id="demo-password-error" style="color: #ef4444; font-size: 12px; margin-top: 4px;"></div>
              </div>

              <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 6px; font-weight: 600; font-size: 14px;">パスワード（確認）</label>
                <input type="password" id="demo-password-confirm" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px;" placeholder="もう一度入力">
                <div id="demo-confirm-error" style="color: #ef4444; font-size: 12px; margin-top: 4px;"></div>
              </div>

              <button type="submit" id="demo-submit-btn" style="width: 100%; padding: 12px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; opacity: 0.5;" disabled>登録する</button>
            </form>
          </div>
        </div>

        <script>
          (function() {
            const username = document.getElementById('demo-username');
            const email = document.getElementById('demo-email');
            const password = document.getElementById('demo-password');
            const passwordConfirm = document.getElementById('demo-password-confirm');
            const submitBtn = document.getElementById('demo-submit-btn');
            const strengthBar = document.getElementById('demo-strength-bar');
            const strengthText = document.getElementById('demo-strength-text');

            function validateUsername() {
              const value = username.value;
              const errorEl = document.getElementById('demo-username-error');
              if (value.length > 0 && value.length < 3) {
                errorEl.textContent = '3文字以上入力してください';
                username.style.borderColor = '#ef4444';
                return false;
              }
              errorEl.textContent = '';
              username.style.borderColor = value.length >= 3 ? '#22c55e' : '#e2e8f0';
              return value.length >= 3;
            }

            function validateEmail() {
              const value = email.value;
              const errorEl = document.getElementById('demo-email-error');
              const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
              if (value.length > 0 && !regex.test(value)) {
                errorEl.textContent = '有効なメールアドレスを入力してください';
                email.style.borderColor = '#ef4444';
                return false;
              }
              errorEl.textContent = '';
              email.style.borderColor = regex.test(value) ? '#22c55e' : '#e2e8f0';
              return regex.test(value);
            }

            function checkPasswordStrength(pass) {
              let strength = 0;
              if (pass.length >= 8) strength++;
              if (pass.length >= 12) strength++;
              if (/[a-z]/.test(pass) && /[A-Z]/.test(pass)) strength++;
              if (/\d/.test(pass)) strength++;
              if (/[!@#$%^&*]/.test(pass)) strength++;
              return strength;
            }

            function validatePassword() {
              const value = password.value;
              const errorEl = document.getElementById('demo-password-error');
              const strength = checkPasswordStrength(value);

              const colors = ['#ef4444', '#f97316', '#eab308', '#84cc16', '#22c55e'];
              const texts = ['', '弱い', '普通', '強い', 'とても強い'];
              const widths = ['0%', '25%', '50%', '75%', '100%'];

              strengthBar.style.width = widths[strength];
              strengthBar.style.background = colors[strength] || colors[0];
              strengthText.textContent = texts[strength] || '';
              strengthText.style.color = colors[strength] || '';

              if (value.length > 0 && value.length < 8) {
                errorEl.textContent = '8文字以上入力してください';
                password.style.borderColor = '#ef4444';
                return false;
              }
              errorEl.textContent = '';
              password.style.borderColor = value.length >= 8 ? '#22c55e' : '#e2e8f0';
              return value.length >= 8;
            }

            function validateConfirm() {
              const value = passwordConfirm.value;
              const errorEl = document.getElementById('demo-confirm-error');
              if (value.length > 0 && value !== password.value) {
                errorEl.textContent = 'パスワードが一致しません';
                passwordConfirm.style.borderColor = '#ef4444';
                return false;
              }
              errorEl.textContent = '';
              passwordConfirm.style.borderColor = value === password.value && value.length > 0 ? '#22c55e' : '#e2e8f0';
              return value === password.value && value.length > 0;
            }

            function updateSubmitButton() {
              const isValid = validateUsername() && validateEmail() && validatePassword() && validateConfirm();
              submitBtn.disabled = !isValid;
              submitBtn.style.opacity = isValid ? '1' : '0.5';
            }

            username.addEventListener('input', () => { validateUsername(); updateSubmitButton(); });
            email.addEventListener('input', () => { validateEmail(); updateSubmitButton(); });
            password.addEventListener('input', () => { validatePassword(); validateConfirm(); updateSubmitButton(); });
            passwordConfirm.addEventListener('input', () => { validateConfirm(); updateSubmitButton(); });

            document.getElementById('demo-signup-form').addEventListener('submit', (e) => {
              e.preventDefault();
              alert('登録が完了しました！');
            });
          })();
        </script>
      </div>

      <div class="subsection">
        <h3>実装コード</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
リアルタイムバリデーション付き会員登録フォーム

## 実装要件
- ユーザー名・メール・パスワード・パスワード確認の入力欄
- `input` イベントで即座にバリデーション
- パスワード強度メーター（長さ、大文字小文字、数字、記号をスコア化）
- エラーメッセージと入力欄の色で視覚的フィードバック
- 全て有効になるまで送信ボタンを無効化

## 使用するAPI
- `addEventListener('input', handler)`
- `RegExp.prototype.test()`
- `Element.classList.add()` / `remove()`
- `HTMLButtonElement.disabled`
- `Element.style` / CSSカスタムプロパティ</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">signup-form.html</span>
          </div>
          <div class="demo-body vertical">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">HTML + JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="tag">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attr">lang</span>=<span class="value">"ja"</span><span class="tag">&gt;</span>
<span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attr">charset</span>=<span class="value">"UTF-8"</span><span class="tag">&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attr">name</span>=<span class="value">"viewport"</span> <span class="attr">content</span>=<span class="value">"width=device-width, initial-scale=1.0"</span><span class="tag">&gt;</span>
  <span class="tag">&lt;title&gt;</span>会員登録フォーム<span class="tag">&lt;/title&gt;</span>
  <span class="tag">&lt;style&gt;</span>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: sans-serif;
      background: #667eea;
      min-height: 100vh;
      padding: 40px 20px;
    }
    .form-container {
      max-width: 400px;
      margin: 0 auto;
      background: white;
      padding: 32px;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
    h1 { text-align: center; margin-bottom: 24px; color: #1e293b; }
    .form-group { margin-bottom: 20px; }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #374151;
    }
    input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s;
    }
    input:focus { outline: none; border-color: #3b82f6; }
    input.valid { border-color: #22c55e; }
    input.invalid { border-color: #ef4444; }
    .error-message {
      color: #ef4444;
      font-size: 13px;
      margin-top: 6px;
      min-height: 20px;
    }
    .strength-meter {
      margin-top: 8px;
    }
    .strength-bar {
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
    }
    .strength-fill {
      height: 100%;
      width: 0;
      transition: all 0.3s;
    }
    .strength-text {
      font-size: 13px;
      margin-top: 4px;
    }
    .submit-btn {
      width: 100%;
      padding: 14px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    .submit-btn:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    .submit-btn:not(:disabled):hover {
      background: #2563eb;
      transform: translateY(-2px);
    }
  <span class="tag">&lt;/style&gt;</span>
<span class="tag">&lt;/head&gt;</span>
<span class="tag">&lt;body&gt;</span>
  <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"form-container"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;h1&gt;</span>会員登録<span class="tag">&lt;/h1&gt;</span>
    <span class="tag">&lt;form</span> <span class="attr">id</span>=<span class="value">"signupForm"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"form-group"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;label</span> <span class="attr">for</span>=<span class="value">"username"</span><span class="tag">&gt;</span>ユーザー名<span class="tag">&lt;/label&gt;</span>
        <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"text"</span> <span class="attr">id</span>=<span class="value">"username"</span> <span class="attr">name</span>=<span class="value">"username"</span>
               <span class="attr">placeholder</span>=<span class="value">"3文字以上20文字以内"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"error-message"</span> <span class="attr">id</span>=<span class="value">"username-error"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>

      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"form-group"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;label</span> <span class="attr">for</span>=<span class="value">"email"</span><span class="tag">&gt;</span>メールアドレス<span class="tag">&lt;/label&gt;</span>
        <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"email"</span> <span class="attr">id</span>=<span class="value">"email"</span> <span class="attr">name</span>=<span class="value">"email"</span>
               <span class="attr">placeholder</span>=<span class="value">"example@mail.com"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"error-message"</span> <span class="attr">id</span>=<span class="value">"email-error"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>

      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"form-group"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;label</span> <span class="attr">for</span>=<span class="value">"password"</span><span class="tag">&gt;</span>パスワード<span class="tag">&lt;/label&gt;</span>
        <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"password"</span> <span class="attr">id</span>=<span class="value">"password"</span> <span class="attr">name</span>=<span class="value">"password"</span>
               <span class="attr">placeholder</span>=<span class="value">"8文字以上"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"strength-meter"</span><span class="tag">&gt;</span>
          <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"strength-bar"</span><span class="tag">&gt;</span>
            <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"strength-fill"</span> <span class="attr">id</span>=<span class="value">"strength-fill"</span><span class="tag">&gt;&lt;/div&gt;</span>
          <span class="tag">&lt;/div&gt;</span>
          <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"strength-text"</span> <span class="attr">id</span>=<span class="value">"strength-text"</span><span class="tag">&gt;&lt;/div&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"error-message"</span> <span class="attr">id</span>=<span class="value">"password-error"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>

      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"form-group"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;label</span> <span class="attr">for</span>=<span class="value">"password-confirm"</span><span class="tag">&gt;</span>パスワード（確認）<span class="tag">&lt;/label&gt;</span>
        <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"password"</span> <span class="attr">id</span>=<span class="value">"password-confirm"</span> <span class="attr">name</span>=<span class="value">"passwordConfirm"</span>
               <span class="attr">placeholder</span>=<span class="value">"もう一度入力"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"error-message"</span> <span class="attr">id</span>=<span class="value">"confirm-error"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>

      <span class="tag">&lt;button</span> <span class="attr">type</span>=<span class="value">"submit"</span> <span class="attr">class</span>=<span class="value">"submit-btn"</span> <span class="attr">id</span>=<span class="value">"submit-btn"</span> <span class="attr">disabled</span><span class="tag">&gt;</span>
        登録する
      <span class="tag">&lt;/button&gt;</span>
    <span class="tag">&lt;/form&gt;</span>
  <span class="tag">&lt;/div&gt;</span>

  <span class="tag">&lt;script&gt;</span>
    <span class="comment">// DOM要素</span>
    <span class="keyword">const</span> <span class="variable">form</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'signupForm'</span>);
    <span class="keyword">const</span> <span class="variable">usernameInput</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'username'</span>);
    <span class="keyword">const</span> <span class="variable">emailInput</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'email'</span>);
    <span class="keyword">const</span> <span class="variable">passwordInput</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'password'</span>);
    <span class="keyword">const</span> <span class="variable">confirmInput</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'password-confirm'</span>);
    <span class="keyword">const</span> <span class="variable">submitBtn</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'submit-btn'</span>);
    <span class="keyword">const</span> <span class="variable">strengthFill</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'strength-fill'</span>);
    <span class="keyword">const</span> <span class="variable">strengthText</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'strength-text'</span>);

    <span class="comment">// バリデーション状態</span>
    <span class="keyword">const</span> <span class="variable">validationState</span> = {
      <span class="variable">username</span>: <span class="keyword">false</span>,
      <span class="variable">email</span>: <span class="keyword">false</span>,
      <span class="variable">password</span>: <span class="keyword">false</span>,
      <span class="variable">confirm</span>: <span class="keyword">false</span>
    };

    <span class="comment">// パスワード強度チェック</span>
    <span class="keyword">function</span> <span class="method">checkPasswordStrength</span>(<span class="variable">password</span>) {
      <span class="keyword">let</span> <span class="variable">strength</span> = <span class="number">0</span>;

      <span class="keyword">if</span> (<span class="variable">password</span>.<span class="variable">length</span> >= <span class="number">8</span>) <span class="variable">strength</span>++;
      <span class="keyword">if</span> (<span class="variable">password</span>.<span class="variable">length</span> >= <span class="number">12</span>) <span class="variable">strength</span>++;
      <span class="keyword">if</span> (<span class="string">/[a-z]/</span>.<span class="method">test</span>(<span class="variable">password</span>) && <span class="string">/[A-Z]/</span>.<span class="method">test</span>(<span class="variable">password</span>)) <span class="variable">strength</span>++;
      <span class="keyword">if</span> (<span class="string">/\d/</span>.<span class="method">test</span>(<span class="variable">password</span>)) <span class="variable">strength</span>++;
      <span class="keyword">if</span> (<span class="string">/[!@#$%^&*(),.?":{}|&lt;&gt;]/</span>.<span class="method">test</span>(<span class="variable">password</span>)) <span class="variable">strength</span>++;

      <span class="keyword">return</span> <span class="variable">strength</span>;
    }

    <span class="comment">// 強度表示を更新</span>
    <span class="keyword">function</span> <span class="method">updateStrengthMeter</span>(<span class="variable">strength</span>) {
      <span class="keyword">const</span> <span class="variable">colors</span> = [<span class="string">'#ef4444'</span>, <span class="string">'#f97316'</span>, <span class="string">'#eab308'</span>, <span class="string">'#84cc16'</span>, <span class="string">'#22c55e'</span>];
      <span class="keyword">const</span> <span class="variable">texts</span> = [<span class="string">''</span>, <span class="string">'弱い'</span>, <span class="string">'普通'</span>, <span class="string">'強い'</span>, <span class="string">'とても強い'</span>];
      <span class="keyword">const</span> <span class="variable">widths</span> = [<span class="string">'0%'</span>, <span class="string">'25%'</span>, <span class="string">'50%'</span>, <span class="string">'75%'</span>, <span class="string">'100%'</span>];

      <span class="variable">strengthFill</span>.<span class="variable">style</span>.<span class="variable">width</span> = <span class="variable">widths</span>[<span class="variable">strength</span>] || <span class="string">'0%'</span>;
      <span class="variable">strengthFill</span>.<span class="variable">style</span>.<span class="variable">background</span> = <span class="variable">colors</span>[<span class="variable">strength</span>] || <span class="variable">colors</span>[<span class="number">0</span>];
      <span class="variable">strengthText</span>.<span class="variable">textContent</span> = <span class="variable">texts</span>[<span class="variable">strength</span>] || <span class="string">''</span>;
      <span class="variable">strengthText</span>.<span class="variable">style</span>.<span class="variable">color</span> = <span class="variable">colors</span>[<span class="variable">strength</span>] || <span class="string">''</span>;
    }

    <span class="comment">// 入力フィールドの状態更新</span>
    <span class="keyword">function</span> <span class="method">setFieldState</span>(<span class="variable">input</span>, <span class="variable">isValid</span>, <span class="variable">errorEl</span>, <span class="variable">message</span>) {
      <span class="keyword">if</span> (<span class="variable">isValid</span>) {
        <span class="variable">input</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'invalid'</span>);
        <span class="variable">input</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'valid'</span>);
        <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="string">''</span>;
      } <span class="keyword">else</span> {
        <span class="variable">input</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'valid'</span>);
        <span class="variable">input</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'invalid'</span>);
        <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="variable">message</span>;
      }
    }

    <span class="comment">// 各フィールドのバリデーション</span>
    <span class="keyword">function</span> <span class="method">validateUsername</span>() {
      <span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">usernameInput</span>.<span class="variable">value</span>.<span class="method">trim</span>();
      <span class="keyword">const</span> <span class="variable">errorEl</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'username-error'</span>);

      <span class="keyword">if</span> (<span class="variable">value</span>.<span class="variable">length</span> === <span class="number">0</span>) {
        <span class="variable">usernameInput</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'valid'</span>, <span class="string">'invalid'</span>);
        <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="string">''</span>;
        <span class="variable">validationState</span>.<span class="variable">username</span> = <span class="keyword">false</span>;
      } <span class="keyword">else if</span> (<span class="variable">value</span>.<span class="variable">length</span> < <span class="number">3</span>) {
        <span class="method">setFieldState</span>(<span class="variable">usernameInput</span>, <span class="keyword">false</span>, <span class="variable">errorEl</span>, <span class="string">'3文字以上入力してください'</span>);
        <span class="variable">validationState</span>.<span class="variable">username</span> = <span class="keyword">false</span>;
      } <span class="keyword">else if</span> (<span class="variable">value</span>.<span class="variable">length</span> > <span class="number">20</span>) {
        <span class="method">setFieldState</span>(<span class="variable">usernameInput</span>, <span class="keyword">false</span>, <span class="variable">errorEl</span>, <span class="string">'20文字以内で入力してください'</span>);
        <span class="variable">validationState</span>.<span class="variable">username</span> = <span class="keyword">false</span>;
      } <span class="keyword">else</span> {
        <span class="method">setFieldState</span>(<span class="variable">usernameInput</span>, <span class="keyword">true</span>, <span class="variable">errorEl</span>, <span class="string">''</span>);
        <span class="variable">validationState</span>.<span class="variable">username</span> = <span class="keyword">true</span>;
      }
      <span class="method">updateSubmitButton</span>();
    }

    <span class="keyword">function</span> <span class="method">validateEmail</span>() {
      <span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">emailInput</span>.<span class="variable">value</span>.<span class="method">trim</span>();
      <span class="keyword">const</span> <span class="variable">errorEl</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'email-error'</span>);
      <span class="keyword">const</span> <span class="variable">emailRegex</span> = <span class="string">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;

      <span class="keyword">if</span> (<span class="variable">value</span>.<span class="variable">length</span> === <span class="number">0</span>) {
        <span class="variable">emailInput</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'valid'</span>, <span class="string">'invalid'</span>);
        <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="string">''</span>;
        <span class="variable">validationState</span>.<span class="variable">email</span> = <span class="keyword">false</span>;
      } <span class="keyword">else if</span> (!<span class="variable">emailRegex</span>.<span class="method">test</span>(<span class="variable">value</span>)) {
        <span class="method">setFieldState</span>(<span class="variable">emailInput</span>, <span class="keyword">false</span>, <span class="variable">errorEl</span>, <span class="string">'有効なメールアドレスを入力してください'</span>);
        <span class="variable">validationState</span>.<span class="variable">email</span> = <span class="keyword">false</span>;
      } <span class="keyword">else</span> {
        <span class="method">setFieldState</span>(<span class="variable">emailInput</span>, <span class="keyword">true</span>, <span class="variable">errorEl</span>, <span class="string">''</span>);
        <span class="variable">validationState</span>.<span class="variable">email</span> = <span class="keyword">true</span>;
      }
      <span class="method">updateSubmitButton</span>();
    }

    <span class="keyword">function</span> <span class="method">validatePassword</span>() {
      <span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">passwordInput</span>.<span class="variable">value</span>;
      <span class="keyword">const</span> <span class="variable">errorEl</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'password-error'</span>);
      <span class="keyword">const</span> <span class="variable">strength</span> = <span class="method">checkPasswordStrength</span>(<span class="variable">value</span>);

      <span class="method">updateStrengthMeter</span>(<span class="variable">strength</span>);

      <span class="keyword">if</span> (<span class="variable">value</span>.<span class="variable">length</span> === <span class="number">0</span>) {
        <span class="variable">passwordInput</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'valid'</span>, <span class="string">'invalid'</span>);
        <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="string">''</span>;
        <span class="variable">validationState</span>.<span class="variable">password</span> = <span class="keyword">false</span>;
      } <span class="keyword">else if</span> (<span class="variable">value</span>.<span class="variable">length</span> < <span class="number">8</span>) {
        <span class="method">setFieldState</span>(<span class="variable">passwordInput</span>, <span class="keyword">false</span>, <span class="variable">errorEl</span>, <span class="string">'8文字以上入力してください'</span>);
        <span class="variable">validationState</span>.<span class="variable">password</span> = <span class="keyword">false</span>;
      } <span class="keyword">else</span> {
        <span class="method">setFieldState</span>(<span class="variable">passwordInput</span>, <span class="keyword">true</span>, <span class="variable">errorEl</span>, <span class="string">''</span>);
        <span class="variable">validationState</span>.<span class="variable">password</span> = <span class="keyword">true</span>;
      }
      <span class="method">validateConfirm</span>();
      <span class="method">updateSubmitButton</span>();
    }

    <span class="keyword">function</span> <span class="method">validateConfirm</span>() {
      <span class="keyword">const</span> <span class="variable">value</span> = <span class="variable">confirmInput</span>.<span class="variable">value</span>;
      <span class="keyword">const</span> <span class="variable">errorEl</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'confirm-error'</span>);

      <span class="keyword">if</span> (<span class="variable">value</span>.<span class="variable">length</span> === <span class="number">0</span>) {
        <span class="variable">confirmInput</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'valid'</span>, <span class="string">'invalid'</span>);
        <span class="variable">errorEl</span>.<span class="variable">textContent</span> = <span class="string">''</span>;
        <span class="variable">validationState</span>.<span class="variable">confirm</span> = <span class="keyword">false</span>;
      } <span class="keyword">else if</span> (<span class="variable">value</span> !== <span class="variable">passwordInput</span>.<span class="variable">value</span>) {
        <span class="method">setFieldState</span>(<span class="variable">confirmInput</span>, <span class="keyword">false</span>, <span class="variable">errorEl</span>, <span class="string">'パスワードが一致しません'</span>);
        <span class="variable">validationState</span>.<span class="variable">confirm</span> = <span class="keyword">false</span>;
      } <span class="keyword">else</span> {
        <span class="method">setFieldState</span>(<span class="variable">confirmInput</span>, <span class="keyword">true</span>, <span class="variable">errorEl</span>, <span class="string">''</span>);
        <span class="variable">validationState</span>.<span class="variable">confirm</span> = <span class="keyword">true</span>;
      }
      <span class="method">updateSubmitButton</span>();
    }

    <span class="comment">// 送信ボタンの状態更新</span>
    <span class="keyword">function</span> <span class="method">updateSubmitButton</span>() {
      <span class="keyword">const</span> <span class="variable">isValid</span> = <span class="variable">Object</span>.<span class="method">values</span>(<span class="variable">validationState</span>).<span class="method">every</span>(<span class="variable">v</span> => <span class="variable">v</span>);
      <span class="variable">submitBtn</span>.<span class="variable">disabled</span> = !<span class="variable">isValid</span>;
    }

    <span class="comment">// イベントリスナー</span>
    <span class="variable">usernameInput</span>.<span class="method">addEventListener</span>(<span class="string">'input'</span>, <span class="variable">validateUsername</span>);
    <span class="variable">emailInput</span>.<span class="method">addEventListener</span>(<span class="string">'input'</span>, <span class="variable">validateEmail</span>);
    <span class="variable">passwordInput</span>.<span class="method">addEventListener</span>(<span class="string">'input'</span>, <span class="variable">validatePassword</span>);
    <span class="variable">confirmInput</span>.<span class="method">addEventListener</span>(<span class="string">'input'</span>, <span class="variable">validateConfirm</span>);

    <span class="comment">// フォーム送信</span>
    <span class="variable">form</span>.<span class="method">addEventListener</span>(<span class="string">'submit'</span>, (<span class="variable">e</span>) => {
      <span class="variable">e</span>.<span class="method">preventDefault</span>();

      <span class="keyword">const</span> <span class="variable">formData</span> = {
        <span class="variable">username</span>: <span class="variable">usernameInput</span>.<span class="variable">value</span>,
        <span class="variable">email</span>: <span class="variable">emailInput</span>.<span class="variable">value</span>,
        <span class="variable">password</span>: <span class="variable">passwordInput</span>.<span class="variable">value</span>
      };

      <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'登録データ:'</span>, <span class="variable">formData</span>);
      <span class="method">alert</span>(<span class="string">'登録が完了しました！'</span>);
    });
  <span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">学習ポイント</div>
          <div class="info-box-content">
            <ul>
              <li><strong>リアルタイムバリデーション</strong>: inputイベントで即座にフィードバック</li>
              <li><strong>パスワード強度メーター</strong>: 複数の条件をチェックしてスコア化</li>
              <li><strong>視覚的フィードバック</strong>: 色やアイコンで状態を表示</li>
              <li><strong>送信ボタン制御</strong>: すべて有効になるまで無効化</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- 練習問題 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">練習問題</span>
        <h2 class="section-title">Chapter 8 練習問題</h2>
      </div>

      <div class="exercise-list">
        <div class="exercise-item">
          <div class="exercise-number">Q1</div>
          <div class="exercise-content">
            <p>電話番号の入力欄を作成し、「090-1234-5678」の形式かどうかをリアルタイムでチェックしてください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q2</div>
          <div class="exercise-content">
            <p>郵便番号の入力欄を作成し、「123-4567」の形式かどうかをチェックしてください。ハイフンなしの7桁も許可してください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q3</div>
          <div class="exercise-content">
            <p>テキストエリアを作成し、入力文字数をリアルタイムで表示してください。200文字を超えたら警告色に変えてください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q4</div>
          <div class="exercise-content">
            <p>以下の正規表現が何をチェックしているか説明してください。</p>
            <pre>/^(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$/</pre>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 解答 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">解答</span>
        <h2 class="section-title">練習問題の解答</h2>
      </div>

      <div class="answer-list">
        <div class="answer-item">
          <div class="answer-header">Q1の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>const phoneInput = document.getElementById('phone');
const phoneRegex = /^0[789]0-\d{4}-\d{4}$/;

phoneInput.addEventListener('input', () => {
  const isValid = phoneRegex.test(phoneInput.value);
  phoneInput.style.borderColor = isValid ? 'green' : 'red';
});</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q2の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>const zipInput = document.getElementById('zip');
const zipRegex = /^\d{3}-?\d{4}$/;

zipInput.addEventListener('blur', () => {
  const isValid = zipRegex.test(zipInput.value);
  // 結果を表示...
});</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q3の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>const textarea = document.getElementById('message');
const counter = document.getElementById('counter');
const maxLength = 200;

textarea.addEventListener('input', () => {
  const length = textarea.value.length;
  counter.textContent = `${length}/${maxLength}`;
  counter.style.color = length > maxLength ? 'red' : 'inherit';
});</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q4の解答</div>
          <div class="answer-content">
            <p>この正規表現は以下をチェックしています：</p>
            <ul>
              <li><code>^</code>: 文字列の先頭</li>
              <li><code>(?=.*[A-Z])</code>: 大文字を少なくとも1つ含む（先読みアサーション）</li>
              <li><code>(?=.*\d)</code>: 数字を少なくとも1つ含む（先読みアサーション）</li>
              <li><code>[A-Za-z\d]{8,}</code>: 英字と数字のみで8文字以上</li>
              <li><code>$</code>: 文字列の末尾</li>
            </ul>
            <p>つまり「大文字と数字を少なくとも1つずつ含む、8文字以上の英数字パスワード」をチェックしています。</p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- ページナビゲーション -->
  <div class="page-nav">
    <a href="7js-objects-arrays.html" class="page-nav-btn prev">
      <div class="page-nav-label">前へ</div>
      <div class="page-nav-title">オブジェクトと配列</div>
    </a>
    <a href="9js-async.html" class="page-nav-btn next">
      <div class="page-nav-label">次へ</div>
      <div class="page-nav-title">非同期処理とAPI</div>
    </a>
  </div>

  <footer class="footer">
    <p>JavaScript入門 - 職業訓練校教材</p>
  </footer>

  <script src="../shared/demo.js"></script>
</body>
</html>
