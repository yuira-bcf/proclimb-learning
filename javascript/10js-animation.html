<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chapter 10: アニメーション - JavaScript入門</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../shared/common.css">
  <style>
    :root {
      --primary: #007AFF;
      --primary-dark: #0062CC;
      --primary-light: #EFF6FF;
      --primary-lighter: #BFDBFE;
    }
    .nav-category-links { display: none; }
  </style>
</head>
<body>
  <nav class="global-nav"></nav>
  <script src="../shared/js/nav-javascript.js"></script>

  <div class="container">
    <!-- チャプターヘッダー -->
    <header class="chapter-header">
      <div class="chapter-badge">Chapter</div>
      <div class="chapter-number">10</div>
      <h1 class="chapter-title">アニメーション</h1>
      <p class="chapter-subtitle">動きで魅せるWebサイトを作ろう</p>
    </header>

    <!-- 目次 -->
    <nav class="toc">
      <h2 class="toc-title">この章の内容</h2>
      <ul class="toc-list">
        <li class="toc-item"><span class="toc-number">10-1</span>CSSトランジションとJavaScript</li>
        <li class="toc-item"><span class="toc-number">10-2</span>CSSアニメーション</li>
        <li class="toc-item"><span class="toc-number">10-3</span>Intersection Observer API</li>
        <li class="toc-item"><span class="toc-number">10-4</span>スクロールアニメーション</li>
        <li class="toc-item"><span class="toc-number">10-5</span>実習：ポートフォリオセクション</li>
        <li class="toc-item"><span class="toc-number">練習</span>練習問題</li>
      </ul>
    </nav>

    <!-- Section 10-1 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 10-1</span>
        <h2 class="section-title">CSSトランジションとJavaScript</h2>
      </div>

      <div class="intro-text">
        <p>CSSトランジションは、プロパティの変化を滑らかにアニメーションさせる機能です。JavaScriptと組み合わせることで、ユーザーの操作に応じた動的なアニメーションを実現できます。</p>
      </div>

      <div class="subsection">
        <h3>CSSトランジションの基本</h3>
        <p>トランジションは、要素のスタイルが変わるときに、その変化を滑らかに表現します。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
CSSトランジションでホバーアニメーション

## 実装要件
- ホバー時に背景色を変更
- ホバー時にサイズを拡大（`scale`）
- `transition`プロパティで滑らかに変化

## 使用するCSSプロパティ
- transition-property: 対象プロパティ
- transition-duration: アニメーション時間
- transition-timing-function: イージング関数
- 短縮形: `transition: all 0.3s ease`

## イージング例
- ease / ease-in / ease-out / linear</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">トランジションの基本構文</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">CSS</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">/* 基本構文 */</span>
<span class="class-name">.element</span> {
  <span class="comment">/* transition: プロパティ 時間 イージング 遅延; */</span>
  <span class="keyword">transition</span>: <span class="value">all 0.3s ease</span>;
}

<span class="comment">/* 個別指定 */</span>
<span class="class-name">.box</span> {
  <span class="keyword">background-color</span>: <span class="value">#3b82f6</span>;
  <span class="keyword">transform</span>: <span class="value">scale(1)</span>;
  <span class="keyword">transition-property</span>: <span class="value">background-color, transform</span>;
  <span class="keyword">transition-duration</span>: <span class="value">0.3s</span>;
  <span class="keyword">transition-timing-function</span>: <span class="value">ease-out</span>;
}

<span class="class-name">.box</span>:<span class="keyword">hover</span> {
  <span class="keyword">background-color</span>: <span class="value">#ef4444</span>;
  <span class="keyword">transform</span>: <span class="value">scale(1.1)</span>;
}</code></pre>
            </div>
            <div class="demo-preview-section">
              <div class="demo-preview-header">
                <span class="demo-preview-label">プレビュー</span>
              </div>
              <div class="demo-preview-content" style="text-align: center;">
                <div style="width: 100px; height: 100px; background: #3b82f6; margin: 20px auto; border-radius: 8px; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.background='#ef4444'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='#3b82f6'; this.style.transform='scale(1)'"></div>
                <p style="color: #64748b; font-size: 14px;">ホバーしてみよう</p>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>transition プロパティ</h4>
              <div class="syntax-pattern">transition: プロパティ 時間 イージング 遅延;</div>
              <p>CSSプロパティの変化を滑らかにアニメーションさせます。<code>all</code>を指定すると全てのプロパティに適用されます。</p>
            </div>
            <div class="syntax-item">
              <h4>transition-property</h4>
              <div class="syntax-pattern">transition-property: background-color, transform;</div>
              <p>アニメーションの対象となるプロパティを指定します。カンマ区切りで複数指定できます。</p>
            </div>
            <div class="syntax-item">
              <h4>transition-timing-function</h4>
              <div class="syntax-pattern">transition-timing-function: ease | ease-in | ease-out | linear;</div>
              <p>アニメーションの速度曲線（イージング）を指定します。ease-outは現れるアニメーション、ease-inは消えるアニメーションに適しています。</p>
            </div>
          </div>
        </div>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>イージング関数</th>
                <th>説明</th>
                <th>使用場面</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>ease</code></td>
                <td>ゆっくり開始、加速、減速</td>
                <td>一般的なアニメーション</td>
              </tr>
              <tr>
                <td><code>ease-in</code></td>
                <td>ゆっくり開始</td>
                <td>消えていくアニメーション</td>
              </tr>
              <tr>
                <td><code>ease-out</code></td>
                <td>ゆっくり終了</td>
                <td>現れるアニメーション</td>
              </tr>
              <tr>
                <td><code>ease-in-out</code></td>
                <td>ゆっくり開始・終了</td>
                <td>往復アニメーション</td>
              </tr>
              <tr>
                <td><code>linear</code></td>
                <td>一定速度</td>
                <td>進捗バー</td>
              </tr>
              <tr>
                <td><code>cubic-bezier()</code></td>
                <td>カスタム曲線</td>
                <td>独自の動き</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="subsection">
        <h3>JavaScriptでトランジションをトリガー</h3>
        <p>JavaScriptでクラスを追加・削除することで、トランジションを制御できます。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
JavaScriptでCSSトランジションをトリガー

## 実装要件
- ボタンクリックで`classList.toggle()`を実行
- クラス追加/削除でアニメーション発火
- フェードイン/アウト + 移動（translateY）

## 使用するAPI
- element.classList.toggle('active')
- addEventListener('click', callback)

## CSSの構成
- 初期状態: opacity: 0.5, translateY(20px)
- .active時: opacity: 1, translateY(0)
- transition: opacity 0.4s, transform 0.4s</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">クラス切り替えでアニメーション</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">HTML + CSS + JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">&lt;!-- HTML --&gt;</span>
<span class="tag">&lt;button</span> <span class="attr">id</span>=<span class="value">"toggleBtn"</span><span class="tag">&gt;</span>アニメーション<span class="tag">&lt;/button&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"card"</span><span class="tag">&gt;</span>カード<span class="tag">&lt;/div&gt;</span>

<span class="comment">&lt;!-- CSS --&gt;</span>
<span class="tag">&lt;style&gt;</span>
<span class="class-name">.card</span> {
  <span class="keyword">opacity</span>: <span class="value">0.5</span>;
  <span class="keyword">transform</span>: <span class="value">translateY(20px)</span>;
  <span class="keyword">transition</span>: <span class="value">opacity 0.4s ease, transform 0.4s ease</span>;
}

<span class="class-name">.card.active</span> {
  <span class="keyword">opacity</span>: <span class="value">1</span>;
  <span class="keyword">transform</span>: <span class="value">translateY(0)</span>;
}
<span class="tag">&lt;/style&gt;</span>

<span class="comment">&lt;!-- JavaScript --&gt;</span>
<span class="tag">&lt;script&gt;</span>
<span class="keyword">const</span> <span class="variable">btn</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'toggleBtn'</span>);
<span class="keyword">const</span> <span class="variable">card</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">'.card'</span>);

<span class="variable">btn</span>.<span class="method">addEventListener</span>(<span class="string">'click'</span>, () => {
  <span class="variable">card</span>.<span class="variable">classList</span>.<span class="method">toggle</span>(<span class="string">'active'</span>);
});
<span class="tag">&lt;/script&gt;</span></code></pre>
            </div>
            <div class="demo-preview-section">
              <div class="demo-preview-header">
                <span class="demo-preview-label">プレビュー</span>
              </div>
              <div class="demo-preview-content" style="text-align: center;">
                <button id="demo-toggle-btn" style="padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 20px;">アニメーション</button>
                <div id="demo-card" style="padding: 20px; background: #f1f5f9; border-radius: 8px; opacity: 0.5; transform: translateY(20px); transition: opacity 0.4s ease, transform 0.4s ease;">カード</div>
                <script>
                  document.getElementById('demo-toggle-btn').addEventListener('click', function() {
                    const card = document.getElementById('demo-card');
                    if (card.style.opacity === '1') {
                      card.style.opacity = '0.5';
                      card.style.transform = 'translateY(20px)';
                    } else {
                      card.style.opacity = '1';
                      card.style.transform = 'translateY(0)';
                    }
                  });
                </script>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>classList.toggle()</h4>
              <div class="syntax-pattern">element.classList.toggle('クラス名')</div>
              <p>指定したクラスがあれば削除し、なければ追加します。アニメーションの切り替えに便利です。</p>
            </div>
            <div class="syntax-item">
              <h4>classList.add() / remove()</h4>
              <div class="syntax-pattern">element.classList.add('active');
element.classList.remove('active');</div>
              <p>クラスの追加・削除を明示的に行います。CSSでトランジションを定義しておくと、クラスの切り替えでアニメーションが発火します。</p>
            </div>
            <div class="syntax-item">
              <h4>classList.contains()</h4>
              <div class="syntax-pattern">if (element.classList.contains('active')) {
  ...
}</div>
              <p>要素が指定したクラスを持っているかどうかをチェックします。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>transitionendイベント</h3>
        <p><code>transitionend</code>イベントを使うと、トランジションが完了したタイミングで処理を実行できます。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
トランジション完了を検知

## 実装要件
- `transitionend`イベントをリッスン
- `event.propertyName`で完了したプロパティを確認
- 特定のプロパティのみで処理を実行
- `{ once: true }`で一度だけ実行

## 使用するAPI
- addEventListener('transitionend', callback)
- event.propertyName
- { once: true }オプション

## 用途
- アニメーション後に要素を削除
- 次のアニメーションを連続実行</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">トランジション完了を検知</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">element</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">'.animated'</span>);

<span class="variable">element</span>.<span class="method">addEventListener</span>(<span class="string">'transitionend'</span>, (<span class="variable">event</span>) => {
  <span class="comment">// 対象のプロパティを確認</span>
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'完了したプロパティ:'</span>, <span class="variable">event</span>.<span class="variable">propertyName</span>);

  <span class="comment">// 複数プロパティがある場合は特定のものだけ処理</span>
  <span class="keyword">if</span> (<span class="variable">event</span>.<span class="variable">propertyName</span> === <span class="string">'transform'</span>) {
    <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'transformのアニメーションが完了しました！'</span>);
    <span class="comment">// 次のアクション（要素を削除、別のアニメーション開始など）</span>
    <span class="variable">element</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'animating'</span>);
  }
});

<span class="comment">// 一度だけ実行する場合</span>
<span class="variable">element</span>.<span class="method">addEventListener</span>(<span class="string">'transitionend'</span>, <span class="method">handleTransitionEnd</span>, { <span class="variable">once</span>: <span class="keyword">true</span> });</code></pre>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">transitionendの注意点</div>
          <div class="info-box-content">
            <ul>
              <li>複数のプロパティがアニメーションする場合、それぞれでイベントが発火します</li>
              <li><code>event.propertyName</code>でどのプロパティか確認できます</li>
              <li>アニメーションが中断された場合は発火しません</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 10-2 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 10-2</span>
        <h2 class="section-title">CSSアニメーション</h2>
      </div>

      <div class="intro-text">
        <p>CSS <code>@keyframes</code>を使うと、より複雑なアニメーションを定義できます。JavaScriptと組み合わせることで、動的にアニメーションを制御できます。</p>
      </div>

      <div class="subsection">
        <h3>@keyframesの基本</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
@keyframesで複数のアニメーションを定義

## 実装要件
- `@keyframes fadeInUp`: 下からフェードイン
- `@keyframes bounce`: 上下にバウンス
- `@keyframes pulse`: 拡大縮小を繰り返す
- `animation`プロパティで適用

## 使用するCSSプロパティ
- animation-name: キーフレーム名
- animation-duration: 時間
- animation-timing-function: イージング
- animation-fill-mode: 終了後の状態
- animation-iteration-count: 繰り返し回数

## 短縮形
- `animation: name duration timing fill-mode`</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">キーフレームアニメーション</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">CSS</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">/* アニメーションを定義 */</span>
<span class="keyword">@keyframes</span> <span class="method">fadeInUp</span> {
  <span class="number">0%</span> {
    <span class="keyword">opacity</span>: <span class="value">0</span>;
    <span class="keyword">transform</span>: <span class="value">translateY(30px)</span>;
  }
  <span class="number">100%</span> {
    <span class="keyword">opacity</span>: <span class="value">1</span>;
    <span class="keyword">transform</span>: <span class="value">translateY(0)</span>;
  }
}

<span class="keyword">@keyframes</span> <span class="method">bounce</span> {
  <span class="number">0%</span>, <span class="number">100%</span> { <span class="keyword">transform</span>: <span class="value">translateY(0)</span>; }
  <span class="number">50%</span> { <span class="keyword">transform</span>: <span class="value">translateY(-20px)</span>; }
}

<span class="keyword">@keyframes</span> <span class="method">pulse</span> {
  <span class="number">0%</span> { <span class="keyword">transform</span>: <span class="value">scale(1)</span>; }
  <span class="number">50%</span> { <span class="keyword">transform</span>: <span class="value">scale(1.1)</span>; }
  <span class="number">100%</span> { <span class="keyword">transform</span>: <span class="value">scale(1)</span>; }
}

<span class="comment">/* アニメーションを適用 */</span>
<span class="class-name">.animated-element</span> {
  <span class="keyword">animation-name</span>: <span class="value">fadeInUp</span>;
  <span class="keyword">animation-duration</span>: <span class="value">0.6s</span>;
  <span class="keyword">animation-timing-function</span>: <span class="value">ease-out</span>;
  <span class="keyword">animation-fill-mode</span>: <span class="value">forwards</span>;

  <span class="comment">/* 短縮形 */</span>
  <span class="keyword">animation</span>: <span class="value">fadeInUp 0.6s ease-out forwards</span>;
}</code></pre>
            </div>
            <div class="demo-preview-section">
              <div class="demo-preview-header">
                <span class="demo-preview-label">プレビュー</span>
              </div>
              <div class="demo-preview-content" style="text-align: center;">
                <style>
                  @keyframes demo-bounce {
                    0%, 100% { transform: translateY(0); }
                    50% { transform: translateY(-20px); }
                  }
                  @keyframes demo-pulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.1); }
                  }
                </style>
                <div style="display: flex; justify-content: center; gap: 30px;">
                  <div style="text-align: center;">
                    <div style="width: 60px; height: 60px; background: #3b82f6; border-radius: 50%; animation: demo-bounce 1s ease-in-out infinite;"></div>
                    <p style="font-size: 12px; color: #64748b; margin-top: 8px;">bounce</p>
                  </div>
                  <div style="text-align: center;">
                    <div style="width: 60px; height: 60px; background: #22c55e; border-radius: 8px; animation: demo-pulse 1.5s ease-in-out infinite;"></div>
                    <p style="font-size: 12px; color: #64748b; margin-top: 8px;">pulse</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>プロパティ</th>
                <th>説明</th>
                <th>値の例</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>animation-name</code></td>
                <td>使用するキーフレーム名</td>
                <td>fadeIn, bounce</td>
              </tr>
              <tr>
                <td><code>animation-duration</code></td>
                <td>アニメーションの長さ</td>
                <td>0.5s, 300ms</td>
              </tr>
              <tr>
                <td><code>animation-iteration-count</code></td>
                <td>繰り返し回数</td>
                <td>1, 3, infinite</td>
              </tr>
              <tr>
                <td><code>animation-direction</code></td>
                <td>再生方向</td>
                <td>normal, reverse, alternate</td>
              </tr>
              <tr>
                <td><code>animation-fill-mode</code></td>
                <td>終了後の状態</td>
                <td>none, forwards, backwards</td>
              </tr>
              <tr>
                <td><code>animation-play-state</code></td>
                <td>再生状態</td>
                <td>running, paused</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="subsection">
        <h3>JavaScriptでアニメーションを制御</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
JavaScriptでCSSアニメーションを制御

## 実装要件
- `classList.add()`でアニメーション開始
- `animationPlayState`で一時停止/再開
- `animationend`イベントで完了検知
- リフロー強制でアニメーションをリセット

## 使用するAPI
- classList.add() / remove()
- element.style.animationPlayState = 'paused' / 'running'
- addEventListener('animationend', callback)
- void element.offsetWidth（リフロー強制）

## リセット手順
1. クラスを削除
2. `void element.offsetWidth`でリフロー
3. クラスを再追加</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">アニメーションの制御</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">element</span> = <span class="variable">document</span>.<span class="method">querySelector</span>(<span class="string">'.animated'</span>);

<span class="comment">// アニメーションを開始（クラスを追加）</span>
<span class="variable">element</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'animate'</span>);

<span class="comment">// アニメーションを一時停止</span>
<span class="variable">element</span>.<span class="variable">style</span>.<span class="variable">animationPlayState</span> = <span class="string">'paused'</span>;

<span class="comment">// アニメーションを再開</span>
<span class="variable">element</span>.<span class="variable">style</span>.<span class="variable">animationPlayState</span> = <span class="string">'running'</span>;

<span class="comment">// アニメーション完了時のイベント</span>
<span class="variable">element</span>.<span class="method">addEventListener</span>(<span class="string">'animationend'</span>, () => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'アニメーション完了！'</span>);
  <span class="variable">element</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'animate'</span>);
});

<span class="comment">// アニメーションを再実行（リセットが必要）</span>
<span class="keyword">function</span> <span class="method">restartAnimation</span>(<span class="variable">el</span>) {
  <span class="variable">el</span>.<span class="variable">classList</span>.<span class="method">remove</span>(<span class="string">'animate'</span>);
  <span class="comment">// リフローを強制してアニメーションをリセット</span>
  <span class="variable">void</span> <span class="variable">el</span>.<span class="variable">offsetWidth</span>;
  <span class="variable">el</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'animate'</span>);
}</code></pre>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 10-3 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 10-3</span>
        <h2 class="section-title">Intersection Observer API</h2>
      </div>

      <div class="intro-text">
        <p>Intersection Observer APIは、要素がビューポート（画面）に入ったかどうかを効率的に監視できます。スクロール時のアニメーション発火に最適です。</p>
      </div>

      <div class="subsection">
        <h3>仕組みの図解</h3>

        <div class="demo-area" style="padding: 20px; overflow-x: auto;">
          <svg viewBox="0 0 700 350" style="min-width: 600px; width: 100%; height: auto;">
            <!-- ビューポート -->
            <rect x="150" y="20" width="400" height="300" rx="12" fill="#dbeafe" stroke="#3b82f6" stroke-width="3"/>
            <text x="350" y="50" text-anchor="middle" font-size="14" font-weight="bold" fill="#1e40af">ビューポート（画面に見えている領域）</text>

            <!-- スクロール可能領域 -->
            <rect x="180" y="70" width="340" height="230" rx="8" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1" stroke-dasharray="5,5"/>

            <!-- 監視対象要素（まだ見えていない） -->
            <rect x="200" y="-30" width="120" height="60" rx="6" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
            <text x="260" y="5" text-anchor="middle" font-size="11" fill="#991b1b">要素A</text>
            <text x="260" y="20" text-anchor="middle" font-size="10" fill="#991b1b">（まだ見えない）</text>

            <!-- 監視対象要素（一部見えている） -->
            <rect x="200" y="80" width="120" height="60" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
            <text x="260" y="105" text-anchor="middle" font-size="11" fill="#92400e">要素B</text>
            <text x="260" y="120" text-anchor="middle" font-size="10" fill="#92400e">（一部表示）</text>

            <!-- 監視対象要素（完全に見えている） -->
            <rect x="200" y="160" width="120" height="60" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
            <text x="260" y="185" text-anchor="middle" font-size="11" fill="#166534">要素C</text>
            <text x="260" y="200" text-anchor="middle" font-size="10" fill="#166534">（完全表示）</text>

            <!-- コールバック説明 -->
            <rect x="380" y="100" width="130" height="100" rx="8" fill="#fef9c3" stroke="#eab308" stroke-width="2"/>
            <text x="445" y="125" text-anchor="middle" font-size="12" font-weight="bold" fill="#854d0e">コールバック発火</text>
            <text x="445" y="145" text-anchor="middle" font-size="10" fill="#854d0e">isIntersecting:</text>
            <text x="445" y="160" text-anchor="middle" font-size="10" fill="#854d0e">true / false</text>
            <text x="445" y="180" text-anchor="middle" font-size="10" fill="#854d0e">intersectionRatio:</text>
            <text x="445" y="195" text-anchor="middle" font-size="10" fill="#854d0e">0.0 ~ 1.0</text>

            <!-- 矢印 -->
            <path d="M320 190 L370 170" stroke="#eab308" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

            <defs>
              <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#eab308"/>
              </marker>
            </defs>

            <!-- オプション説明 -->
            <rect x="50" y="180" width="90" height="130" rx="6" fill="white" stroke="#64748b" stroke-width="1"/>
            <text x="95" y="200" text-anchor="middle" font-size="11" font-weight="bold" fill="#1e293b">オプション</text>
            <text x="95" y="220" text-anchor="middle" font-size="9" fill="#64748b">root</text>
            <text x="95" y="235" text-anchor="middle" font-size="9" fill="#64748b">rootMargin</text>
            <text x="95" y="250" text-anchor="middle" font-size="9" fill="#64748b">threshold</text>
          </svg>
        </div>
      </div>

      <div class="subsection">
        <h3>基本的な使い方</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
要素が画面に入ったことを検知

## 実装要件
- `IntersectionObserver`を作成
- オプションで`root`、`rootMargin`、`threshold`を設定
- コールバックで`entry.isIntersecting`を判定
- `observer.unobserve()`で監視を解除

## 使用するAPI
- new IntersectionObserver(callback, options)
- observer.observe(element)
- observer.unobserve(element)
- entry.isIntersecting
- entry.target

## オプション
- root: null（ビューポート基準）
- rootMargin: '0px'
- threshold: 0.1（10%見えたら発火）</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">Intersection Observerの基本</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// オプション設定</span>
<span class="keyword">const</span> <span class="variable">options</span> = {
  <span class="variable">root</span>: <span class="keyword">null</span>,        <span class="comment">// ビューポートを基準にする</span>
  <span class="variable">rootMargin</span>: <span class="string">'0px'</span>,  <span class="comment">// マージンを設定</span>
  <span class="variable">threshold</span>: <span class="number">0.1</span>      <span class="comment">// 10%見えたら発火</span>
};

<span class="comment">// コールバック関数</span>
<span class="keyword">const</span> <span class="method">callback</span> = (<span class="variable">entries</span>, <span class="variable">observer</span>) => {
  <span class="variable">entries</span>.<span class="method">forEach</span>(<span class="variable">entry</span> => {
    <span class="keyword">if</span> (<span class="variable">entry</span>.<span class="variable">isIntersecting</span>) {
      <span class="comment">// 要素が画面に入った</span>
      <span class="variable">entry</span>.<span class="variable">target</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'visible'</span>);

      <span class="comment">// 一度だけ実行する場合は監視を解除</span>
      <span class="variable">observer</span>.<span class="method">unobserve</span>(<span class="variable">entry</span>.<span class="variable">target</span>);
    }
  });
};

<span class="comment">// オブザーバーを作成</span>
<span class="keyword">const</span> <span class="variable">observer</span> = <span class="keyword">new</span> <span class="method">IntersectionObserver</span>(<span class="variable">callback</span>, <span class="variable">options</span>);

<span class="comment">// 監視対象を登録</span>
<span class="keyword">const</span> <span class="variable">targets</span> = <span class="variable">document</span>.<span class="method">querySelectorAll</span>(<span class="string">'.animate-on-scroll'</span>);
<span class="variable">targets</span>.<span class="method">forEach</span>(<span class="variable">target</span> => {
  <span class="variable">observer</span>.<span class="method">observe</span>(<span class="variable">target</span>);
});</code></pre>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>new IntersectionObserver()</h4>
              <div class="syntax-pattern">new IntersectionObserver(callback, options)</div>
              <p>要素がビューポート（または指定した要素）に交差したことを検知するオブザーバーを作成します。</p>
            </div>
            <div class="syntax-item">
              <h4>observer.observe()</h4>
              <div class="syntax-pattern">observer.observe(監視対象の要素)</div>
              <p>指定した要素の監視を開始します。複数の要素を同じオブザーバーで監視できます。</p>
            </div>
            <div class="syntax-item">
              <h4>entry.isIntersecting</h4>
              <div class="syntax-pattern">if (entry.isIntersecting) {
  ...
}</div>
              <p>要素がビューポートに入っているかどうかを示すブール値。trueなら画面内に表示されています。</p>
            </div>
            <div class="syntax-item">
              <h4>observer.unobserve()</h4>
              <div class="syntax-pattern">observer.unobserve(entry.target)</div>
              <p>指定した要素の監視を停止します。一度だけアニメーションさせたい場合に使用します。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>オプションの詳細</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>オプション</th>
                <th>説明</th>
                <th>値の例</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>root</code></td>
                <td>交差を判定する基準要素。nullならビューポート</td>
                <td>null, document.querySelector('.container')</td>
              </tr>
              <tr>
                <td><code>rootMargin</code></td>
                <td>rootの周りのマージン。早めに発火させたい場合に使う</td>
                <td>'0px', '100px 0px', '-50px'</td>
              </tr>
              <tr>
                <td><code>threshold</code></td>
                <td>何%見えたら発火するか。0~1の値または配列</td>
                <td>0, 0.5, 1, [0, 0.25, 0.5, 0.75, 1]</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
thresholdオプションの使い分け

## 実装要件
- `threshold: 0` - 少しでも見えたら発火
- `threshold: 0.5` - 半分見えたら発火
- `threshold: 1` - 完全に見えたら発火
- `threshold: [0, 0.25, 0.5, 0.75, 1]` - 複数ポイントで発火
- `rootMargin`で早めに発火

## 使用例
- 0: フェードイン開始
- 0.5: 中央表示時のアクション
- 1: 完全表示後の処理
- 配列: スクロール進捗の追跡

## rootMargin例
- '100px 0px' - 画面の100px手前で発火</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">thresholdの使い分け</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 少しでも見えたら発火（デフォルト）</span>
<span class="variable">threshold</span>: <span class="number">0</span>

<span class="comment">// 半分見えたら発火</span>
<span class="variable">threshold</span>: <span class="number">0.5</span>

<span class="comment">// 完全に見えたら発火</span>
<span class="variable">threshold</span>: <span class="number">1</span>

<span class="comment">// 複数のポイントで発火（プログレス表示などに）</span>
<span class="variable">threshold</span>: [<span class="number">0</span>, <span class="number">0.25</span>, <span class="number">0.5</span>, <span class="number">0.75</span>, <span class="number">1</span>]

<span class="comment">// 早めに発火させる（画面下100px手前で）</span>
<span class="variable">rootMargin</span>: <span class="string">'0px 0px 100px 0px'</span></code></pre>
            </div>
          </div>
        </div>

        <div class="info-box success">
          <div class="info-box-title">Intersection Observerの利点</div>
          <div class="info-box-content">
            <ul>
              <li><strong>パフォーマンス</strong>：scrollイベントより効率的（メインスレッドをブロックしない）</li>
              <li><strong>シンプル</strong>：複雑な計算が不要</li>
              <li><strong>バッテリー消費</strong>：省電力（モバイルに優しい）</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 10-4 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 10-4</span>
        <h2 class="section-title">スクロールアニメーション</h2>
      </div>

      <div class="intro-text">
        <p>スクロールに連動したアニメーションは、現代のWebサイトで広く使われています。requestAnimationFrameとthrottleを使って、パフォーマンスを維持しながら実装しましょう。</p>
      </div>

      <div class="subsection">
        <h3>requestAnimationFrame</h3>
        <p><code>requestAnimationFrame</code>は、ブラウザの描画タイミングに合わせてコールバックを実行します。滑らかなアニメーションに必須です。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
requestAnimationFrameで滑らかなアニメーション

## 実装要件
- `requestAnimationFrame()`でアニメーションループ
- 毎フレーム位置を更新
- スクロール量に連動したパララックス効果

## 使用するAPI
- requestAnimationFrame(callback)
- window.scrollY
- element.style.transform

## アニメーションループ
1. 関数内で描画処理
2. `requestAnimationFrame()`で次フレームを予約
3. 繰り返し実行

## パララックス計算
- offset = scrollY * speed（0.3〜0.5程度）</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">requestAnimationFrameの使い方</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 基本的な使い方</span>
<span class="keyword">function</span> <span class="method">animate</span>() {
  <span class="comment">// アニメーション処理</span>
  <span class="variable">element</span>.<span class="variable">style</span>.<span class="variable">transform</span> = <span class="string">`translateX(${<span class="variable">position</span>}px)`</span>;

  <span class="comment">// 次のフレームで再実行</span>
  <span class="method">requestAnimationFrame</span>(<span class="variable">animate</span>);
}

<span class="comment">// アニメーション開始</span>
<span class="method">requestAnimationFrame</span>(<span class="variable">animate</span>);

<span class="comment">// スクロール量に連動させる例</span>
<span class="keyword">function</span> <span class="method">onScroll</span>() {
  <span class="method">requestAnimationFrame</span>(() => {
    <span class="keyword">const</span> <span class="variable">scrollY</span> = <span class="variable">window</span>.<span class="variable">scrollY</span>;
    <span class="keyword">const</span> <span class="variable">parallax</span> = <span class="variable">scrollY</span> * <span class="number">0.5</span>;

    <span class="variable">background</span>.<span class="variable">style</span>.<span class="variable">transform</span> = <span class="string">`translateY(${<span class="variable">parallax</span>}px)`</span>;
  });
}

<span class="variable">window</span>.<span class="method">addEventListener</span>(<span class="string">'scroll'</span>, <span class="variable">onScroll</span>);</code></pre>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>requestAnimationFrame()</h4>
              <div class="syntax-pattern">requestAnimationFrame(コールバック関数)</div>
              <p>ブラウザの描画タイミング（通常60fps）に合わせてコールバックを実行します。滑らかなアニメーションの実現に必須です。</p>
            </div>
            <div class="syntax-item">
              <h4>アニメーションループ</h4>
              <div class="syntax-pattern">function animate() {
  ...
  requestAnimationFrame(animate);
}</div>
              <p>関数の中で自分自身を次フレームに予約することで、継続的なアニメーションを実現します。</p>
            </div>
            <div class="syntax-item">
              <h4>window.scrollY</h4>
              <div class="syntax-pattern">const scrollY = window.scrollY;</div>
              <p>現在のスクロール位置（ピクセル）を取得します。パララックス効果などで使用します。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>throttle（スロットル）関数</h3>
        <p>scrollイベントは大量に発火するため、処理を間引くthrottle関数を使います。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
スクロールイベントを間引くthrottle関数

## 実装要件
- 一定時間ごとに1回だけ処理を実行
- クロージャで状態を保持
- `setTimeout()`でフラグをリセット
- scrollイベントに適用

## 使用するAPI
- setTimeout()
- Function.prototype.apply()
- addEventListener('scroll', throttledFn)

## throttle関数の仕組み
1. フラグがfalseなら即時実行
2. フラグをtrueに設定
3. 指定時間後にフラグをfalseに戻す
4. フラグがtrueの間は実行しない

## 推奨間隔
- スクロール: 16ms〜100ms</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">throttle関数の実装</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// throttle関数（一定時間ごとに実行）</span>
<span class="keyword">function</span> <span class="method">throttle</span>(<span class="variable">func</span>, <span class="variable">limit</span>) {
  <span class="keyword">let</span> <span class="variable">inThrottle</span>;

  <span class="keyword">return</span> <span class="keyword">function</span>(...<span class="variable">args</span>) {
    <span class="keyword">if</span> (!<span class="variable">inThrottle</span>) {
      <span class="variable">func</span>.<span class="method">apply</span>(<span class="keyword">this</span>, <span class="variable">args</span>);
      <span class="variable">inThrottle</span> = <span class="keyword">true</span>;
      <span class="method">setTimeout</span>(() => <span class="variable">inThrottle</span> = <span class="keyword">false</span>, <span class="variable">limit</span>);
    }
  };
}

<span class="comment">// 使用例：100msごとに実行</span>
<span class="keyword">const</span> <span class="method">handleScroll</span> = <span class="method">throttle</span>(() => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'スクロール処理'</span>, <span class="variable">window</span>.<span class="variable">scrollY</span>);
}, <span class="number">100</span>);

<span class="variable">window</span>.<span class="method">addEventListener</span>(<span class="string">'scroll'</span>, <span class="variable">handleScroll</span>);</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>パララックス効果</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
data属性でパララックス速度を指定

## 実装要件
- `data-parallax`属性で速度を指定
- `querySelectorAll()`で対象要素を取得
- `dataset.parallax`で速度値を読み取り
- `throttle()`でパフォーマンス最適化

## 使用するAPI
- element.dataset.parallax
- querySelectorAll('[data-parallax]')
- element.style.transform = `translateY(${offset}px)`
- throttle(callback, 16)

## HTML例
- `<div data-parallax="0.3">` - ゆっくり
- `<div data-parallax="0.5">` - 標準
- `<div data-parallax="0.7">` - 速め</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">シンプルなパララックス</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">parallaxElements</span> = <span class="variable">document</span>.<span class="method">querySelectorAll</span>(<span class="string">'[data-parallax]'</span>);

<span class="keyword">function</span> <span class="method">updateParallax</span>() {
  <span class="keyword">const</span> <span class="variable">scrollY</span> = <span class="variable">window</span>.<span class="variable">scrollY</span>;

  <span class="variable">parallaxElements</span>.<span class="method">forEach</span>(<span class="variable">element</span> => {
    <span class="comment">// data-parallax属性から速度を取得（0.5 = 半分の速さ）</span>
    <span class="keyword">const</span> <span class="variable">speed</span> = <span class="variable">element</span>.<span class="variable">dataset</span>.<span class="variable">parallax</span> || <span class="number">0.5</span>;
    <span class="keyword">const</span> <span class="variable">offset</span> = <span class="variable">scrollY</span> * <span class="variable">speed</span>;

    <span class="variable">element</span>.<span class="variable">style</span>.<span class="variable">transform</span> = <span class="string">`translateY(${<span class="variable">offset</span>}px)`</span>;
  });
}

<span class="comment">// スクロールイベントにthrottleを適用</span>
<span class="variable">window</span>.<span class="method">addEventListener</span>(<span class="string">'scroll'</span>, <span class="method">throttle</span>(<span class="variable">updateParallax</span>, <span class="number">16</span>));

<span class="comment">/* HTML側の使用例
&lt;div class="hero-bg" data-parallax="0.3"&gt;&lt;/div&gt;
&lt;div class="hero-text" data-parallax="0.5"&gt;&lt;/div&gt;
*/</span></code></pre>
            </div>
          </div>
        </div>

        <div class="info-box warning">
          <div class="info-box-title">パフォーマンスに関する注意</div>
          <div class="info-box-content">
            <ul>
              <li>transformとopacityのみをアニメーションさせる（GPUで処理される）</li>
              <li>widthやheight、top、leftの変更は避ける</li>
              <li>will-changeプロパティを使う場合は必要な時だけ</li>
              <li>モバイルではパララックスを無効にすることも検討</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 10-5 実習 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 10-5</span>
        <h2 class="section-title">実習：ポートフォリオセクション</h2>
      </div>

      <div class="intro-text">
        <p>学んだアニメーション技術を使って、ポートフォリオサイトのセクションを作成します。フェードイン、スライドイン、プログレスバー、スタガー（ずれ）アニメーションを実装しましょう。</p>
      </div>

      <div class="subsection">
        <h3>完成イメージ</h3>
        <div class="demo-area" style="padding: 20px;">
          <style>
            @keyframes demo-fadeInUp {
              from { opacity: 0; transform: translateY(30px); }
              to { opacity: 1; transform: translateY(0); }
            }
            @keyframes demo-slideInLeft {
              from { opacity: 0; transform: translateX(-30px); }
              to { opacity: 1; transform: translateX(0); }
            }
            @keyframes demo-progress {
              from { width: 0; }
              to { width: var(--progress); }
            }
          </style>
          <div style="max-width: 500px; margin: 0 auto;">
            <h3 style="animation: demo-fadeInUp 0.6s ease-out; margin-bottom: 20px;">スキルセクション</h3>

            <div style="animation: demo-slideInLeft 0.6s ease-out 0.1s both; margin-bottom: 16px;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                <span style="font-weight: 600;">HTML/CSS</span>
                <span>90%</span>
              </div>
              <div style="background: #e2e8f0; height: 10px; border-radius: 5px; overflow: hidden;">
                <div style="background: #3b82f6; height: 100%; width: 90%; animation: demo-progress 1s ease-out 0.5s both; --progress: 90%;"></div>
              </div>
            </div>

            <div style="animation: demo-slideInLeft 0.6s ease-out 0.2s both; margin-bottom: 16px;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                <span style="font-weight: 600;">JavaScript</span>
                <span>80%</span>
              </div>
              <div style="background: #e2e8f0; height: 10px; border-radius: 5px; overflow: hidden;">
                <div style="background: #22c55e; height: 100%; width: 80%; animation: demo-progress 1s ease-out 0.7s both; --progress: 80%;"></div>
              </div>
            </div>

            <div style="animation: demo-slideInLeft 0.6s ease-out 0.3s both;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                <span style="font-weight: 600;">React</span>
                <span>70%</span>
              </div>
              <div style="background: #e2e8f0; height: 10px; border-radius: 5px; overflow: hidden;">
                <div style="background: #f97316; height: 100%; width: 70%; animation: demo-progress 1s ease-out 0.9s both; --progress: 70%;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>実装コード</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre><code>## 機能
スクロール連動のスキルセクション

## 実装要件
- `IntersectionObserver`で画面内検知
- フェードインアップアニメーション
- スライドインアニメーション
- プログレスバーの幅アニメーション
- `animation-delay`でスタガー効果
- `unobserve()`で一度だけ発火

## 使用するAPI
- IntersectionObserver
- @keyframes fadeInUp / slideInLeft
- CSS変数 `--progress` で幅を指定
- classList.add('visible')

## スタガーの実装
- .stagger-1 { animation-delay: 0.1s }
- .stagger-2 { animation-delay: 0.2s }
- .stagger-3 { animation-delay: 0.3s }</code></pre>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">portfolio-section.html</span>
          </div>
          <div class="demo-body vertical">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">HTML + CSS + JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="tag">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attr">lang</span>=<span class="value">"ja"</span><span class="tag">&gt;</span>
<span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attr">charset</span>=<span class="value">"UTF-8"</span><span class="tag">&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attr">name</span>=<span class="value">"viewport"</span> <span class="attr">content</span>=<span class="value">"width=device-width, initial-scale=1.0"</span><span class="tag">&gt;</span>
  <span class="tag">&lt;title&gt;</span>ポートフォリオセクション<span class="tag">&lt;/title&gt;</span>
  <span class="tag">&lt;style&gt;</span>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: sans-serif; line-height: 1.6; }

    <span class="comment">/* スペーサー（スクロール確認用） */</span>
    .spacer { height: 100vh; background: #f1f5f9; }

    <span class="comment">/* セクション */</span>
    .skills-section {
      padding: 80px 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    <span class="comment">/* アニメーション定義 */</span>
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-30px); }
      to { opacity: 1; transform: translateX(0); }
    }

    @keyframes progressBar {
      from { width: 0; }
    }

    <span class="comment">/* 初期状態（見えない） */</span>
    .animate-on-scroll {
      opacity: 0;
    }

    <span class="comment">/* アニメーション発火時 */</span>
    .animate-on-scroll.visible {
      animation-fill-mode: forwards;
    }

    .fade-in-up.visible {
      animation: fadeInUp 0.6s ease-out forwards;
    }

    .slide-in-left.visible {
      animation: slideInLeft 0.6s ease-out forwards;
    }

    <span class="comment">/* スタガー（ずらし） */</span>
    .stagger-1 { animation-delay: 0.1s; }
    .stagger-2 { animation-delay: 0.2s; }
    .stagger-3 { animation-delay: 0.3s; }
    .stagger-4 { animation-delay: 0.4s; }

    <span class="comment">/* スキルバー */</span>
    .skill-item { margin-bottom: 24px; }
    .skill-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-weight: 600;
    }
    .skill-bar {
      height: 12px;
      background: #e2e8f0;
      border-radius: 6px;
      overflow: hidden;
    }
    .skill-progress {
      height: 100%;
      border-radius: 6px;
      width: 0;
      transition: width 1s ease-out;
    }
    .skill-progress.animate {
      width: var(--progress);
    }
  <span class="tag">&lt;/style&gt;</span>
<span class="tag">&lt;/head&gt;</span>
<span class="tag">&lt;body&gt;</span>
  <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"spacer"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p</span> <span class="attr">style</span>=<span class="value">"padding: 50px; text-align: center;"</span><span class="tag">&gt;</span>下にスクロールしてください<span class="tag">&lt;/p&gt;</span>
  <span class="tag">&lt;/div&gt;</span>

  <span class="tag">&lt;section</span> <span class="attr">class</span>=<span class="value">"skills-section"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;h2</span> <span class="attr">class</span>=<span class="value">"animate-on-scroll fade-in-up"</span> <span class="attr">style</span>=<span class="value">"font-size: 32px; margin-bottom: 40px;"</span><span class="tag">&gt;</span>
      スキル
    <span class="tag">&lt;/h2&gt;</span>

    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-item animate-on-scroll slide-in-left stagger-1"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-header"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;span&gt;</span>HTML / CSS<span class="tag">&lt;/span&gt;</span>
        <span class="tag">&lt;span&gt;</span>90%<span class="tag">&lt;/span&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-bar"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-progress"</span> <span class="attr">style</span>=<span class="value">"--progress: 90%; background: #3b82f6;"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-item animate-on-scroll slide-in-left stagger-2"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-header"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;span&gt;</span>JavaScript<span class="tag">&lt;/span&gt;</span>
        <span class="tag">&lt;span&gt;</span>80%<span class="tag">&lt;/span&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-bar"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-progress"</span> <span class="attr">style</span>=<span class="value">"--progress: 80%; background: #22c55e;"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-item animate-on-scroll slide-in-left stagger-3"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-header"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;span&gt;</span>React<span class="tag">&lt;/span&gt;</span>
        <span class="tag">&lt;span&gt;</span>70%<span class="tag">&lt;/span&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-bar"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-progress"</span> <span class="attr">style</span>=<span class="value">"--progress: 70%; background: #f97316;"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-item animate-on-scroll slide-in-left stagger-4"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-header"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;span&gt;</span>Node.js<span class="tag">&lt;/span&gt;</span>
        <span class="tag">&lt;span&gt;</span>60%<span class="tag">&lt;/span&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-bar"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"skill-progress"</span> <span class="attr">style</span>=<span class="value">"--progress: 60%; background: #8b5cf6;"</span><span class="tag">&gt;&lt;/div&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>
  <span class="tag">&lt;/section&gt;</span>

  <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"spacer"</span><span class="tag">&gt;&lt;/div&gt;</span>

  <span class="tag">&lt;script&gt;</span>
    <span class="comment">// Intersection Observerでスクロールアニメーション</span>
    <span class="keyword">const</span> <span class="variable">observerOptions</span> = {
      <span class="variable">threshold</span>: <span class="number">0.2</span>,
      <span class="variable">rootMargin</span>: <span class="string">'0px 0px -50px 0px'</span>
    };

    <span class="keyword">const</span> <span class="variable">observer</span> = <span class="keyword">new</span> <span class="method">IntersectionObserver</span>((<span class="variable">entries</span>) => {
      <span class="variable">entries</span>.<span class="method">forEach</span>(<span class="variable">entry</span> => {
        <span class="keyword">if</span> (<span class="variable">entry</span>.<span class="variable">isIntersecting</span>) {
          <span class="comment">// 要素を表示</span>
          <span class="variable">entry</span>.<span class="variable">target</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'visible'</span>);

          <span class="comment">// プログレスバーのアニメーション</span>
          <span class="keyword">const</span> <span class="variable">progressBar</span> = <span class="variable">entry</span>.<span class="variable">target</span>.<span class="method">querySelector</span>(<span class="string">'.skill-progress'</span>);
          <span class="keyword">if</span> (<span class="variable">progressBar</span>) {
            <span class="method">setTimeout</span>(() => {
              <span class="variable">progressBar</span>.<span class="variable">classList</span>.<span class="method">add</span>(<span class="string">'animate'</span>);
            }, <span class="number">300</span>);
          }

          <span class="comment">// 一度だけ実行</span>
          <span class="variable">observer</span>.<span class="method">unobserve</span>(<span class="variable">entry</span>.<span class="variable">target</span>);
        }
      });
    }, <span class="variable">observerOptions</span>);

    <span class="comment">// 監視対象を登録</span>
    <span class="variable">document</span>.<span class="method">querySelectorAll</span>(<span class="string">'.animate-on-scroll'</span>).<span class="method">forEach</span>(<span class="variable">el</span> => {
      <span class="variable">observer</span>.<span class="method">observe</span>(<span class="variable">el</span>);
    });
  <span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">学習ポイント</div>
          <div class="info-box-content">
            <ul>
              <li><strong>フェードインアップ</strong>：opacity + translateYで上から現れる</li>
              <li><strong>スライドイン</strong>：translateXで左から現れる</li>
              <li><strong>スタガー</strong>：animation-delayをずらして順番に表示</li>
              <li><strong>プログレスバー</strong>：CSS変数（--progress）で幅を動的に設定</li>
              <li><strong>Intersection Observer</strong>：画面に入ったらクラスを追加</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- 練習問題 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">練習問題</span>
        <h2 class="section-title">Chapter 10 練習問題</h2>
      </div>

      <div class="exercise-list">
        <div class="exercise-item">
          <div class="exercise-number">Q1</div>
          <div class="exercise-content">
            <p>CSSトランジションとCSSアニメーション（@keyframes）の違いを説明してください。どのような場面でそれぞれを使い分けますか？</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q2</div>
          <div class="exercise-content">
            <p>Intersection Observerの<code>threshold: 0.5</code>と<code>threshold: [0, 0.5, 1]</code>の違いを説明してください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q3</div>
          <div class="exercise-content">
            <p>以下の要件を満たすボタンアニメーションを実装してください。</p>
            <ol>
              <li>ホバー時に背景色が変わり、少し上に浮く</li>
              <li>クリック時に一瞬縮む</li>
              <li>すべてのアニメーションは滑らかに動く</li>
            </ol>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q4</div>
          <div class="exercise-content">
            <p>スクロールで画面に入ったときに、カードが右からスライドインするアニメーションを実装してください。複数のカードがある場合は0.1秒ずつ遅延させてください。</p>
          </div>
        </div>
      </div>
    </section>

    <!-- 解答 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">解答</span>
        <h2 class="section-title">練習問題の解答</h2>
      </div>

      <div class="answer-list">
        <div class="answer-item">
          <div class="answer-header">Q1の解答</div>
          <div class="answer-content">
            <p><strong>CSSトランジション</strong>：プロパティの値が変化したときに、その変化を滑らかにする。状態A→状態Bの単純な変化に向いている。ホバーやクラス切り替えで使う。</p>
            <p><strong>CSSアニメーション</strong>：@keyframesで複数のステップを定義できる。ループ、複雑な動き、自動再生に向いている。ローディングやエフェクトで使う。</p>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q2の解答</div>
          <div class="answer-content">
            <p><strong>threshold: 0.5</strong>：要素が50%見えたときに1回だけコールバックが呼ばれる。</p>
            <p><strong>threshold: [0, 0.5, 1]</strong>：要素が0%、50%、100%見えたそれぞれのタイミングでコールバックが呼ばれる（計3回）。スクロール進捗の追跡などに使う。</p>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q3の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre><code>.animated-button {
  padding: 12px 24px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.animated-button:hover {
  background: #2563eb;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}

.animated-button:active {
  transform: translateY(0) scale(0.98);
}</code></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q4の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre><code>/* CSS */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(50px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.card {
  opacity: 0;
}

.card.visible {
  animation: slideInRight 0.5s ease-out forwards;
}

/* JavaScript */
const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry, index) => {
    if (entry.isIntersecting) {
      // インデックスに応じて遅延
      entry.target.style.animationDelay = `${index * 0.1}s`;
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, { threshold: 0.1 });

document.querySelectorAll('.card').forEach(card => {
  observer.observe(card);
});</code></pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- コラム -->
    <div class="column">
      <div class="column-header">
        <span class="column-badge">コラム</span>
        <span class="column-title">アニメーションとアクセシビリティ</span>
      </div>
      <p>アニメーションは視覚的に魅力的ですが、すべてのユーザーにとって快適とは限りません。前庭障害を持つ方や、モーション酔いしやすい方にとって、動きの激しいアニメーションは体調不良を引き起こす可能性があります。</p>
      <p>CSSの<code>prefers-reduced-motion</code>メディアクエリを使うと、ユーザーが「視差効果を減らす」設定をしている場合にアニメーションを無効化できます。</p>
      <div class="code-block" style="margin-top: 16px;">
        <div class="code-content">
<pre><code>@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}</code></pre>
        </div>
      </div>
    </div>
  </div>

  <!-- ページナビゲーション -->
  <div class="page-nav">
    <a href="9js-async.html" class="page-nav-btn prev">
      <div class="page-nav-label">前へ</div>
      <div class="page-nav-title">非同期処理とAPI</div>
    </a>
    <a href="11js-modules.html" class="page-nav-btn next">
      <div class="page-nav-label">次へ</div>
      <div class="page-nav-title">モダンJavaScriptとモジュール</div>
    </a>
  </div>

  <footer class="footer">
    <p>JavaScript入門 - 職業訓練校教材</p>
  </footer>

  <script src="../shared/demo.js"></script>
</body>
</html>
