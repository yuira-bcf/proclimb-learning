<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Appendix B: デバッグのコツ - JavaScript入門</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../shared/common.css">
  <style>
    :root {
      --primary: #007AFF;
      --primary-dark: #0062CC;
      --primary-light: #EFF6FF;
      --primary-lighter: #BFDBFE;
    }
    .nav-category-links { display: none; }
  </style>
</head>
<body>
  <nav class="global-nav"></nav>
  <script src="../shared/js/nav-javascript.js"></script>

  <div class="container">
    <!-- チャプターヘッダー -->
    <header class="chapter-header">
      <div class="chapter-badge">Appendix</div>
      <div class="chapter-number">B</div>
      <h1 class="chapter-title">デバッグのコツ</h1>
      <p class="chapter-subtitle">効率的にバグを見つけて修正しよう</p>
    </header>

    <!-- 目次 -->
    <nav class="toc">
      <h2 class="toc-title">この章の内容</h2>
      <ul class="toc-list">
        <li class="toc-item"><span class="toc-number">B-1</span>console.log() の活用法</li>
        <li class="toc-item"><span class="toc-number">B-2</span>便利なconsoleメソッド</li>
        <li class="toc-item"><span class="toc-number">B-3</span>Chrome DevTools：ブレークポイント</li>
        <li class="toc-item"><span class="toc-number">B-4</span>ステップ実行</li>
        <li class="toc-item"><span class="toc-number">B-5</span>Watch式の使い方</li>
        <li class="toc-item"><span class="toc-number">B-6</span>Networkタブでの通信確認</li>
        <li class="toc-item"><span class="toc-number">B-7</span>よくあるバグパターンと解決法</li>
      </ul>
    </nav>

    <!-- イントロダクション -->
    <section class="section">
      <div class="intro-text">
        <p>デバッグとは、プログラムのバグ（誤り）を見つけて修正する作業のことです。効率的なデバッグ技術を身につければ、開発スピードが大幅に向上します。このページでは、様々なデバッグ手法を紹介します。</p>
      </div>

      <div class="info-box">
        <div class="info-box-title">デバッグの基本姿勢</div>
        <div class="info-box-content">
          <p>デバッグで最も大切なのは<strong>「推測せず、確認する」</strong>という姿勢です。「たぶんここが問題だろう」と推測するのではなく、実際に値や動作を確認しながら問題を特定しましょう。</p>
        </div>
      </div>
    </section>

    <!-- Section B-1 console.log() の活用法 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section B-1</span>
        <h2 class="section-title">console.log() の活用法</h2>
      </div>

      <div class="intro-text">
        <p>console.log()は最も基本的で強力なデバッグツールです。変数の値や処理の流れを確認するために使用します。</p>
      </div>

      <div class="subsection">
        <h3>基本的な使い方</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">console.log() の基本</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 単純な値の出力</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"処理開始"</span>);

<span class="comment">// 変数の値を確認</span>
<span class="keyword">const</span> <span class="variable">userName</span> = <span class="string">"田中"</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">userName</span>);  <span class="comment">// "田中"</span>

<span class="comment">// ラベルを付けて出力（推奨）</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"userName:"</span>, <span class="variable">userName</span>);  <span class="comment">// "userName: 田中"</span>

<span class="comment">// 複数の値を同時に出力</span>
<span class="keyword">const</span> <span class="variable">age</span> = <span class="number">25</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"name:"</span>, <span class="variable">userName</span>, <span class="string">"age:"</span>, <span class="variable">age</span>);

<span class="comment">// オブジェクトや配列の出力</span>
<span class="keyword">const</span> <span class="variable">user</span> = { <span class="variable">name</span>: <span class="string">"田中"</span>, <span class="variable">age</span>: <span class="number">25</span> };
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"user:"</span>, <span class="variable">user</span>);</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>効果的な使い方</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">処理の流れを追跡</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">function</span> <span class="method">processOrder</span>(<span class="variable">items</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"=== processOrder 開始 ==="</span>);
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"入力 items:"</span>, <span class="variable">items</span>);

  <span class="keyword">let</span> <span class="variable">total</span> = <span class="number">0</span>;

  <span class="keyword">for</span> (<span class="keyword">const</span> <span class="variable">item</span> <span class="keyword">of</span> <span class="variable">items</span>) {
    <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"処理中のitem:"</span>, <span class="variable">item</span>);
    <span class="variable">total</span> += <span class="variable">item</span>.<span class="variable">price</span>;
    <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"現在の合計:"</span>, <span class="variable">total</span>);
  }

  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"最終合計:"</span>, <span class="variable">total</span>);
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"=== processOrder 終了 ==="</span>);

  <span class="keyword">return</span> <span class="variable">total</span>;
}

<span class="comment">// 実行</span>
<span class="keyword">const</span> <span class="variable">items</span> = [
  { <span class="variable">name</span>: <span class="string">"りんご"</span>, <span class="variable">price</span>: <span class="number">100</span> },
  { <span class="variable">name</span>: <span class="string">"バナナ"</span>, <span class="variable">price</span>: <span class="number">150</span> }
];
<span class="method">processOrder</span>(<span class="variable">items</span>);</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="info-box warning">
        <div class="info-box-title">注意：本番環境では削除を忘れずに</div>
        <div class="info-box-content">
          <p>console.log()はデバッグ用のコードです。本番環境にデプロイする前に、不要なconsole.log()は削除しましょう。ESLintなどのツールで自動検出することもできます。</p>
        </div>
      </div>
    </section>

    <!-- Section B-2 便利なconsoleメソッド -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section B-2</span>
        <h2 class="section-title">便利なconsoleメソッド</h2>
      </div>

      <div class="intro-text">
        <p>consoleオブジェクトにはlog()以外にも便利なメソッドがたくさんあります。状況に応じて使い分けることで、デバッグがより効率的になります。</p>
      </div>

      <div class="subsection">
        <h3>console.table() - 表形式で表示</h3>
        <p>配列やオブジェクトをテーブル形式で見やすく表示します。</p>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">console.table()</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">users</span> = [
  { <span class="variable">name</span>: <span class="string">"田中"</span>, <span class="variable">age</span>: <span class="number">25</span>, <span class="variable">city</span>: <span class="string">"東京"</span> },
  { <span class="variable">name</span>: <span class="string">"山田"</span>, <span class="variable">age</span>: <span class="number">30</span>, <span class="variable">city</span>: <span class="string">"大阪"</span> },
  { <span class="variable">name</span>: <span class="string">"鈴木"</span>, <span class="variable">age</span>: <span class="number">28</span>, <span class="variable">city</span>: <span class="string">"名古屋"</span> }
];

<span class="comment">// 通常のログ</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">users</span>);

<span class="comment">// テーブル形式（見やすい！）</span>
<span class="variable">console</span>.<span class="method">table</span>(<span class="variable">users</span>);

<span class="comment">// 特定のカラムだけ表示</span>
<span class="variable">console</span>.<span class="method">table</span>(<span class="variable">users</span>, [<span class="string">"name"</span>, <span class="string">"age"</span>]);</code></pre>
            </div>
            <div class="demo-preview-section">
              <div class="demo-preview-header">
                <span class="demo-preview-label">console.table() の出力イメージ</span>
              </div>
              <div class="demo-preview-content" style="background: #1e293b; padding: 16px; border-radius: 8px; overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; color: #e2e8f0; font-size: 13px; font-family: 'JetBrains Mono', monospace;">
                  <thead>
                    <tr style="background: #334155;">
                      <th style="padding: 8px; text-align: left; border: 1px solid #475569;">(index)</th>
                      <th style="padding: 8px; text-align: left; border: 1px solid #475569;">name</th>
                      <th style="padding: 8px; text-align: left; border: 1px solid #475569;">age</th>
                      <th style="padding: 8px; text-align: left; border: 1px solid #475569;">city</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr><td style="padding: 8px; border: 1px solid #475569;">0</td><td style="padding: 8px; border: 1px solid #475569;">"田中"</td><td style="padding: 8px; border: 1px solid #475569;">25</td><td style="padding: 8px; border: 1px solid #475569;">"東京"</td></tr>
                    <tr><td style="padding: 8px; border: 1px solid #475569;">1</td><td style="padding: 8px; border: 1px solid #475569;">"山田"</td><td style="padding: 8px; border: 1px solid #475569;">30</td><td style="padding: 8px; border: 1px solid #475569;">"大阪"</td></tr>
                    <tr><td style="padding: 8px; border: 1px solid #475569;">2</td><td style="padding: 8px; border: 1px solid #475569;">"鈴木"</td><td style="padding: 8px; border: 1px solid #475569;">28</td><td style="padding: 8px; border: 1px solid #475569;">"名古屋"</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>console.group() - グループ化</h3>
        <p>関連するログをグループ化して、折りたたみ可能にします。</p>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">console.group() / console.groupEnd()</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="variable">console</span>.<span class="method">group</span>(<span class="string">"ユーザー情報"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"名前: 田中"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"年齢: 25"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"住所: 東京"</span>);
<span class="variable">console</span>.<span class="method">groupEnd</span>();

<span class="variable">console</span>.<span class="method">group</span>(<span class="string">"注文情報"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"商品: りんご"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"数量: 5"</span>);
<span class="variable">console</span>.<span class="method">groupEnd</span>();

<span class="comment">// 最初から折りたたんでおく場合</span>
<span class="variable">console</span>.<span class="method">groupCollapsed</span>(<span class="string">"詳細情報（折りたたみ）"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="string">"クリックして展開"</span>);
<span class="variable">console</span>.<span class="method">groupEnd</span>();</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>console.time() - 処理時間の計測</h3>
        <p>コードの実行時間を計測できます。パフォーマンスの確認に便利です。</p>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">console.time() / console.timeEnd()</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// タイマー開始</span>
<span class="variable">console</span>.<span class="method">time</span>(<span class="string">"ループ処理"</span>);

<span class="comment">// 重い処理</span>
<span class="keyword">let</span> <span class="variable">sum</span> = <span class="number">0</span>;
<span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> < <span class="number">1000000</span>; <span class="variable">i</span>++) {
  <span class="variable">sum</span> += <span class="variable">i</span>;
}

<span class="comment">// タイマー終了と結果表示</span>
<span class="variable">console</span>.<span class="method">timeEnd</span>(<span class="string">"ループ処理"</span>);
<span class="comment">// 出力: ループ処理: 10.5ms</span>

<span class="comment">// 複数の計測</span>
<span class="variable">console</span>.<span class="method">time</span>(<span class="string">"処理A"</span>);
<span class="variable">console</span>.<span class="method">time</span>(<span class="string">"処理B"</span>);

<span class="comment">// 処理A</span>
<span class="variable">console</span>.<span class="method">timeEnd</span>(<span class="string">"処理A"</span>);

<span class="comment">// 処理B</span>
<span class="variable">console</span>.<span class="method">timeEnd</span>(<span class="string">"処理B"</span>);</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>その他の便利なメソッド</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>メソッド</th>
                <th>説明</th>
                <th>用途</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>console.warn()</code></td>
                <td>警告メッセージ（黄色背景）</td>
                <td>潜在的な問題の通知</td>
              </tr>
              <tr>
                <td><code>console.error()</code></td>
                <td>エラーメッセージ（赤色背景）</td>
                <td>エラーの明示</td>
              </tr>
              <tr>
                <td><code>console.info()</code></td>
                <td>情報メッセージ</td>
                <td>一般的な情報</td>
              </tr>
              <tr>
                <td><code>console.clear()</code></td>
                <td>コンソールをクリア</td>
                <td>表示のリセット</td>
              </tr>
              <tr>
                <td><code>console.count()</code></td>
                <td>呼び出し回数をカウント</td>
                <td>関数の呼び出し回数確認</td>
              </tr>
              <tr>
                <td><code>console.assert()</code></td>
                <td>条件がfalseの場合のみ出力</td>
                <td>条件付きデバッグ</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">様々なconsoleメソッド</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 警告とエラー</span>
<span class="variable">console</span>.<span class="method">warn</span>(<span class="string">"この機能は非推奨です"</span>);
<span class="variable">console</span>.<span class="method">error</span>(<span class="string">"エラーが発生しました"</span>);

<span class="comment">// 呼び出し回数をカウント</span>
<span class="keyword">function</span> <span class="method">greet</span>() {
  <span class="variable">console</span>.<span class="method">count</span>(<span class="string">"greet呼び出し"</span>);
}
<span class="method">greet</span>();  <span class="comment">// greet呼び出し: 1</span>
<span class="method">greet</span>();  <span class="comment">// greet呼び出し: 2</span>
<span class="method">greet</span>();  <span class="comment">// greet呼び出し: 3</span>

<span class="comment">// 条件付き出力（falseの場合のみ）</span>
<span class="keyword">const</span> <span class="variable">age</span> = <span class="number">15</span>;
<span class="variable">console</span>.<span class="method">assert</span>(<span class="variable">age</span> >= <span class="number">18</span>, <span class="string">"年齢が18未満です"</span>);
<span class="comment">// ageが18未満なので、メッセージが出力される</span></code></pre>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section B-3 Chrome DevTools：ブレークポイント -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section B-3</span>
        <h2 class="section-title">Chrome DevTools：ブレークポイント</h2>
      </div>

      <div class="intro-text">
        <p>ブレークポイントを使うと、コードの特定の位置で実行を一時停止し、その時点での変数の値などを確認できます。console.log()よりも詳細なデバッグが可能です。</p>
      </div>

      <div class="subsection">
        <h3>ブレークポイントの設定方法</h3>

        <div class="step-list">
          <div class="step-item">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4>DevToolsを開く</h4>
              <p>F12キー（Macは Cmd + Option + I）を押してDevToolsを開きます。</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">2</div>
            <div class="step-content">
              <h4>Sourcesタブを選択</h4>
              <p>上部のタブから「Sources」を選択します。</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">3</div>
            <div class="step-content">
              <h4>ファイルを選択</h4>
              <p>左側のファイルツリーから、デバッグしたいJavaScriptファイルを選択します。</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">4</div>
            <div class="step-content">
              <h4>行番号をクリック</h4>
              <p>停止したい行の行番号をクリックすると、青いマーカーが表示されます。これがブレークポイントです。</p>
            </div>
          </div>
        </div>

        <!-- SVG DevTools イメージ -->
        <div class="demo-area" style="padding: 20px; overflow-x: auto;">
          <svg viewBox="0 0 700 300" style="min-width: 600px; width: 100%; height: auto;">
            <!-- DevToolsウィンドウ -->
            <rect x="20" y="20" width="660" height="260" rx="8" fill="#1e293b" stroke="#475569" stroke-width="2"/>

            <!-- タブバー -->
            <rect x="20" y="20" width="660" height="30" rx="8" fill="#334155"/>
            <text x="50" y="40" font-size="11" fill="#94a3b8">Elements</text>
            <text x="110" y="40" font-size="11" fill="#94a3b8">Console</text>
            <rect x="160" y="25" width="60" height="20" rx="2" fill="#3b82f6"/>
            <text x="175" y="40" font-size="11" fill="white">Sources</text>
            <text x="240" y="40" font-size="11" fill="#94a3b8">Network</text>

            <!-- ファイルツリー -->
            <rect x="30" y="60" width="150" height="210" rx="4" fill="#0f172a"/>
            <text x="40" y="80" font-size="10" fill="#64748b">Page</text>
            <text x="50" y="100" font-size="10" fill="#94a3b8">index.html</text>
            <text x="50" y="120" font-size="10" fill="#3b82f6">script.js</text>

            <!-- コードエリア -->
            <rect x="190" y="60" width="340" height="210" rx="4" fill="#0f172a"/>

            <!-- 行番号とコード -->
            <text x="200" y="85" font-size="10" fill="#475569">1</text>
            <text x="220" y="85" font-size="10" fill="#94a3b8">function calculate(a, b) {</text>

            <text x="200" y="105" font-size="10" fill="#475569">2</text>
            <text x="220" y="105" font-size="10" fill="#94a3b8">  const sum = a + b;</text>

            <!-- ブレークポイント行 -->
            <circle cx="204" cy="120" r="6" fill="#ef4444"/>
            <rect x="190" y="110" width="340" height="20" fill="rgba(239, 68, 68, 0.2)"/>
            <text x="200" y="125" font-size="10" fill="#f87171">3</text>
            <text x="220" y="125" font-size="10" fill="#f1f5f9">  console.log(sum);</text>

            <text x="200" y="145" font-size="10" fill="#475569">4</text>
            <text x="220" y="145" font-size="10" fill="#94a3b8">  return sum;</text>

            <text x="200" y="165" font-size="10" fill="#475569">5</text>
            <text x="220" y="165" font-size="10" fill="#94a3b8">}</text>

            <!-- 右側パネル -->
            <rect x="540" y="60" width="130" height="210" rx="4" fill="#0f172a"/>
            <text x="550" y="80" font-size="10" fill="#64748b">Scope</text>
            <text x="560" y="100" font-size="9" fill="#3b82f6">Local</text>
            <text x="570" y="115" font-size="9" fill="#94a3b8">a: 5</text>
            <text x="570" y="130" font-size="9" fill="#94a3b8">b: 3</text>
            <text x="570" y="145" font-size="9" fill="#94a3b8">sum: 8</text>

            <!-- 説明テキスト -->
            <text x="350" y="250" text-anchor="middle" font-size="11" fill="#22c55e">行番号をクリックしてブレークポイントを設定</text>
          </svg>
        </div>
      </div>

      <div class="subsection">
        <h3>条件付きブレークポイント</h3>
        <p>特定の条件を満たした場合のみ停止するブレークポイントを設定できます。</p>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">条件付きブレークポイントの設定</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">設定方法</span>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 例：以下のコードで i === 50 の時だけ停止したい</span>
<span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> < <span class="number">100</span>; <span class="variable">i</span>++) {
  <span class="method">processItem</span>(<span class="variable">i</span>);  <span class="comment">// ← この行を右クリック</span>
}

<span class="comment">// 手順：</span>
<span class="comment">// 1. 行番号を右クリック</span>
<span class="comment">// 2. "Add conditional breakpoint" を選択</span>
<span class="comment">// 3. 条件を入力: i === 50</span>
<span class="comment">// 4. Enterで確定</span></code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="info-box">
        <div class="info-box-title">ブレークポイントの種類</div>
        <div class="info-box-content">
          <ul>
            <li><strong>Line breakpoint</strong>：特定の行で停止</li>
            <li><strong>Conditional breakpoint</strong>：条件を満たした時のみ停止</li>
            <li><strong>Logpoint</strong>：停止せずにコンソールに出力</li>
            <li><strong>DOM breakpoint</strong>：DOM要素が変更された時に停止</li>
            <li><strong>Event listener breakpoint</strong>：特定のイベント発生時に停止</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Section B-4 ステップ実行 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section B-4</span>
        <h2 class="section-title">ステップ実行</h2>
      </div>

      <div class="intro-text">
        <p>ブレークポイントで停止した後、コードを1行ずつ実行しながら動作を確認できます。これをステップ実行と呼びます。</p>
      </div>

      <div class="subsection">
        <h3>ステップ実行のボタン</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>ボタン</th>
                <th>名前</th>
                <th>説明</th>
                <th>ショートカット</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="font-size: 20px;">&#9654;</td>
                <td>Resume</td>
                <td>実行を再開（次のブレークポイントまで）</td>
                <td>F8</td>
              </tr>
              <tr>
                <td style="font-size: 20px;">&#8631;</td>
                <td>Step over</td>
                <td>次の行へ（関数内部には入らない）</td>
                <td>F10</td>
              </tr>
              <tr>
                <td style="font-size: 20px;">&#8595;</td>
                <td>Step into</td>
                <td>関数の内部に入る</td>
                <td>F11</td>
              </tr>
              <tr>
                <td style="font-size: 20px;">&#8593;</td>
                <td>Step out</td>
                <td>現在の関数から抜ける</td>
                <td>Shift + F11</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="subsection">
        <h3>ステップ実行の使い分け</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">ステップ実行の例</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">function</span> <span class="method">calculateTotal</span>(<span class="variable">price</span>, <span class="variable">quantity</span>) {
  <span class="keyword">const</span> <span class="variable">subtotal</span> = <span class="variable">price</span> * <span class="variable">quantity</span>;      <span class="comment">// ← ブレークポイント</span>
  <span class="keyword">const</span> <span class="variable">tax</span> = <span class="method">calculateTax</span>(<span class="variable">subtotal</span>);   <span class="comment">// ← Step into で関数内部へ</span>
  <span class="keyword">const</span> <span class="variable">total</span> = <span class="variable">subtotal</span> + <span class="variable">tax</span>;          <span class="comment">// ← Step over で次の行へ</span>
  <span class="keyword">return</span> <span class="variable">total</span>;
}

<span class="keyword">function</span> <span class="method">calculateTax</span>(<span class="variable">amount</span>) {
  <span class="keyword">const</span> <span class="variable">taxRate</span> = <span class="number">0.1</span>;
  <span class="keyword">return</span> <span class="variable">amount</span> * <span class="variable">taxRate</span>;            <span class="comment">// ← Step out で呼び出し元へ戻る</span>
}

<span class="method">calculateTotal</span>(<span class="number">1000</span>, <span class="number">3</span>);</code></pre>
            </div>
          </div>
        </div>

        <div class="feature-list">
          <div class="feature-item">
            <div class="feature-icon">&#8631;</div>
            <div class="feature-content">
              <h4>Step over（F10）</h4>
              <p>関数呼び出しがあっても中には入らず、次の行に進みます。関数の内部動作に興味がない場合に使用します。</p>
            </div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">&#8595;</div>
            <div class="feature-content">
              <h4>Step into（F11）</h4>
              <p>関数呼び出しがあると、その関数の内部に入ります。関数の内部動作を確認したい場合に使用します。</p>
            </div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">&#8593;</div>
            <div class="feature-content">
              <h4>Step out（Shift + F11）</h4>
              <p>現在の関数の残りを実行し、呼び出し元に戻ります。関数の確認が終わって早く抜けたい場合に使用します。</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section B-5 Watch式の使い方 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section B-5</span>
        <h2 class="section-title">Watch式の使い方</h2>
      </div>

      <div class="intro-text">
        <p>Watch式を使うと、特定の変数や式の値をデバッグ中に常に監視できます。ステップ実行中に値がどう変化するかを追跡するのに便利です。</p>
      </div>

      <div class="subsection">
        <h3>Watch式の追加方法</h3>

        <div class="step-list">
          <div class="step-item">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4>Sourcesタブを開く</h4>
              <p>DevToolsのSourcesタブを開きます。</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">2</div>
            <div class="step-content">
              <h4>右側の「Watch」パネルを展開</h4>
              <p>右側のパネルにある「Watch」セクションを展開します。</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">3</div>
            <div class="step-content">
              <h4>「+」ボタンをクリック</h4>
              <p>Watchパネルの「+」ボタンをクリックして、監視したい式を入力します。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>Watch式の例</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">監視できる式の例</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">Watch式</span>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 変数の監視</span>
<span class="variable">userName</span>
<span class="variable">total</span>

<span class="comment">// オブジェクトのプロパティ</span>
<span class="variable">user</span>.<span class="variable">name</span>
<span class="variable">items</span>.<span class="variable">length</span>

<span class="comment">// 式の評価</span>
<span class="variable">price</span> * <span class="variable">quantity</span>
<span class="variable">total</span> + <span class="variable">tax</span>

<span class="comment">// 配列の特定要素</span>
<span class="variable">items</span>[<span class="number">0</span>]

<span class="comment">// 型の確認</span>
<span class="keyword">typeof</span> <span class="variable">value</span>

<span class="comment">// 条件式</span>
<span class="variable">age</span> >= <span class="number">18</span></code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="info-box">
        <div class="info-box-title">Scopeパネルも活用しよう</div>
        <div class="info-box-content">
          <p>Watchパネルの近くにある「Scope」パネルでは、現在のスコープにある全ての変数を確認できます。Local（ローカル変数）、Closure（クロージャ）、Global（グローバル変数）などに分類されて表示されます。</p>
        </div>
      </div>
    </section>

    <!-- Section B-6 Networkタブでの通信確認 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section B-6</span>
        <h2 class="section-title">Networkタブでの通信確認</h2>
      </div>

      <div class="intro-text">
        <p>Networkタブでは、ブラウザが行うすべてのネットワーク通信を確認できます。APIリクエストのデバッグや、リソースの読み込み状況の確認に使用します。</p>
      </div>

      <div class="subsection">
        <h3>Networkタブの基本</h3>

        <div class="feature-list">
          <div class="feature-item">
            <div class="feature-icon">&#128269;</div>
            <div class="feature-content">
              <h4>フィルター機能</h4>
              <p>All、Fetch/XHR、JS、CSS、Img などでリクエストをフィルタリングできます。APIリクエストを確認したい場合は「Fetch/XHR」を選択します。</p>
            </div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">&#128337;</div>
            <div class="feature-content">
              <h4>タイミング情報</h4>
              <p>各リクエストの所要時間やタイミングを確認できます。パフォーマンス問題の特定に役立ちます。</p>
            </div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">&#128221;</div>
            <div class="feature-content">
              <h4>リクエスト/レスポンス詳細</h4>
              <p>Headers、Payload、Preview、Response タブで詳細を確認できます。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>APIリクエストの確認</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>タブ</th>
                <th>確認できる内容</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Headers</strong></td>
                <td>リクエストヘッダー、レスポンスヘッダー、HTTPステータスコード</td>
              </tr>
              <tr>
                <td><strong>Payload</strong></td>
                <td>POSTリクエストで送信したデータ</td>
              </tr>
              <tr>
                <td><strong>Preview</strong></td>
                <td>レスポンスデータの整形表示（JSONなど）</td>
              </tr>
              <tr>
                <td><strong>Response</strong></td>
                <td>レスポンスの生データ</td>
              </tr>
              <tr>
                <td><strong>Timing</strong></td>
                <td>リクエストの詳細なタイミング情報</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="subsection">
        <h3>よくあるネットワークエラー</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">HTTPステータスコードとその意味</span>
          </div>
          <div class="demo-body">
            <div class="table-container" style="margin: 0;">
              <table>
                <thead>
                  <tr>
                    <th>ステータス</th>
                    <th>意味</th>
                    <th>よくある原因</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code style="color: #22c55e;">200</code></td>
                    <td>成功</td>
                    <td>正常なレスポンス</td>
                  </tr>
                  <tr>
                    <td><code style="color: #f97316;">400</code></td>
                    <td>Bad Request</td>
                    <td>リクエストの形式が不正</td>
                  </tr>
                  <tr>
                    <td><code style="color: #f97316;">401</code></td>
                    <td>Unauthorized</td>
                    <td>認証が必要、トークン切れ</td>
                  </tr>
                  <tr>
                    <td><code style="color: #f97316;">403</code></td>
                    <td>Forbidden</td>
                    <td>アクセス権限がない</td>
                  </tr>
                  <tr>
                    <td><code style="color: #ef4444;">404</code></td>
                    <td>Not Found</td>
                    <td>URLが間違っている</td>
                  </tr>
                  <tr>
                    <td><code style="color: #ef4444;">500</code></td>
                    <td>Internal Server Error</td>
                    <td>サーバー側のエラー</td>
                  </tr>
                  <tr>
                    <td><code style="color: #ef4444;">CORS error</code></td>
                    <td>クロスオリジンエラー</td>
                    <td>異なるドメインへのアクセス制限</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="info-box warning">
        <div class="info-box-title">CORSエラーについて</div>
        <div class="info-box-content">
          <p>CORSエラーは、セキュリティ上の理由で異なるドメイン間の通信が制限されている場合に発生します。このエラーが出た場合は、サーバー側でCORSの設定を行う必要があります。開発時は、プロキシサーバーを使用するなどの対策があります。</p>
        </div>
      </div>
    </section>

    <!-- Section B-7 よくあるバグパターンと解決法 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section B-7</span>
        <h2 class="section-title">よくあるバグパターンと解決法</h2>
      </div>

      <div class="intro-text">
        <p>プログラミングでは、似たようなバグパターンが繰り返し発生します。よくあるパターンを知っておくと、素早くバグを特定・修正できます。</p>
      </div>

      <div class="subsection">
        <h3>1. 非同期処理の罠</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">非同期処理のよくある間違い</span>
          </div>
          <div class="demo-body vertical">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">NG - バグのあるコード</span>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// データを取得してから処理したいが...</span>
<span class="keyword">let</span> <span class="variable">data</span>;

<span class="method">fetch</span>(<span class="string">'/api/users'</span>)
  .<span class="method">then</span>(<span class="variable">response</span> => <span class="variable">response</span>.<span class="method">json</span>())
  .<span class="method">then</span>(<span class="variable">json</span> => {
    <span class="variable">data</span> = <span class="variable">json</span>;
  });

<span class="comment">// ここはfetchの完了前に実行される！</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">data</span>);  <span class="comment">// undefined</span></code></pre>
            </div>
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">OK - 正しいコード</span>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// async/await を使用</span>
<span class="keyword">async</span> <span class="keyword">function</span> <span class="method">loadData</span>() {
  <span class="keyword">const</span> <span class="variable">response</span> = <span class="keyword">await</span> <span class="method">fetch</span>(<span class="string">'/api/users'</span>);
  <span class="keyword">const</span> <span class="variable">data</span> = <span class="keyword">await</span> <span class="variable">response</span>.<span class="method">json</span>();

  <span class="comment">// fetchの完了後に実行される</span>
  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">data</span>);  <span class="comment">// 正しいデータ</span>
}

<span class="method">loadData</span>();</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>2. thisの参照先問題</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">thisの問題</span>
          </div>
          <div class="demo-body vertical">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">NG - バグのあるコード</span>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">user</span> = {
  <span class="variable">name</span>: <span class="string">"田中"</span>,
  <span class="method">greet</span>: <span class="keyword">function</span>() {
    <span class="variable">setTimeout</span>(<span class="keyword">function</span>() {
      <span class="comment">// このthisはuserではなくwindow（またはundefined）</span>
      <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"こんにちは、"</span> + <span class="keyword">this</span>.<span class="variable">name</span>);
    }, <span class="number">1000</span>);
  }
};
<span class="variable">user</span>.<span class="method">greet</span>();  <span class="comment">// "こんにちは、undefined"</span></code></pre>
            </div>
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">OK - アロー関数で解決</span>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">user</span> = {
  <span class="variable">name</span>: <span class="string">"田中"</span>,
  <span class="method">greet</span>: <span class="keyword">function</span>() {
    <span class="comment">// アロー関数はthisを引き継ぐ</span>
    <span class="variable">setTimeout</span>(() => {
      <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"こんにちは、"</span> + <span class="keyword">this</span>.<span class="variable">name</span>);
    }, <span class="number">1000</span>);
  }
};
<span class="variable">user</span>.<span class="method">greet</span>();  <span class="comment">// "こんにちは、田中"</span></code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>3. 配列・オブジェクトの参照問題</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">参照のコピー問題</span>
          </div>
          <div class="demo-body vertical">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">NG - 意図しない変更</span>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">original</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];
<span class="keyword">const</span> <span class="variable">copy</span> = <span class="variable">original</span>;  <span class="comment">// 参照のコピー</span>

<span class="variable">copy</span>.<span class="method">push</span>(<span class="number">4</span>);

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">original</span>);  <span class="comment">// [1, 2, 3, 4] ← 変更されてしまう！</span></code></pre>
            </div>
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">OK - 正しいコピー</span>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">original</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];

<span class="comment">// スプレッド演算子でコピー</span>
<span class="keyword">const</span> <span class="variable">copy</span> = [...<span class="variable">original</span>];
<span class="variable">copy</span>.<span class="method">push</span>(<span class="number">4</span>);

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">original</span>);  <span class="comment">// [1, 2, 3] ← 変更されない</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">copy</span>);      <span class="comment">// [1, 2, 3, 4]</span>

<span class="comment">// オブジェクトの場合</span>
<span class="keyword">const</span> <span class="variable">originalObj</span> = { <span class="variable">a</span>: <span class="number">1</span>, <span class="variable">b</span>: <span class="number">2</span> };
<span class="keyword">const</span> <span class="variable">copyObj</span> = { ...<span class="variable">originalObj</span> };</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>4. DOM取得タイミングの問題</h3>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">DOM要素が取得できない</span>
          </div>
          <div class="demo-body vertical">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">NG - DOM構築前に実行</span>
              </div>
              <pre class="demo-code-content"><code><span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;script&gt;</span>
    <span class="comment">// HTMLがまだ読み込まれていない！</span>
    <span class="keyword">const</span> <span class="variable">btn</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'myBtn'</span>);
    <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">btn</span>);  <span class="comment">// null</span>
  <span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/head&gt;</span>
<span class="tag">&lt;body&gt;</span>
  <span class="tag">&lt;button id="myBtn"&gt;</span>Click<span class="tag">&lt;/button&gt;</span>
<span class="tag">&lt;/body&gt;</span></code></pre>
            </div>
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">OK - DOMContentLoaded を使用</span>
              </div>
              <pre class="demo-code-content"><code><span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;script&gt;</span>
    <span class="variable">document</span>.<span class="method">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, () => {
      <span class="comment">// DOM構築完了後に実行</span>
      <span class="keyword">const</span> <span class="variable">btn</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'myBtn'</span>);
      <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">btn</span>);  <span class="comment">// &lt;button id="myBtn"&gt;</span>
    });
  <span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/head&gt;</span>

<span class="comment">&lt;!-- または、bodyの最後にscriptを配置 --&gt;</span>
<span class="tag">&lt;body&gt;</span>
  <span class="tag">&lt;button id="myBtn"&gt;</span>Click<span class="tag">&lt;/button&gt;</span>
  <span class="tag">&lt;script src="script.js"&gt;&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span></code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="info-box success">
        <div class="info-box-title">デバッグのベストプラクティス</div>
        <div class="info-box-content">
          <ol>
            <li><strong>問題を再現する</strong>：バグを確実に再現できる手順を確認</li>
            <li><strong>範囲を絞る</strong>：コードを半分ずつ無効化して問題箇所を特定</li>
            <li><strong>仮説を立てて検証</strong>：「おそらくここが原因」と予想し、console.logやブレークポイントで確認</li>
            <li><strong>1つずつ変更</strong>：複数の修正を同時にしない。1つずつ試して効果を確認</li>
            <li><strong>休憩を取る</strong>：長時間悩んでも解決しない時は、一度離れると新しい視点が得られることも</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- コラム -->
    <div class="column">
      <div class="column-header">
        <span class="column-badge">コラム</span>
        <span class="column-title">ラバーダック・デバッギング</span>
      </div>
      <p>「ラバーダック・デバッギング」という手法があります。これは、問題を誰か（またはゴムのアヒルなど無生物）に説明することで、自分で解決策を見つけるという方法です。</p>
      <p>問題を言葉にして説明しようとすると、「あれ、ここってなんでこうなってるんだっけ？」と気づくことが多いのです。</p>
      <p>行き詰まったら、同僚やチャットボット、あるいは机の上のぬいぐるみに説明してみましょう。意外と解決の糸口が見つかるかもしれません。</p>
    </div>
  </div>

  <!-- ページナビゲーション -->
  <div class="page-nav">
    <a href="appendix-errors.html" class="page-nav-btn prev">
      <div class="page-nav-label">前へ</div>
      <div class="page-nav-title">よくあるエラー一覧</div>
    </a>
    <a href="appendix-resources.html" class="page-nav-btn next">
      <div class="page-nav-label">次へ</div>
      <div class="page-nav-title">学習リソース</div>
    </a>
  </div>

  <footer class="footer">
    <p>JavaScript入門 - 職業訓練校教材</p>
  </footer>

  <script src="../shared/demo.js"></script>
</body>
</html>
