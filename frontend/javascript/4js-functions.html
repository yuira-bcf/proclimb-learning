<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chapter 4: 関数 - JavaScript入門</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../shared/common.css">
  <style>
    :root {
      --primary: #007ACC;
      --primary-dark: #005A9E;
      --primary-light: #E8F4FD;
      --primary-lighter: #B3D7FF;
    }
    .nav-category-links { display: none; }
  </style>
</head>
<body>
  <nav class="global-nav"></nav>
  <script src="../../shared/js/nav-javascript.js"></script>

  <div class="container">
    <!-- チャプターヘッダー -->
    <header class="chapter-header">
      <div class="chapter-badge">Chapter</div>
      <div class="chapter-number">4</div>
      <h1 class="chapter-title">関数</h1>
      <p class="chapter-subtitle">処理をまとめて再利用しよう</p>
    </header>

    <!-- 目次 -->
    <nav class="toc">
      <h2 class="toc-title">この章の内容</h2>
      <ul class="toc-list">
        <li class="toc-item"><span class="toc-number">4-1</span>function宣言と関数式</li>
        <li class="toc-item"><span class="toc-number">4-2</span>アロー関数</li>
        <li class="toc-item"><span class="toc-number">4-3</span>引数（パラメータ）</li>
        <li class="toc-item"><span class="toc-number">4-4</span>戻り値と早期リターン</li>
        <li class="toc-item"><span class="toc-number">4-5</span>コールバック関数</li>
        <li class="toc-item"><span class="toc-number">4-6</span>スコープとクロージャ</li>
        <li class="toc-item"><span class="toc-number">4-7</span>実習：カラーピッカー</li>
        <li class="toc-item"><span class="toc-number">練習</span>練習問題</li>
      </ul>
    </nav>

    <!-- Section 4-1 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 4-1</span>
        <h2 class="section-title">function宣言と関数式</h2>
      </div>

      <div class="intro-text">
        <p>関数は、一連の処理をまとめて名前を付けたものです。同じ処理を何度も書く代わりに、関数として定義することでコードの再利用性が高まります。</p>
      </div>

      <div class="subsection">
        <h3>function宣言</h3>
        <p>最も基本的な関数の定義方法です。<code>function</code>キーワードを使って関数を宣言します。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
function宣言による関数定義と呼び出し

## 実装要件
- 引数なしの`greet`関数を作成
  - 「こんにちは！」と表示
  - 複数回呼び出して動作確認
- 引数ありの`greetUser`関数を作成
  - 引数`name`を受け取る
  - 「こんにちは、○○さん！」と表示

## 使用する構文
- `function`キーワード
- 関数呼び出し（`関数名()`）
- テンプレートリテラル
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">function宣言の基本</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 関数の宣言</span>
<span class="keyword">function</span> <span class="method">greet</span>() {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"こんにちは！"</span>);
}

<span class="comment">// 関数の呼び出し</span>
<span class="method">greet</span>();  <span class="comment">// "こんにちは！"</span>
<span class="method">greet</span>();  <span class="comment">// "こんにちは！"（何度でも呼べる）</span>

<span class="comment">// 引数を受け取る関数</span>
<span class="keyword">function</span> <span class="method">greetUser</span>(<span class="variable">name</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`こんにちは、${<span class="variable">name</span>}さん！`</span>);
}

<span class="method">greetUser</span>(<span class="string">"田中"</span>);  <span class="comment">// "こんにちは、田中さん！"</span>
<span class="method">greetUser</span>(<span class="string">"山田"</span>);  <span class="comment">// "こんにちは、山田さん！"</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>関数宣言（function宣言）</h4>
              <div class="syntax-pattern">function 関数名(引数1, 引数2) {
  処理;
  return 戻り値;
}</div>
              <p>functionキーワードで関数を定義します。ホイスティングにより、宣言より前のコードからでも呼び出せます。処理をまとめて再利用可能にし、コードの見通しを良くします。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>関数式</h3>
        <p>関数を変数に代入する方法です。関数を値として扱えます。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
関数式（無名関数を変数に代入）による関数定義

## 実装要件
- 引数なしの`greet`関数を関数式で作成
  - 「こんにちは！」と表示
- 引数ありの`add`関数を関数式で作成
  - 2つの数値`a`、`b`を受け取る
  - 合計を`return`で返す

## 使用する構文
- `const 変数名 = function() { }`
- `return`文
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">関数式</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 関数式（無名関数を変数に代入）</span>
<span class="keyword">const</span> <span class="variable">greet</span> = <span class="keyword">function</span>() {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"こんにちは！"</span>);
};

<span class="variable">greet</span>();  <span class="comment">// "こんにちは！"</span>

<span class="comment">// 引数付きの関数式</span>
<span class="keyword">const</span> <span class="variable">add</span> = <span class="keyword">function</span>(<span class="variable">a</span>, <span class="variable">b</span>) {
  <span class="keyword">return</span> <span class="variable">a</span> + <span class="variable">b</span>;
};

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">add</span>(<span class="number">3</span>, <span class="number">5</span>));  <span class="comment">// 8</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>ホイスティング（巻き上げ）</h3>
        <p>function宣言はホイスティングにより、宣言前でも呼び出すことができます。一方、関数式はホイスティングされません。</p>

        <!-- SVGホイスティング図解 -->
        <div class="demo-area" style="padding: 20px; overflow-x: auto;">
          <svg viewBox="0 0 700 250" style="min-width: 600px; width: 100%; height: auto;">
            <!-- function宣言 -->
            <rect x="30" y="30" width="300" height="200" rx="12" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
            <text x="180" y="60" text-anchor="middle" font-size="14" font-weight="bold" fill="#166534">function宣言</text>

            <text x="50" y="95" font-size="12" fill="#166534">greet();  // OK! 呼び出せる</text>
            <text x="50" y="120" font-size="12" fill="#64748b">// ...他のコード...</text>
            <text x="50" y="150" font-size="12" fill="#166534">function greet() { }</text>

            <text x="50" y="190" font-size="11" fill="#166534">ホイスティングにより</text>
            <text x="50" y="210" font-size="11" fill="#166534">宣言前でも呼び出せる</text>

            <!-- 関数式 -->
            <rect x="370" y="30" width="300" height="200" rx="12" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
            <text x="520" y="60" text-anchor="middle" font-size="14" font-weight="bold" fill="#991b1b">関数式</text>

            <text x="390" y="95" font-size="12" fill="#991b1b">greet();  // エラー!</text>
            <text x="390" y="120" font-size="12" fill="#64748b">// ...他のコード...</text>
            <text x="390" y="150" font-size="12" fill="#991b1b">const greet = function() { }</text>

            <text x="390" y="190" font-size="11" fill="#991b1b">定義後でないと</text>
            <text x="390" y="210" font-size="11" fill="#991b1b">呼び出せない</text>
          </svg>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
ホイスティング（巻き上げ）の動作確認

## 実装要件
- function宣言の例：
  - 宣言前に`sayHello()`を呼び出し（成功する）
  - その後に`function sayHello() { }`を定義
- 関数式の例：
  - 宣言前に呼び出すとエラーになることをコメントで示す
  - `const sayGoodbye = function() { }`を定義

## 使用する構文
- `function`宣言
- 関数式（`const 変数名 = function() { }`）
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">ホイスティングの例</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// function宣言は宣言前に呼び出せる（ホイスティング）</span>
<span class="method">sayHello</span>();  <span class="comment">// "Hello!" - OK!</span>

<span class="keyword">function</span> <span class="method">sayHello</span>() {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"Hello!"</span>);
}

<span class="comment">// 関数式は宣言前に呼び出せない</span>
<span class="comment">// sayGoodbye();  // エラー: Cannot access before initialization</span>

<span class="keyword">const</span> <span class="variable">sayGoodbye</span> = <span class="keyword">function</span>() {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"Goodbye!"</span>);
};

<span class="variable">sayGoodbye</span>();  <span class="comment">// "Goodbye!" - OK</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">どちらを使うべき？</div>
          <div class="info-box-content">
            <p>現代のJavaScript開発では、<strong>関数式（特にアロー関数）</strong>を使うことが多いです。ホイスティングに頼らず、コードの上から順に読めるようになるため、可読性が向上します。</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4-2 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 4-2</span>
        <h2 class="section-title">アロー関数</h2>
      </div>

      <div class="intro-text">
        <p>アロー関数（Arrow Function）はES6で導入された、より簡潔な関数の書き方です。<code>=></code>（矢印）を使って定義します。</p>
      </div>

      <div class="subsection">
        <h3>アロー関数の構文</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
アロー関数の3つの記述パターン比較

## 実装要件
- 2つの数値を足し算する関数を3パターンで作成：
  1. 従来の関数式（`function(a, b) { return a + b; }`）
  2. アロー関数の基本形（`(a, b) => { return a + b; }`）
  3. 省略形（`(a, b) => a + b`）
- 各関数を呼び出して結果を確認

## 使用する構文
- 関数式
- アロー関数（`=>`）
- 暗黙のreturn（波括弧なしの場合）
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">アロー関数の基本</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 従来の関数式</span>
<span class="keyword">const</span> <span class="variable">add1</span> = <span class="keyword">function</span>(<span class="variable">a</span>, <span class="variable">b</span>) {
  <span class="keyword">return</span> <span class="variable">a</span> + <span class="variable">b</span>;
};

<span class="comment">// アロー関数（基本形）</span>
<span class="keyword">const</span> <span class="variable">add2</span> = (<span class="variable">a</span>, <span class="variable">b</span>) => {
  <span class="keyword">return</span> <span class="variable">a</span> + <span class="variable">b</span>;
};

<span class="comment">// アロー関数（省略形）- 1行で完結する場合</span>
<span class="keyword">const</span> <span class="variable">add3</span> = (<span class="variable">a</span>, <span class="variable">b</span>) => <span class="variable">a</span> + <span class="variable">b</span>;

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">add1</span>(<span class="number">2</span>, <span class="number">3</span>));  <span class="comment">// 5</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">add2</span>(<span class="number">2</span>, <span class="number">3</span>));  <span class="comment">// 5</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">add3</span>(<span class="number">2</span>, <span class="number">3</span>));  <span class="comment">// 5</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>関数式</h4>
              <div class="syntax-pattern">const 変数名 = function(引数) {
  処理
};</div>
              <p>関数を変数に代入する方法です。ホイスティングされないため、定義後にのみ呼び出せます。関数を値として扱えるため、コールバックなどで使用されます。</p>
            </div>
            <div class="syntax-item">
              <h4>アロー関数</h4>
              <div class="syntax-pattern">const 変数名 = (引数) => { 処理 };

// 1行の場合（省略形）
(引数) => 式</div>
              <p>ES6で導入された簡潔な関数の書き方です。1行で完結する場合は波括弧とreturnを省略できます。引数が1つの場合は括弧も省略可能です。thisを持たない特性があります。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>省略記法のパターン</h3>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>パターン</th>
                <th>構文</th>
                <th>例</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>引数なし</td>
                <td><code>() => 処理</code></td>
                <td><code>() => console.log("Hi")</code></td>
              </tr>
              <tr>
                <td>引数1つ</td>
                <td><code>x => 処理</code></td>
                <td><code>x => x * 2</code></td>
              </tr>
              <tr>
                <td>引数複数</td>
                <td><code>(x, y) => 処理</code></td>
                <td><code>(a, b) => a + b</code></td>
              </tr>
              <tr>
                <td>複数行</td>
                <td><code>() => { 処理; return 値; }</code></td>
                <td><code>(x) => { const y = x * 2; return y; }</code></td>
              </tr>
              <tr>
                <td>オブジェクト返却</td>
                <td><code>() => ({ key: value })</code></td>
                <td><code>() => ({ name: "太郎" })</code></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
アロー関数の省略記法パターン

## 実装要件
- 引数1つの場合：括弧を省略可能
  - 例：`x => x * 2`
- 引数なしの場合：括弧は必須
  - 例：`() => "Hello"`
- 複数行の処理：波括弧と`return`が必要
  - 例：`(a, b) => { const sum = a + b; return sum; }`
- オブジェクトを返す場合：括弧で囲む
  - 例：`(name) => ({ name: name, age: 20 })`

## 使用する構文
- アロー関数の各省略形
- オブジェクトリテラル
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">省略記法の例</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 引数が1つの場合、()を省略可能</span>
<span class="keyword">const</span> <span class="variable">double</span> = <span class="variable">x</span> => <span class="variable">x</span> * <span class="number">2</span>;
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">double</span>(<span class="number">5</span>));  <span class="comment">// 10</span>

<span class="comment">// 引数がない場合、()は必須</span>
<span class="keyword">const</span> <span class="variable">getTime</span> = () => <span class="keyword">new</span> <span class="variable">Date</span>().<span class="method">toLocaleTimeString</span>();
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">getTime</span>());  <span class="comment">// "14:30:45"</span>

<span class="comment">// 複数行の処理</span>
<span class="keyword">const</span> <span class="variable">greet</span> = (<span class="variable">name</span>) => {
  <span class="keyword">const</span> <span class="variable">greeting</span> = <span class="string">`こんにちは、${<span class="variable">name</span>}さん`</span>;
  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">greeting</span>);
  <span class="keyword">return</span> <span class="variable">greeting</span>;
};

<span class="comment">// オブジェクトを返す場合は()で囲む</span>
<span class="keyword">const</span> <span class="variable">createUser</span> = (<span class="variable">name</span>, <span class="variable">age</span>) => ({ <span class="variable">name</span>, <span class="variable">age</span> });
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">createUser</span>(<span class="string">"田中"</span>, <span class="number">25</span>));  <span class="comment">// {name: "田中", age: 25}</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>アロー関数と this</h3>
        <p>アロー関数は自身の<code>this</code>を持たず、外側のスコープの<code>this</code>を継承します。これが従来の関数との大きな違いです。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
アロー関数と従来関数の`this`の違い

## 実装要件
- オブジェクト内に2つのメソッドを定義：
  1. 従来の関数：`this`がオブジェクト自身を指す
  2. アロー関数：`this`が外側のスコープを継承
- `this.name`を参照して違いを確認
- `setTimeout`内での`this`の挙動も比較

## 使用する構文
- オブジェクトリテラル
- メソッド定義（従来関数/アロー関数）
- `this`キーワード
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">thisの違い</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">obj</span> = {
  <span class="variable">name</span>: <span class="string">"テストオブジェクト"</span>,

  <span class="comment">// 従来の関数 - thisはobjを指す</span>
  <span class="method">regularFunc</span>: <span class="keyword">function</span>() {
    <span class="variable">console</span>.<span class="method">log</span>(<span class="keyword">this</span>.<span class="variable">name</span>);  <span class="comment">// "テストオブジェクト"</span>
  },

  <span class="comment">// アロー関数 - thisは外側（グローバル）を指す</span>
  <span class="variable">arrowFunc</span>: () => {
    <span class="variable">console</span>.<span class="method">log</span>(<span class="keyword">this</span>.<span class="variable">name</span>);  <span class="comment">// undefined（グローバル）</span>
  },

  <span class="comment">// メソッド内でのコールバックにはアロー関数が便利</span>
  <span class="method">delayedGreet</span>: <span class="keyword">function</span>() {
    <span class="comment">// アロー関数なので外側のthis（obj）を継承</span>
    <span class="method">setTimeout</span>(() => {
      <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`Hello from ${<span class="keyword">this</span>.<span class="variable">name</span>}`</span>);
    }, <span class="number">1000</span>);
  }
};

<span class="variable">obj</span>.<span class="method">regularFunc</span>();    <span class="comment">// "テストオブジェクト"</span>
<span class="variable">obj</span>.<span class="method">arrowFunc</span>();      <span class="comment">// undefined</span>
<span class="variable">obj</span>.<span class="method">delayedGreet</span>();   <span class="comment">// 1秒後に "Hello from テストオブジェクト"</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="info-box warning">
          <div class="info-box-title">アロー関数を使わない方が良い場面</div>
          <div class="info-box-content">
            <ul>
              <li><strong>オブジェクトのメソッド</strong>: thisがオブジェクトを指さなくなる</li>
              <li><strong>コンストラクタ関数</strong>: newで呼び出せない</li>
              <li><strong>arguments</strong>が必要な場合: アロー関数にはargumentsがない</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4-3 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 4-3</span>
        <h2 class="section-title">引数（パラメータ）</h2>
      </div>

      <div class="intro-text">
        <p>関数に渡す値を<strong>引数（ひきすう）</strong>または<strong>パラメータ</strong>と呼びます。引数を使うことで、関数を柔軟に動作させることができます。</p>
      </div>

      <div class="subsection">
        <h3>デフォルト引数</h3>
        <p>ES6から、引数にデフォルト値を設定できるようになりました。引数が渡されなかった場合にデフォルト値が使用されます。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
デフォルト引数の設定

## 実装要件
- `greet`関数を作成：
  - `name`のデフォルト値を「ゲスト」に設定
  - `greeting`のデフォルト値を「こんにちは」に設定
  - 「○○、△△さん！」と表示
- アロー関数`multiply`を作成：
  - `b`のデフォルト値を1に設定
  - `a * b`を返す

## 使用する構文
- デフォルト引数（`引数名 = デフォルト値`）
- function宣言/アロー関数
- テンプレートリテラル
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">デフォルト引数</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// デフォルト引数を設定</span>
<span class="keyword">function</span> <span class="method">greet</span>(<span class="variable">name</span> = <span class="string">"ゲスト"</span>, <span class="variable">greeting</span> = <span class="string">"こんにちは"</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`${<span class="variable">greeting</span>}、${<span class="variable">name</span>}さん！`</span>);
}

<span class="method">greet</span>();                        <span class="comment">// "こんにちは、ゲストさん！"</span>
<span class="method">greet</span>(<span class="string">"田中"</span>);                   <span class="comment">// "こんにちは、田中さん！"</span>
<span class="method">greet</span>(<span class="string">"山田"</span>, <span class="string">"おはよう"</span>);       <span class="comment">// "おはよう、山田さん！"</span>

<span class="comment">// アロー関数でも同様</span>
<span class="keyword">const</span> <span class="variable">multiply</span> = (<span class="variable">a</span>, <span class="variable">b</span> = <span class="number">1</span>) => <span class="variable">a</span> * <span class="variable">b</span>;

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">multiply</span>(<span class="number">5</span>));      <span class="comment">// 5（5 * 1）</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">multiply</span>(<span class="number">5</span>, <span class="number">3</span>));   <span class="comment">// 15（5 * 3）</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>引数（パラメータ）</h4>
              <div class="syntax-pattern">function 関数名(引数1, 引数2) { }</div>
              <p>関数に渡す値を引数と呼びます。関数内で変数として使用でき、呼び出し側から柔軟に値を渡せます。</p>
            </div>
            <div class="syntax-item">
              <h4>デフォルト引数</h4>
              <div class="syntax-pattern">function 関数名(引数 = デフォルト値) { }</div>
              <p>引数が渡されなかった場合に使用される既定値を設定できます。ES6で導入された機能で、オプショナルな引数を簡潔に扱えます。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>可変長引数（Rest Parameters）</h3>
        <p><code>...</code>（スプレッド構文）を使うと、任意の数の引数を配列として受け取れます。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
可変長引数（Rest Parameters）の使用

## 実装要件
- `sum`関数を作成：
  - `...numbers`で任意の数の引数を受け取る
  - `reduce()`で合計を計算して返す
- `introduce`関数を作成：
  - 最初の引数は`name`
  - 残りは`...hobbies`で趣味の配列として受け取る
  - 名前と趣味一覧を表示

## 使用する構文
- Rest Parameters（`...引数名`）
- `reduce()`メソッド
- `join()`メソッド
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">可変長引数</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 可変長引数（Rest Parameters）</span>
<span class="keyword">function</span> <span class="method">sum</span>(...<span class="variable">numbers</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">numbers</span>);  <span class="comment">// 配列として受け取る</span>
  <span class="keyword">return</span> <span class="variable">numbers</span>.<span class="method">reduce</span>((<span class="variable">total</span>, <span class="variable">num</span>) => <span class="variable">total</span> + <span class="variable">num</span>, <span class="number">0</span>);
}

<span class="variable">console</span>.<span class="method">log</span>(<span class="method">sum</span>(<span class="number">1</span>, <span class="number">2</span>));              <span class="comment">// 3</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="method">sum</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>));     <span class="comment">// 15</span>

<span class="comment">// 最初の引数は別で受け取り、残りを配列に</span>
<span class="keyword">function</span> <span class="method">introduce</span>(<span class="variable">name</span>, ...<span class="variable">hobbies</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`${<span class="variable">name</span>}の趣味: ${<span class="variable">hobbies</span>.<span class="method">join</span>(<span class="string">', '</span>)}`</span>);
}

<span class="method">introduce</span>(<span class="string">"田中"</span>, <span class="string">"読書"</span>, <span class="string">"映画"</span>, <span class="string">"旅行"</span>);
<span class="comment">// "田中の趣味: 読書, 映画, 旅行"</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>分割代入と引数</h3>
        <p>オブジェクトや配列を引数で受け取る際、分割代入を使うと便利です。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
引数での分割代入（オブジェクト/配列）

## 実装要件
- `printUser`関数を作成：
  - オブジェクトを引数として受け取る
  - `{ name, age, city }`を分割代入で取り出す
  - 各プロパティを表示
- `getFirstTwo`関数を作成：
  - 配列を引数として受け取る
  - `[first, second]`を分割代入で取り出す
  - 先頭2要素を返す

## 使用する構文
- オブジェクトの分割代入（`{ }`）
- 配列の分割代入（`[ ]`）
- `return`文
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">分割代入</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// オブジェクトの分割代入</span>
<span class="keyword">function</span> <span class="method">printUser</span>({ <span class="variable">name</span>, <span class="variable">age</span>, <span class="variable">city</span> = <span class="string">"不明"</span> }) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`${<span class="variable">name</span>}（${<span class="variable">age</span>}歳）- ${<span class="variable">city</span>}`</span>);
}

<span class="keyword">const</span> <span class="variable">user</span> = { <span class="variable">name</span>: <span class="string">"田中"</span>, <span class="variable">age</span>: <span class="number">25</span>, <span class="variable">city</span>: <span class="string">"東京"</span> };
<span class="method">printUser</span>(<span class="variable">user</span>);  <span class="comment">// "田中（25歳）- 東京"</span>

<span class="comment">// 配列の分割代入</span>
<span class="keyword">const</span> <span class="variable">getFirstTwo</span> = ([<span class="variable">first</span>, <span class="variable">second</span>]) => {
  <span class="keyword">return</span> { <span class="variable">first</span>, <span class="variable">second</span> };
};

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">getFirstTwo</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]));  <span class="comment">// {first: 1, second: 2}</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4-4 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 4-4</span>
        <h2 class="section-title">戻り値と早期リターン</h2>
      </div>

      <div class="intro-text">
        <p><code>return</code>文を使うと、関数から値を返すことができます。戻り値を使うことで、関数の結果を他の処理で活用できます。</p>
      </div>

      <div class="subsection">
        <h3>return文の基本</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
return文による戻り値の活用

## 実装要件
- `calculateTax`関数を作成：
  - 引数：`price`（価格）、`taxRate`（税率、デフォルト0.1）
  - 税額を計算して`return`で返す
- 戻り値の使用例：
  - 変数に代入して利用
  - 直接計算式で使用
- `return`がない場合の挙動：
  - `undefined`が返ることを確認

## 使用する構文
- `return`文
- デフォルト引数
- 算術演算子
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">戻り値の基本</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 戻り値のある関数</span>
<span class="keyword">function</span> <span class="method">calculateTax</span>(<span class="variable">price</span>, <span class="variable">taxRate</span> = <span class="number">0.1</span>) {
  <span class="keyword">const</span> <span class="variable">tax</span> = <span class="variable">price</span> * <span class="variable">taxRate</span>;
  <span class="keyword">return</span> <span class="variable">tax</span>;
}

<span class="keyword">const</span> <span class="variable">tax</span> = <span class="method">calculateTax</span>(<span class="number">1000</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">tax</span>);  <span class="comment">// 100</span>

<span class="comment">// 戻り値を直接使う</span>
<span class="keyword">const</span> <span class="variable">totalPrice</span> = <span class="number">1000</span> + <span class="method">calculateTax</span>(<span class="number">1000</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">totalPrice</span>);  <span class="comment">// 1100</span>

<span class="comment">// 戻り値がない場合はundefined</span>
<span class="keyword">function</span> <span class="method">printMessage</span>(<span class="variable">msg</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">msg</span>);
  <span class="comment">// return がないので undefined を返す</span>
}

<span class="keyword">const</span> <span class="variable">result</span> = <span class="method">printMessage</span>(<span class="string">"Hello"</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">result</span>);  <span class="comment">// undefined</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>return文</h4>
              <div class="syntax-pattern">return 値;</div>
              <p>関数から値を返し、関数の実行を終了します。returnがない、または値を指定しない場合はundefinedが返されます。戻り値は変数に代入したり、直接使用できます。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>早期リターン（Early Return）</h3>
        <p>条件を満たさない場合に早めにreturnすることで、ネストを減らして読みやすいコードを書けます。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
早期リターン（Early Return）パターン

## 実装要件
- 悪い例（ネストが深い）：
  - `if`文のネストで条件をチェック
  - 読みにくいコードを示す
- 良い例（早期リターン）：
  - 条件を満たさない場合は早く`return`
  - ネストを浅くして読みやすく
- 実践例（入力検証）：
  - `null`/`undefined`チェック
  - 型チェック
  - 範囲チェック

## 使用する構文
- `if`文と早期`return`
- 比較演算子
- `typeof`演算子
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">早期リターンのパターン</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 悪い例：ネストが深い</span>
<span class="keyword">function</span> <span class="method">processUserBad</span>(<span class="variable">user</span>) {
  <span class="keyword">if</span> (<span class="variable">user</span>) {
    <span class="keyword">if</span> (<span class="variable">user</span>.<span class="variable">age</span> >= <span class="number">18</span>) {
      <span class="keyword">if</span> (<span class="variable">user</span>.<span class="variable">isActive</span>) {
        <span class="comment">// 処理...</span>
        <span class="keyword">return</span> <span class="string">"処理完了"</span>;
      }
    }
  }
  <span class="keyword">return</span> <span class="string">"処理できません"</span>;
}

<span class="comment">// 良い例：早期リターン</span>
<span class="keyword">function</span> <span class="method">processUserGood</span>(<span class="variable">user</span>) {
  <span class="keyword">if</span> (!<span class="variable">user</span>) <span class="keyword">return</span> <span class="string">"ユーザーがいません"</span>;
  <span class="keyword">if</span> (<span class="variable">user</span>.<span class="variable">age</span> < <span class="number">18</span>) <span class="keyword">return</span> <span class="string">"年齢制限"</span>;
  <span class="keyword">if</span> (!<span class="variable">user</span>.<span class="variable">isActive</span>) <span class="keyword">return</span> <span class="string">"非アクティブ"</span>;

  <span class="comment">// メインの処理（条件をすべてクリア）</span>
  <span class="keyword">return</span> <span class="string">"処理完了"</span>;
}

<span class="comment">// 実践例：入力検証</span>
<span class="keyword">function</span> <span class="method">validateEmail</span>(<span class="variable">email</span>) {
  <span class="keyword">if</span> (!<span class="variable">email</span>) <span class="keyword">return</span> { <span class="variable">valid</span>: <span class="keyword">false</span>, <span class="variable">error</span>: <span class="string">"メールアドレスを入力してください"</span> };
  <span class="keyword">if</span> (!<span class="variable">email</span>.<span class="method">includes</span>(<span class="string">"@"</span>)) <span class="keyword">return</span> { <span class="variable">valid</span>: <span class="keyword">false</span>, <span class="variable">error</span>: <span class="string">"@を含めてください"</span> };
  <span class="keyword">if</span> (<span class="variable">email</span>.<span class="variable">length</span> < <span class="number">5</span>) <span class="keyword">return</span> { <span class="variable">valid</span>: <span class="keyword">false</span>, <span class="variable">error</span>: <span class="string">"短すぎます"</span> };

  <span class="keyword">return</span> { <span class="variable">valid</span>: <span class="keyword">true</span>, <span class="variable">error</span>: <span class="keyword">null</span> };
}</pre>
              </div>
            </div>
          </div>
        </div>

        <div class="info-box success">
          <div class="info-box-title">早期リターンのメリット</div>
          <div class="info-box-content">
            <ul>
              <li>ネストが浅くなり、コードが読みやすくなる</li>
              <li>異常系を先に処理し、正常系に集中できる</li>
              <li>条件の確認漏れが減る</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4-5 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 4-5</span>
        <h2 class="section-title">コールバック関数</h2>
      </div>

      <div class="intro-text">
        <p>コールバック関数は、他の関数に引数として渡される関数です。配列のメソッドや非同期処理でよく使われます。</p>
      </div>

      <div class="subsection">
        <h3>コールバック関数の基本</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
コールバック関数の基本

## 実装要件
- `executeCallback`関数を作成：
  - 引数`callback`で関数を受け取る
  - 「処理を開始します」と表示
  - `callback()`を実行
  - 「処理を終了しました」と表示
- 呼び出し例：
  - 無名関数をコールバックとして渡す
  - アロー関数をコールバックとして渡す

## 使用する構文
- 高階関数（関数を引数に取る）
- コールバック関数の呼び出し
- 無名関数、アロー関数
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">コールバックの基本</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// コールバック関数を受け取る関数</span>
<span class="keyword">function</span> <span class="method">executeCallback</span>(<span class="variable">callback</span>) {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"処理を開始します"</span>);
  <span class="variable">callback</span>();  <span class="comment">// コールバック関数を実行</span>
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"処理が完了しました"</span>);
}

<span class="comment">// 関数を渡す</span>
<span class="method">executeCallback</span>(<span class="keyword">function</span>() {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"コールバック実行！"</span>);
});

<span class="comment">// アロー関数で渡す</span>
<span class="method">executeCallback</span>(() => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"アロー関数のコールバック！"</span>);
});

<span class="comment">// 結果:</span>
<span class="comment">// "処理を開始します"</span>
<span class="comment">// "コールバック実行！"</span>
<span class="comment">// "処理が完了しました"</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>コールバック関数</h4>
              <div class="syntax-pattern">関数(コールバック関数) / 関数(() => { 処理 })</div>
              <p>他の関数に引数として渡される関数です。配列メソッド（forEach, map, filter）やイベント処理、非同期処理などで広く使われます。処理のタイミングや順序を柔軟に制御できます。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>forEach / map / filter</h3>
        <p>配列の操作でコールバック関数が活躍します。これらは配列操作の基本となる重要なメソッドです。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
forEachメソッドによる配列のループ処理

## 実装要件
- 果物の配列`["りんご", "バナナ", "みかん"]`を作成
- `forEach()`でループ処理：
  - コールバックはアロー関数で記述
  - 引数：`fruit`（要素）、`index`（インデックス）
  - 「インデックス: 要素名」の形式で出力

## 使用する構文
- `配列.forEach()`
- アロー関数（コールバック）
- テンプレートリテラル
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">forEach - 各要素に処理を実行</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">fruits</span> = [<span class="string">"りんご"</span>, <span class="string">"バナナ"</span>, <span class="string">"みかん"</span>];

<span class="comment">// forEach: 各要素に対して処理を実行（戻り値なし）</span>
<span class="variable">fruits</span>.<span class="method">forEach</span>((<span class="variable">fruit</span>, <span class="variable">index</span>) => {
  <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`${<span class="variable">index</span>}: ${<span class="variable">fruit</span>}`</span>);
});
<span class="comment">// 0: りんご</span>
<span class="comment">// 1: バナナ</span>
<span class="comment">// 2: みかん</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
mapメソッドによる配列の変換

## 実装要件
- 数値配列の変換：
  - `[1, 2, 3, 4, 5]`を各要素2倍に変換
  - 結果：`[2, 4, 6, 8, 10]`
- オブジェクト配列への変換：
  - 名前の配列`["田中", "山田", "佐藤"]`
  - `{ id: インデックス, name: 名前 }`の配列に変換

## 使用する構文
- `配列.map()`
- アロー関数（コールバック）
- オブジェクトリテラル
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">map - 各要素を変換して新しい配列を作成</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">numbers</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];

<span class="comment">// map: 各要素を変換した新しい配列を返す</span>
<span class="keyword">const</span> <span class="variable">doubled</span> = <span class="variable">numbers</span>.<span class="method">map</span>(<span class="variable">num</span> => <span class="variable">num</span> * <span class="number">2</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">doubled</span>);  <span class="comment">// [2, 4, 6, 8, 10]</span>

<span class="comment">// オブジェクトへの変換</span>
<span class="keyword">const</span> <span class="variable">names</span> = [<span class="string">"田中"</span>, <span class="string">"山田"</span>, <span class="string">"鈴木"</span>];
<span class="keyword">const</span> <span class="variable">users</span> = <span class="variable">names</span>.<span class="method">map</span>((<span class="variable">name</span>, <span class="variable">i</span>) => ({
  <span class="variable">id</span>: <span class="variable">i</span> + <span class="number">1</span>,
  <span class="variable">name</span>: <span class="variable">name</span>
}));
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">users</span>);
<span class="comment">// [{id: 1, name: "田中"}, {id: 2, name: "山田"}, {id: 3, name: "鈴木"}]</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
filterメソッドによる配列の絞り込み

## 実装要件
- 偶数の抽出：
  - `[1, 2, 3, 4, 5, 6]`から偶数のみ抽出
  - 条件：`num % 2 === 0`
- 商品の絞り込み：
  - 商品オブジェクトの配列を用意
  - 価格が200円以下のものを抽出
  - 条件：`product.price <= 200`

## 使用する構文
- `配列.filter()`
- アロー関数（条件を返す）
- 剰余演算子（`%`）
- 比較演算子
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">filter - 条件に合う要素だけを抽出</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">numbers</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];

<span class="comment">// filter: 条件を満たす要素だけの配列を返す</span>
<span class="keyword">const</span> <span class="variable">evens</span> = <span class="variable">numbers</span>.<span class="method">filter</span>(<span class="variable">num</span> => <span class="variable">num</span> % <span class="number">2</span> === <span class="number">0</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">evens</span>);  <span class="comment">// [2, 4, 6, 8, 10]</span>

<span class="comment">// オブジェクト配列のフィルタリング</span>
<span class="keyword">const</span> <span class="variable">products</span> = [
  { <span class="variable">name</span>: <span class="string">"りんご"</span>, <span class="variable">price</span>: <span class="number">150</span> },
  { <span class="variable">name</span>: <span class="string">"バナナ"</span>, <span class="variable">price</span>: <span class="number">100</span> },
  { <span class="variable">name</span>: <span class="string">"メロン"</span>, <span class="variable">price</span>: <span class="number">1500</span> },
  { <span class="variable">name</span>: <span class="string">"いちご"</span>, <span class="variable">price</span>: <span class="number">300</span> }
];

<span class="keyword">const</span> <span class="variable">affordable</span> = <span class="variable">products</span>.<span class="method">filter</span>(<span class="variable">p</span> => <span class="variable">p</span>.<span class="variable">price</span> <= <span class="number">200</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">affordable</span>);
<span class="comment">// [{name: "りんご", price: 150}, {name: "バナナ", price: 100}]</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
配列メソッドのチェーン（メソッドチェーン）

## 実装要件
- 商品オブジェクトの配列を用意：
  - `{ name, price, inStock }`の形式
- メソッドチェーンで処理：
  1. `filter()`：在庫あり（`inStock === true`）を抽出
  2. `filter()`：500円未満（`price < 500`）を抽出
  3. `map()`：商品名だけの配列に変換

## 使用する構文
- `filter().filter().map()`のチェーン
- アロー関数
- オブジェクトプロパティアクセス
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">メソッドチェーン</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="keyword">const</span> <span class="variable">products</span> = [
  { <span class="variable">name</span>: <span class="string">"りんご"</span>, <span class="variable">price</span>: <span class="number">150</span>, <span class="variable">inStock</span>: <span class="keyword">true</span> },
  { <span class="variable">name</span>: <span class="string">"バナナ"</span>, <span class="variable">price</span>: <span class="number">100</span>, <span class="variable">inStock</span>: <span class="keyword">false</span> },
  { <span class="variable">name</span>: <span class="string">"メロン"</span>, <span class="variable">price</span>: <span class="number">1500</span>, <span class="variable">inStock</span>: <span class="keyword">true</span> },
  { <span class="variable">name</span>: <span class="string">"いちご"</span>, <span class="variable">price</span>: <span class="number">300</span>, <span class="variable">inStock</span>: <span class="keyword">true</span> }
];

<span class="comment">// 在庫ありの商品の名前リストを取得</span>
<span class="keyword">const</span> <span class="variable">availableNames</span> = <span class="variable">products</span>
  .<span class="method">filter</span>(<span class="variable">p</span> => <span class="variable">p</span>.<span class="variable">inStock</span>)           <span class="comment">// 在庫あり</span>
  .<span class="method">filter</span>(<span class="variable">p</span> => <span class="variable">p</span>.<span class="variable">price</span> < <span class="number">500</span>)        <span class="comment">// 500円未満</span>
  .<span class="method">map</span>(<span class="variable">p</span> => <span class="variable">p</span>.<span class="variable">name</span>);                   <span class="comment">// 名前だけ抽出</span>

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">availableNames</span>);  <span class="comment">// ["りんご", "いちご"]</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4-6 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 4-6</span>
        <h2 class="section-title">スコープとクロージャ</h2>
      </div>

      <div class="intro-text">
        <p>スコープは変数が参照できる範囲のことです。クロージャは、関数が外側のスコープの変数を「記憶」する仕組みです。</p>
      </div>

      <div class="subsection">
        <h3>スコープの種類</h3>

        <!-- SVGスコープ図解 -->
        <div class="demo-area" style="padding: 20px; overflow-x: auto;">
          <svg viewBox="0 0 700 320" style="min-width: 600px; width: 100%; height: auto;">
            <!-- グローバルスコープ -->
            <rect x="20" y="20" width="660" height="280" rx="12" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
            <text x="40" y="50" font-size="14" font-weight="bold" fill="#1e40af">グローバルスコープ</text>
            <text x="40" y="75" font-size="12" fill="#1e40af" font-family="monospace">const globalVar = "全体で使える";</text>

            <!-- 関数スコープ -->
            <rect x="50" y="95" width="290" height="185" rx="10" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
            <text x="70" y="125" font-size="13" font-weight="bold" fill="#166534">関数スコープ</text>
            <text x="70" y="150" font-size="11" fill="#166534" font-family="monospace">function outer() {</text>
            <text x="85" y="170" font-size="11" fill="#166534" font-family="monospace">let funcVar = "関数内";</text>

            <!-- ブロックスコープ -->
            <rect x="80" y="185" width="230" height="75" rx="8" fill="#fef9c3" stroke="#eab308" stroke-width="2"/>
            <text x="100" y="210" font-size="12" font-weight="bold" fill="#854d0e">ブロックスコープ { }</text>
            <text x="100" y="235" font-size="10" fill="#854d0e" font-family="monospace">let blockVar = "ブロック内";</text>

            <!-- クロージャ説明 -->
            <rect x="370" y="95" width="290" height="185" rx="10" fill="#fce7f3" stroke="#ec4899" stroke-width="2"/>
            <text x="390" y="125" font-size="13" font-weight="bold" fill="#9d174d">クロージャ</text>
            <text x="390" y="155" font-size="10" fill="#9d174d" font-family="monospace">function outer() {</text>
            <text x="405" y="175" font-size="10" fill="#9d174d" font-family="monospace">let count = 0;</text>
            <text x="405" y="195" font-size="10" fill="#9d174d" font-family="monospace">return function() {</text>
            <text x="420" y="215" font-size="10" fill="#9d174d" font-family="monospace">return ++count;</text>
            <text x="405" y="235" font-size="10" fill="#9d174d" font-family="monospace">};</text>
            <text x="390" y="255" font-size="10" fill="#9d174d" font-family="monospace">}</text>
            <text x="390" y="275" font-size="10" fill="#9d174d">内部関数がcountを「記憶」</text>
          </svg>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
スコープ（変数の有効範囲）の理解

## 実装要件
- グローバルスコープ：
  - ファイルの最上位で変数`globalVar`を定義
  - どこからでもアクセス可能
- 関数スコープ：
  - 関数内で変数`functionVar`を定義
  - 関数外からはアクセス不可
- ブロックスコープ：
  - `if`ブロック内で`let`/`const`で変数を定義
  - ブロック外からはアクセス不可

## 使用する構文
- `var`（関数スコープ）
- `let`、`const`（ブロックスコープ）
- 関数定義
- `if`ブロック
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">スコープの例</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// グローバルスコープ</span>
<span class="keyword">const</span> <span class="variable">globalVar</span> = <span class="string">"グローバル"</span>;

<span class="keyword">function</span> <span class="method">outer</span>() {
  <span class="comment">// 関数スコープ</span>
  <span class="keyword">const</span> <span class="variable">outerVar</span> = <span class="string">"外側の関数"</span>;

  <span class="keyword">if</span> (<span class="keyword">true</span>) {
    <span class="comment">// ブロックスコープ</span>
    <span class="keyword">const</span> <span class="variable">blockVar</span> = <span class="string">"ブロック内"</span>;
    <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">globalVar</span>);  <span class="comment">// OK: グローバル</span>
    <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">outerVar</span>);   <span class="comment">// OK: 外側の関数</span>
    <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">blockVar</span>);   <span class="comment">// OK: ブロック内</span>
  }

  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">globalVar</span>);  <span class="comment">// OK</span>
  <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">outerVar</span>);   <span class="comment">// OK</span>
  <span class="comment">// console.log(blockVar);  // エラー: 未定義</span>
}

<span class="method">outer</span>();
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">globalVar</span>);  <span class="comment">// OK</span>
<span class="comment">// console.log(outerVar);  // エラー: 未定義</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="syntax-box">
          <div class="syntax-box-header">
            <span class="syntax-box-icon"><span class="material-icons">menu_book</span></span>
            <span class="syntax-box-title">構文説明</span>
          </div>
          <div class="syntax-box-content">
            <div class="syntax-item">
              <h4>グローバルスコープ</h4>
              <div class="syntax-pattern">const グローバル変数 = 値; // ファイルの最上位で宣言</div>
              <p>ファイルのどこからでもアクセスできる変数です。便利ですが、名前の衝突や予期しない変更のリスクがあるため、使用は最小限にすべきです。</p>
            </div>
            <div class="syntax-item">
              <h4>ローカルスコープ（関数/ブロック）</h4>
              <div class="syntax-pattern">function fn() {
  const ローカル変数 = 値;
}</div>
              <p>関数やブロック{}内で宣言された変数は、その範囲内でのみ有効です。外部からアクセスできないため、変数の衝突を防ぎ、コードの安全性が向上します。</p>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3>クロージャ</h3>
        <p>クロージャは、関数が作成された時点の外側のスコープを「閉じ込める」（クローズする）仕組みです。</p>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
クロージャの基本（状態の保持）

## 実装要件
- `createCounter`関数を作成：
  - 内部変数`count`を0で初期化
  - `count`をインクリメントして返す関数を`return`
- クロージャの動作確認：
  - 呼び出すたびにカウントが増加
  - 複数のカウンターが独立して動作
  - `counter1`と`counter2`で別々のカウントを保持

## 使用する構文
- 関数を返す関数（高階関数）
- クロージャ（外側スコープの変数を保持）
- `let`変数
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">クロージャの例</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// クロージャの基本</span>
<span class="keyword">function</span> <span class="method">createCounter</span>() {
  <span class="keyword">let</span> <span class="variable">count</span> = <span class="number">0</span>;  <span class="comment">// プライベートな変数</span>

  <span class="keyword">return</span> <span class="keyword">function</span>() {
    <span class="variable">count</span>++;
    <span class="keyword">return</span> <span class="variable">count</span>;
  };
}

<span class="keyword">const</span> <span class="variable">counter1</span> = <span class="method">createCounter</span>();
<span class="keyword">const</span> <span class="variable">counter2</span> = <span class="method">createCounter</span>();

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">counter1</span>());  <span class="comment">// 1</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">counter1</span>());  <span class="comment">// 2</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">counter1</span>());  <span class="comment">// 3</span>

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">counter2</span>());  <span class="comment">// 1（別のカウンター）</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">counter2</span>());  <span class="comment">// 2</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
クロージャの実践的活用（設定保持・プライベート変数）

## 実装要件
- `createGreeter`関数を作成：
  - `greeting`を引数で受け取り保持
  - `name`を受け取って挨拶を返す関数を`return`
- `createBankAccount`関数を作成：
  - プライベート変数`balance`を保持
  - 以下のメソッドを持つオブジェクトを`return`：
    - `deposit(amount)`：入金
    - `withdraw(amount)`：出金
    - `getBalance()`：残高照会

## 使用する構文
- クロージャによる状態カプセル化
- オブジェクトを返す関数
- メソッド定義
- `console.log()`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">クロージャの実践例</span>
          </div>
          <div class="demo-body">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="comment">// 設定を保持する関数を作成</span>
<span class="keyword">function</span> <span class="method">createGreeter</span>(<span class="variable">greeting</span>) {
  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="variable">name</span>) {
    <span class="keyword">return</span> <span class="string">`${<span class="variable">greeting</span>}, ${<span class="variable">name</span>}さん！`</span>;
  };
}

<span class="keyword">const</span> <span class="variable">sayHello</span> = <span class="method">createGreeter</span>(<span class="string">"こんにちは"</span>);
<span class="keyword">const</span> <span class="variable">sayGoodbye</span> = <span class="method">createGreeter</span>(<span class="string">"さようなら"</span>);

<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">sayHello</span>(<span class="string">"田中"</span>));    <span class="comment">// "こんにちは、田中さん！"</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">sayGoodbye</span>(<span class="string">"山田"</span>));  <span class="comment">// "さようなら、山田さん！"</span>

<span class="comment">// 複数の操作を持つクロージャ</span>
<span class="keyword">function</span> <span class="method">createBankAccount</span>(<span class="variable">initialBalance</span>) {
  <span class="keyword">let</span> <span class="variable">balance</span> = <span class="variable">initialBalance</span>;

  <span class="keyword">return</span> {
    <span class="method">deposit</span>: (<span class="variable">amount</span>) => {
      <span class="variable">balance</span> += <span class="variable">amount</span>;
      <span class="keyword">return</span> <span class="variable">balance</span>;
    },
    <span class="method">withdraw</span>: (<span class="variable">amount</span>) => {
      <span class="keyword">if</span> (<span class="variable">amount</span> > <span class="variable">balance</span>) <span class="keyword">return</span> <span class="string">"残高不足"</span>;
      <span class="variable">balance</span> -= <span class="variable">amount</span>;
      <span class="keyword">return</span> <span class="variable">balance</span>;
    },
    <span class="method">getBalance</span>: () => <span class="variable">balance</span>
  };
}

<span class="keyword">const</span> <span class="variable">account</span> = <span class="method">createBankAccount</span>(<span class="number">1000</span>);
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">account</span>.<span class="method">deposit</span>(<span class="number">500</span>));   <span class="comment">// 1500</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">account</span>.<span class="method">withdraw</span>(<span class="number">200</span>));  <span class="comment">// 1300</span>
<span class="variable">console</span>.<span class="method">log</span>(<span class="variable">account</span>.<span class="method">getBalance</span>());  <span class="comment">// 1300</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">クロージャの活用場面</div>
          <div class="info-box-content">
            <ul>
              <li><strong>データの隠蔽</strong>: 外部からアクセスできないプライベート変数を作成</li>
              <li><strong>状態の保持</strong>: 関数呼び出し間で値を保持</li>
              <li><strong>関数ファクトリ</strong>: 設定を持った関数を生成</li>
              <li><strong>イベントハンドラ</strong>: 特定の値を覚えたハンドラを作成</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4-7 実習 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 4-7</span>
        <h2 class="section-title">実習：カラーピッカー</h2>
      </div>

      <div class="intro-text">
        <p>この章で学んだ関数の知識を使って、HEX/RGB変換ができるカラーピッカーを作成しましょう。選択した色で背景色を変更する機能も実装します。</p>
      </div>

      <div class="subsection">
        <h3>完成イメージ</h3>
        <div class="demo-area" style="padding: 20px;">
          <div id="color-picker-demo" style="max-width: 400px; margin: 0 auto; background: #1e293b; padding: 25px; border-radius: 16px;">
            <h3 style="color: white; text-align: center; margin-bottom: 20px;">Color Picker</h3>

            <div style="display: flex; gap: 15px; margin-bottom: 20px;">
              <div style="flex: 1;">
                <input type="color" id="demo-color-input" value="#3b82f6" style="width: 100%; height: 60px; border: none; border-radius: 8px; cursor: pointer;">
              </div>
              <div id="demo-color-preview" style="flex: 1; background: #3b82f6; border-radius: 8px;"></div>
            </div>

            <div style="background: #334155; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span style="color: #94a3b8; font-size: 14px;">HEX</span>
                <span id="demo-hex-value" style="color: white; font-family: monospace;">#3b82f6</span>
              </div>
              <div style="display: flex; justify-content: space-between;">
                <span style="color: #94a3b8; font-size: 14px;">RGB</span>
                <span id="demo-rgb-value" style="color: white; font-family: monospace;">rgb(59, 130, 246)</span>
              </div>
            </div>

            <button id="demo-apply-btn" style="width: 100%; padding: 12px; background: #3b82f6; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">背景に適用</button>
          </div>
        </div>

        <script>
          (function() {
            const colorInput = document.getElementById('demo-color-input');
            const preview = document.getElementById('demo-color-preview');
            const hexValue = document.getElementById('demo-hex-value');
            const rgbValue = document.getElementById('demo-rgb-value');
            const applyBtn = document.getElementById('demo-apply-btn');

            const hexToRgb = (hex) => {
              const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
              return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
              } : null;
            };

            const updateColor = (hex) => {
              preview.style.background = hex;
              hexValue.textContent = hex.toUpperCase();
              const rgb = hexToRgb(hex);
              if (rgb) {
                rgbValue.textContent = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
              }
              applyBtn.style.background = hex;
            };

            colorInput.addEventListener('input', (e) => updateColor(e.target.value));
            applyBtn.addEventListener('click', () => {
              document.body.style.background = colorInput.value;
            });
          })();
        </script>
      </div>

      <div class="subsection">
        <h3>実装コード</h3>

        <div class="prompt-box">
          <div class="prompt-box-header">
            <span class="prompt-box-icon"><span class="material-icons">chat</span></span>
            <span class="prompt-box-title">プロンプト</span>
            <button class="prompt-copy-btn">コピー</button>
          </div>
          <div class="prompt-box-content">
            <pre>## 機能
カラーピッカーアプリの作成

## 実装要件
- UI構成：
  - `input type="color"`で色を選択
  - HEX値とRGB値を表示
  - クリップボードにコピーするボタン
  - 背景色に適用するボタン
- 関数をアロー関数で定義：
  - `hexToRgb(hex)`：HEXをRGB配列に変換
  - `rgbToHex(r, g, b)`：RGBをHEXに変換
- 分割代入でRGB値を取り出す

## 使用する構文
- アロー関数
- `parseInt()`（16進数→10進数）
- `toString(16)`（10進数→16進数）
- 分割代入
- `navigator.clipboard.writeText()`
- `document.body.style.backgroundColor`</pre>
            </div>
          </div>
        </div>

        <div class="demo-container">
          <div class="demo-header">
            <span class="demo-title">color-picker.html</span>
          </div>
          <div class="demo-body vertical">
            <div class="demo-code-section">
              <div class="demo-code-header">
                <span class="demo-code-lang">HTML + JavaScript</span>
                <button class="demo-copy-btn">コピー</button>
              </div>
              <pre class="demo-code-content"><code><span class="tag">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attr">lang</span>=<span class="value">"ja"</span><span class="tag">&gt;</span>
<span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attr">charset</span>=<span class="value">"UTF-8"</span><span class="tag">&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attr">name</span>=<span class="value">"viewport"</span> <span class="attr">content</span>=<span class="value">"width=device-width, initial-scale=1.0"</span><span class:="tag">&gt;</span>
  <span class="tag">&lt;title&gt;</span>カラーピッカー<span class="tag">&lt;/title&gt;</span>
  <span class="tag">&lt;style&gt;</span>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #f0f0f0;
      font-family: sans-serif;
      transition: background 0.3s ease;
    }
    .color-picker {
      background: #1e293b;
      padding: 25px;
      border-radius: 16px;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    }
    .title { color: white; text-align: center; margin-bottom: 20px; }
    .color-input-area { display: flex; gap: 15px; margin-bottom: 20px; }
    .color-input {
      flex: 1;
      height: 60px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .color-preview { flex: 1; border-radius: 8px; transition: background 0.2s; }
    .color-info { background: #334155; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
    .color-row { display: flex; justify-content: space-between; margin-bottom: 8px; }
    .color-row:last-child { margin-bottom: 0; }
    .color-label { color: #94a3b8; font-size: 14px; }
    .color-value { color: white; font-family: monospace; cursor: pointer; }
    .color-value:hover { color: #60a5fa; }
    .apply-btn {
      width: 100%;
      padding: 12px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: transform 0.1s, opacity 0.1s;
    }
    .apply-btn:hover { opacity: 0.9; }
    .apply-btn:active { transform: scale(0.98); }
    .copied { position: fixed; top: 20px; right: 20px; background: #22c55e;
              color: white; padding: 10px 20px; border-radius: 8px; display: none; }
  <span class="tag">&lt;/style&gt;</span>
<span class="tag">&lt;/head&gt;</span>
<span class="tag">&lt;body&gt;</span>
  <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"color-picker"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;h2</span> <span class="attr">class</span>=<span class="value">"title"</span><span class="tag">&gt;</span>Color Picker<span class="tag">&lt;/h2&gt;</span>

    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"color-input-area"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"color"</span> <span class="attr">id</span>=<span class="value">"colorInput"</span> <span class="attr">value</span>=<span class="value">"#3b82f6"</span> <span class="attr">class</span>=<span class="value">"color-input"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">id</span>=<span class="value">"preview"</span> <span class="attr">class</span>=<span class="value">"color-preview"</span><span class="tag">&gt;&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"color-info"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"color-row"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="value">"color-label"</span><span class="tag">&gt;</span>HEX<span class="tag">&lt;/span&gt;</span>
        <span class="tag">&lt;span</span> <span class="attr">id</span>=<span class="value">"hexValue"</span> <span class="attr">class</span>=<span class="value">"color-value"</span><span class="tag">&gt;</span>#3B82F6<span class="tag">&lt;/span&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"color-row"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="value">"color-label"</span><span class="tag">&gt;</span>RGB<span class="tag">&lt;/span&gt;</span>
        <span class="tag">&lt;span</span> <span class="attr">id</span>=<span class="value">"rgbValue"</span> <span class="attr">class</span>=<span class="value">"color-value"</span><span class="tag">&gt;</span>rgb(59, 130, 246)<span class="tag">&lt;/span&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

    <span class="tag">&lt;button</span> <span class="attr">id</span>=<span class="value">"applyBtn"</span> <span class="attr">class</span>=<span class="value">"apply-btn"</span><span class="tag">&gt;</span>背景に適用<span class="tag">&lt;/button&gt;</span>
  <span class="tag">&lt;/div&gt;</span>

  <span class="tag">&lt;div</span> <span class="attr">id</span>=<span class="value">"copied"</span> <span class="attr">class</span>=<span class="value">"copied"</span><span class="tag">&gt;</span>コピーしました！<span class="tag">&lt;/div&gt;</span>

  <span class="tag">&lt;script&gt;</span>
    <span class="comment">// =====================================</span>
    <span class="comment">// HEX to RGB 変換関数</span>
    <span class="comment">// =====================================</span>
    <span class="keyword">const</span> <span class="variable">hexToRgb</span> = (<span class="variable">hex</span>) => {
      <span class="comment">// 正規表現でHEX値を分解</span>
      <span class="keyword">const</span> <span class="variable">result</span> = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.<span class="method">exec</span>(<span class="variable">hex</span>);
      <span class="keyword">if</span> (!<span class="variable">result</span>) <span class="keyword">return</span> <span class="keyword">null</span>;

      <span class="comment">// 16進数を10進数に変換</span>
      <span class="keyword">return</span> {
        <span class="variable">r</span>: <span class="method">parseInt</span>(<span class="variable">result</span>[<span class="number">1</span>], <span class="number">16</span>),
        <span class="variable">g</span>: <span class="method">parseInt</span>(<span class="variable">result</span>[<span class="number">2</span>], <span class="number">16</span>),
        <span class="variable">b</span>: <span class="method">parseInt</span>(<span class="variable">result</span>[<span class="number">3</span>], <span class="number">16</span>)
      };
    };

    <span class="comment">// =====================================</span>
    <span class="comment">// RGB to HEX 変換関数</span>
    <span class="comment">// =====================================</span>
    <span class="keyword">const</span> <span class="variable">rgbToHex</span> = (<span class="variable">r</span>, <span class="variable">g</span>, <span class="variable">b</span>) => {
      <span class="comment">// 各値を16進数に変換し、2桁にパディング</span>
      <span class="keyword">const</span> <span class="variable">toHex</span> = (<span class="variable">n</span>) => <span class="variable">n</span>.<span class="method">toString</span>(<span class="number">16</span>).<span class="method">padStart</span>(<span class="number">2</span>, <span class="string">'0'</span>);
      <span class="keyword">return</span> <span class="string">`#${<span class="variable">toHex</span>(<span class="variable">r</span>)}${<span class="variable">toHex</span>(<span class="variable">g</span>)}${<span class="variable">toHex</span>(<span class="variable">b</span>)}`</span>;
    };

    <span class="comment">// =====================================</span>
    <span class="comment">// RGB文字列生成関数</span>
    <span class="comment">// =====================================</span>
    <span class="keyword">const</span> <span class="variable">formatRgb</span> = ({ <span class="variable">r</span>, <span class="variable">g</span>, <span class="variable">b</span> }) => <span class="string">`rgb(${<span class="variable">r</span>}, ${<span class="variable">g</span>}, ${<span class="variable">b</span>})`</span>;

    <span class="comment">// =====================================</span>
    <span class="comment">// DOM要素の取得</span>
    <span class="comment">// =====================================</span>
    <span class="keyword">const</span> <span class="variable">colorInput</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'colorInput'</span>);
    <span class="keyword">const</span> <span class="variable">preview</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'preview'</span>);
    <span class="keyword">const</span> <span class="variable">hexValue</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'hexValue'</span>);
    <span class="keyword">const</span> <span class="variable">rgbValue</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'rgbValue'</span>);
    <span class="keyword">const</span> <span class="variable">applyBtn</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'applyBtn'</span>);
    <span class="keyword">const</span> <span class="variable">copied</span> = <span class="variable">document</span>.<span class="method">getElementById</span>(<span class="string">'copied'</span>);

    <span class="comment">// =====================================</span>
    <span class="comment">// 色の表示を更新する関数</span>
    <span class="comment">// =====================================</span>
    <span class="keyword">const</span> <span class="variable">updateColor</span> = (<span class="variable">hex</span>) => {
      <span class="comment">// プレビューとボタンの色を更新</span>
      <span class="variable">preview</span>.<span class="variable">style</span>.<span class="variable">background</span> = <span class="variable">hex</span>;
      <span class="variable">applyBtn</span>.<span class="variable">style</span>.<span class="variable">background</span> = <span class="variable">hex</span>;

      <span class="comment">// HEX値を表示（大文字に変換）</span>
      <span class="variable">hexValue</span>.<span class="variable">textContent</span> = <span class="variable">hex</span>.<span class="method">toUpperCase</span>();

      <span class="comment">// RGB値を計算して表示</span>
      <span class="keyword">const</span> <span class="variable">rgb</span> = <span class="variable">hexToRgb</span>(<span class="variable">hex</span>);
      <span class="keyword">if</span> (<span class="variable">rgb</span>) {
        <span class="variable">rgbValue</span>.<span class="variable">textContent</span> = <span class="variable">formatRgb</span>(<span class="variable">rgb</span>);
      }
    };

    <span class="comment">// =====================================</span>
    <span class="comment">// クリップボードにコピーする関数</span>
    <span class="comment">// =====================================</span>
    <span class="keyword">const</span> <span class="variable">copyToClipboard</span> = (<span class="variable">text</span>) => {
      <span class="variable">navigator</span>.<span class="variable">clipboard</span>.<span class="method">writeText</span>(<span class="variable">text</span>).<span class="method">then</span>(() => {
        <span class="variable">copied</span>.<span class="variable">style</span>.<span class="variable">display</span> = <span class="string">'block'</span>;
        <span class="method">setTimeout</span>(() => {
          <span class="variable">copied</span>.<span class="variable">style</span>.<span class="variable">display</span> = <span class="string">'none'</span>;
        }, <span class="number">2000</span>);
      });
    };

    <span class="comment">// =====================================</span>
    <span class="comment">// イベントリスナーの設定</span>
    <span class="comment">// =====================================</span>

    <span class="comment">// カラー入力が変更されたとき</span>
    <span class="variable">colorInput</span>.<span class="method">addEventListener</span>(<span class="string">'input'</span>, (<span class="variable">e</span>) => {
      <span class="variable">updateColor</span>(<span class="variable">e</span>.<span class="variable">target</span>.<span class="variable">value</span>);
    });

    <span class="comment">// HEX値クリックでコピー</span>
    <span class="variable">hexValue</span>.<span class="method">addEventListener</span>(<span class="string">'click'</span>, () => {
      <span class="variable">copyToClipboard</span>(<span class="variable">hexValue</span>.<span class="variable">textContent</span>);
    });

    <span class="comment">// RGB値クリックでコピー</span>
    <span class="variable">rgbValue</span>.<span class="method">addEventListener</span>(<span class="string">'click'</span>, () => {
      <span class="variable">copyToClipboard</span>(<span class="variable">rgbValue</span>.<span class="variable">textContent</span>);
    });

    <span class="comment">// 背景に適用ボタン</span>
    <span class="variable">applyBtn</span>.<span class="method">addEventListener</span>(<span class="string">'click'</span>, () => {
      <span class="variable">document</span>.<span class="variable">body</span>.<span class="variable">style</span>.<span class="variable">background</span> = <span class="variable">colorInput</span>.<span class="variable">value</span>;
    });

    <span class="comment">// 初期表示</span>
    <span class="variable">updateColor</span>(<span class="variable">colorInput</span>.<span class="variable">value</span>);
  <span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">学習ポイント</div>
          <div class="info-box-content">
            <ul>
              <li><strong>アロー関数</strong>: <code>hexToRgb</code>, <code>rgbToHex</code>, <code>formatRgb</code> をアロー関数で定義</li>
              <li><strong>分割代入</strong>: <code>{ r, g, b }</code> でオブジェクトから値を取り出し</li>
              <li><strong>テンプレートリテラル</strong>: RGB文字列の生成に使用</li>
              <li><strong>正規表現</strong>: HEX値の解析に使用</li>
              <li><strong>コールバック関数</strong>: <code>addEventListener</code> で使用</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- 練習問題 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">練習問題</span>
        <h2 class="section-title">Chapter 4 練習問題</h2>
      </div>

      <div class="exercise-list">
        <div class="exercise-item">
          <div class="exercise-number">Q1</div>
          <div class="exercise-content">
            <p>2つの数値を受け取り、大きい方を返す関数 <code>max</code> をアロー関数で作成してください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q2</div>
          <div class="exercise-content">
            <p>配列を受け取り、すべての数値を2倍にした新しい配列を返す関数 <code>doubleAll</code> を <code>map</code> を使って作成してください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q3</div>
          <div class="exercise-content">
            <p>数値の配列を受け取り、偶数だけを抽出した配列を返す関数 <code>filterEvens</code> を <code>filter</code> を使って作成してください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q4</div>
          <div class="exercise-content">
            <p>カウンターを作成するクロージャ <code>createCounter</code> を作成してください。<code>increment()</code>、<code>decrement()</code>、<code>getValue()</code> の3つのメソッドを持つオブジェクトを返すようにしてください。</p>
          </div>
        </div>

        <div class="exercise-item">
          <div class="exercise-number">Q5</div>
          <div class="exercise-content">
            <p>以下の関数を早期リターンを使ってリファクタリングしてください。</p>
            <div class="code-block">
              <div class="code-content">
<pre>function checkAge(age) {
  if (age !== null && age !== undefined) {
    if (typeof age === 'number') {
      if (age >= 0) {
        if (age >= 20) {
          return '成人です';
        } else {
          return '未成年です';
        }
      } else {
        return '不正な年齢です';
      }
    } else {
      return '数値を入力してください';
    }
  } else {
    return '年齢を入力してください';
  }
}</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 解答 -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">解答</span>
        <h2 class="section-title">練習問題の解答</h2>
      </div>

      <div class="answer-list">
        <div class="answer-item">
          <div class="answer-header">Q1の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>const max = (a, b) => a > b ? a : b;

// または
const max = (a, b) => Math.max(a, b);

console.log(max(5, 3));  // 5
console.log(max(2, 8));  // 8</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q2の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>const doubleAll = (arr) => arr.map(num => num * 2);

console.log(doubleAll([1, 2, 3, 4, 5]));  // [2, 4, 6, 8, 10]</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q3の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>const filterEvens = (arr) => arr.filter(num => num % 2 === 0);

console.log(filterEvens([1, 2, 3, 4, 5, 6]));  // [2, 4, 6]</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q4の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>function createCounter(initialValue = 0) {
  let count = initialValue;

  return {
    increment: () => ++count,
    decrement: () => --count,
    getValue: () => count
  };
}

const counter = createCounter(10);
console.log(counter.getValue());   // 10
console.log(counter.increment());  // 11
console.log(counter.increment());  // 12
console.log(counter.decrement());  // 11</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="answer-item">
          <div class="answer-header">Q5の解答</div>
          <div class="answer-content">
            <div class="code-block">
              <div class="code-content">
<pre>function checkAge(age) {
  if (age === null || age === undefined) return '年齢を入力してください';
  if (typeof age !== 'number') return '数値を入力してください';
  if (age < 0) return '不正な年齢です';

  return age >= 20 ? '成人です' : '未成年です';
}</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- コラム -->
    <div class="column">
      <div class="column-header">
        <span class="column-badge">コラム</span>
        <span class="column-title">純粋関数とは</span>
      </div>
      <p><strong>純粋関数（Pure Function）</strong>とは、以下の2つの条件を満たす関数のことです。</p>
      <ol>
        <li><strong>同じ入力に対して常に同じ出力を返す</strong>（決定的）</li>
        <li><strong>副作用がない</strong>（外部の状態を変更しない）</li>
      </ol>
      <p>純粋関数はテストしやすく、予測可能な動作をするため、バグが少なくなります。例えば、<code>Math.max(3, 5)</code> は常に <code>5</code> を返し、外部に影響を与えません。</p>
      <p>一方、<code>console.log()</code> や <code>document.getElementById()</code> は副作用があるため、純粋関数ではありません。関数型プログラミングでは、できるだけ純粋関数を使うことが推奨されています。</p>
    </div>
  </div>

  <!-- ページナビゲーション -->
  <div class="page-nav">
    <a href="3js-control-flow.html" class="page-nav-btn prev">
      <div class="page-nav-label">前へ</div>
      <div class="page-nav-title">条件分岐と繰り返し</div>
    </a>
    <a href="5js-dom.html" class="page-nav-btn next">
      <div class="page-nav-label">次へ</div>
      <div class="page-nav-title">DOM操作</div>
    </a>
  </div>

  <footer class="footer">
    <p>JavaScript入門 - 職業訓練校教材</p>
  </footer>

  <script src="../../shared/demo.js"></script>
</body>
</html>
