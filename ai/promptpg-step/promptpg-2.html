<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chapter 2: 画面作成（リンク遷移） - プロンプトプログラミング</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="../../shared/common.css">
  <style>
    :root {
      --primary: #AF52DE;
      --primary-dark: #9333EA;
      --primary-light: #FAF5FF;
      --primary-lighter: #E9D5FF;
    }
    .nav-category-links { display: none; }
    .prompt-card { background: linear-gradient(135deg, #4285F4 0%, #9B72CB 50%, #D96570 100%); border-radius: 16px; padding: 24px; color: white; margin: 24px 0; }
    .prompt-card h4 { margin: 0 0 16px 0; font-size: 1.1rem; display: flex; align-items: center; gap: 8px; }
    .prompt-box { background: rgba(0,0,0,0.3); border: 2px solid rgba(255, 255, 255, 0.5); border-radius: 8px; padding: 16px; margin-bottom: 16px; }
    .prompt-box pre { margin: 0; white-space: pre-wrap; word-wrap: break-word; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; line-height: 1.6; color: #e2e8f0; }
    .copy-btn { background: white; color: #AF52DE; border: none; padding: 8px 16px; border-radius: 6px; font-size: 0.85rem; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; }
    .copy-btn:hover { background: #f0f0f0; }
    /* コードブロック（spring/style.css準拠） */
    .code-block { background: #1e293b; border-radius: 12px; margin: 16px 0; overflow: hidden; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .code-header { background: rgba(255,255,255,0.1); padding: 10px 16px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .code-dots { display: flex; gap: 6px; }
    .code-dot { width: 12px; height: 12px; border-radius: 50%; }
    .code-dot.red { background: #ff5f56; }
    .code-dot.yellow { background: #ffbd2e; }
    .code-dot.green { background: #27ca40; }
    .code-title { color: rgba(255,255,255,0.7); font-size: 12px; font-family: 'JetBrains Mono', monospace; }
    .code-content { padding: 16px; overflow-x: auto; }
    .code-content pre { margin: 0; font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 1.6; color: #e2e8f0; white-space: pre; }
    .code-keyword { color: #c084fc; }
    .code-class { color: #67e8f9; }
    .code-string { color: #86efac; }
    .code-comment { color: #94a3b8; }
    .code-annotation { color: #fbbf24; }
  </style>
</head>
<body>
  <nav class="global-nav"></nav>
  <script src="../../shared/js/nav-promptpg-step.js"></script>

  <div class="container">
    <header class="chapter-header">
      <div class="chapter-badge">Chapter</div>
      <div class="chapter-number">2</div>
      <h1 class="chapter-title">画面作成（リンク遷移）</h1>
      <p class="chapter-subtitle">ControllerとViewを作成し、画面間の遷移を実装</p>
    </header>

    <nav class="toc">
      <h2 class="toc-title">この Chapter の内容</h2>
      <ul class="toc-list">
        <li class="toc-item"><span class="toc-number">2-1</span>Controllerの基本</li>
        <li class="toc-item"><span class="toc-number">2-2</span>Thymeleafテンプレートの作成</li>
        <li class="toc-item"><span class="toc-number">2-3</span>画面遷移の実装</li>
      </ul>
    </nav>

    <div class="overview-box" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border: 1px solid #bae6fd; border-radius: 12px; padding: 24px; margin: 24px 0;">
      <h3 style="margin: 0 0 16px 0; color: #0369a1; display: flex; align-items: center; gap: 8px;">
        <span class="material-icons">info</span> このChapterで学ぶこと
      </h3>
      <p style="margin: 0 0 16px 0; color: #0c4a6e; line-height: 1.7;">
        このChapterでは、<strong>Thymeleafテンプレートを使って画面を生成</strong>し、<strong>Aタグ（リンク）で画面遷移する機能</strong>を実装します。
        Spring MVCの基本的なリクエスト処理の流れを理解しましょう。
      </p>
      <div style="background: white; border-radius: 8px; padding: 16px;">
        <h4 style="margin: 0 0 12px 0; color: #0369a1; font-size: 0.95rem;">使用するアノテーション</h4>
        <ul style="margin: 0; padding-left: 20px; color: #334155; line-height: 1.8;">
          <li><code style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px; color: #7c3aed;">@Controller</code> - クラスがMVCのControllerであることを示す</li>
          <li><code style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px; color: #7c3aed;">@GetMapping</code> - GETリクエストを処理するメソッドを定義</li>
          <li><code style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px; color: #7c3aed;">@PostMapping</code> - POSTリクエストを処理するメソッドを定義</li>
          <li><code style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px; color: #7c3aed;">@PathVariable</code> - URLパスから変数を取得（例: /todos/{id}）</li>
        </ul>
      </div>
    </div>

    <!-- Spring MVC フロー図解 -->
    <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px; margin: 24px 0;">
      <h3 style="margin: 0 0 20px 0; color: #334155; display: flex; align-items: center; gap: 8px; font-size: 1rem;">
        <span class="material-icons" style="color: #6366f1;">account_tree</span> Spring MVCの処理フロー
      </h3>
      <div style="display: flex; align-items: center; justify-content: center; gap: 12px; flex-wrap: wrap; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem;">
        <!-- ブラウザ -->
        <div style="background: #dbeafe; border: 2px solid #3b82f6; border-radius: 8px; padding: 12px 16px; text-align: center;">
          <div style="font-weight: 700; color: #1e40af;">ブラウザ</div>
          <div style="font-size: 0.75rem; color: #3b82f6;">GET /todos</div>
        </div>
        <div style="color: #94a3b8; font-size: 1.2rem;">→</div>
        <!-- Controller -->
        <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px; padding: 12px 16px; text-align: center;">
          <div style="font-weight: 700; color: #92400e;">@Controller</div>
          <div style="font-size: 0.75rem; color: #b45309;">TodoController</div>
        </div>
        <div style="color: #94a3b8; font-size: 1.2rem;">→</div>
        <!-- return -->
        <div style="background: #f3e8ff; border: 2px solid #a855f7; border-radius: 8px; padding: 12px 16px; text-align: center;">
          <div style="font-weight: 700; color: #7e22ce;">return</div>
          <div style="font-size: 0.75rem; color: #9333ea;">"todo/list"</div>
        </div>
        <div style="color: #94a3b8; font-size: 1.2rem;">→</div>
        <!-- View -->
        <div style="background: #dcfce7; border: 2px solid #22c55e; border-radius: 8px; padding: 12px 16px; text-align: center;">
          <div style="font-weight: 700; color: #166534;">Thymeleaf</div>
          <div style="font-size: 0.75rem; color: #16a34a;">list.html</div>
        </div>
        <div style="color: #94a3b8; font-size: 1.2rem;">→</div>
        <!-- HTML -->
        <div style="background: #dbeafe; border: 2px solid #3b82f6; border-radius: 8px; padding: 12px 16px; text-align: center;">
          <div style="font-weight: 700; color: #1e40af;">HTML</div>
          <div style="font-size: 0.75rem; color: #3b82f6;">レスポンス</div>
        </div>
      </div>
      <p style="margin: 16px 0 0 0; color: #64748b; font-size: 0.85rem; text-align: center;">
        ブラウザからのリクエスト → Controllerで処理 → View名を返す → Thymeleafがレンダリング → HTMLを返却
      </p>
    </div>

    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 2-1</span>
        <h2 class="section-title">Controllerの基本</h2>
      </div>

      <div class="intro-text">
        <p><strong>@Controller</strong>アノテーションを使用して、HTTPリクエストを処理するControllerを作成します。</p>
      </div>

      <!-- コントローラの役割説明 -->
      <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; padding: 24px; margin: 24px 0; color: white;">
        <h4 style="margin: 0 0 20px 0; display: flex; align-items: center; gap: 8px; font-size: 1.1rem;">
          <span class="material-icons">psychology</span> Controllerの役割とは？
        </h4>

        <p style="margin: 0 0 20px 0; line-height: 1.8; opacity: 0.95;">
          Controllerは、<strong>ユーザーからのリクエストを受け取り、適切な処理を行って画面を返す</strong>役割を担います。
          MVCアーキテクチャの「C」にあたり、ModelとViewの橋渡し役です。
        </p>

        <!-- 役割の図解 -->
        <div style="display: flex; flex-direction: column; gap: 16px; background: rgba(255,255,255,0.15); border-radius: 12px; padding: 20px;">
          <div style="font-weight: 600; text-align: center; margin-bottom: 8px;">Controllerが行う4つの仕事</div>

          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
            <!-- 1. リクエスト受付 -->
            <div style="background: rgba(255,255,255,0.95); border-radius: 8px; padding: 16px; color: #334155;">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                <span style="background: #3b82f6; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85rem;">1</span>
                <strong style="color: #1e40af;">リクエスト受付</strong>
              </div>
              <p style="margin: 0; font-size: 0.85rem; color: #64748b; line-height: 1.6;">
                ブラウザからのHTTPリクエスト（GET/POST）を受け取る
              </p>
            </div>

            <!-- 2. Service呼び出し -->
            <div style="background: rgba(255,255,255,0.95); border-radius: 8px; padding: 16px; color: #334155;">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                <span style="background: #22c55e; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85rem;">2</span>
                <strong style="color: #166534;">Service呼び出し</strong>
              </div>
              <p style="margin: 0; font-size: 0.85rem; color: #64748b; line-height: 1.6;">
                ビジネスロジックをServiceクラスに委譲する
              </p>
            </div>

            <!-- 3. Model設定 -->
            <div style="background: rgba(255,255,255,0.95); border-radius: 8px; padding: 16px; color: #334155;">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                <span style="background: #f59e0b; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85rem;">3</span>
                <strong style="color: #92400e;">Model設定</strong>
              </div>
              <p style="margin: 0; font-size: 0.85rem; color: #64748b; line-height: 1.6;">
                Viewに渡すデータをModelオブジェクトに追加する
              </p>
            </div>

            <!-- 4. View名を返す -->
            <div style="background: rgba(255,255,255,0.95); border-radius: 8px; padding: 16px; color: #334155;">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                <span style="background: #a855f7; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85rem;">4</span>
                <strong style="color: #7e22ce;">View名を返す</strong>
              </div>
              <p style="margin: 0; font-size: 0.85rem; color: #64748b; line-height: 1.6;">
                表示するテンプレート（HTML）の名前を返す
              </p>
            </div>
          </div>
        </div>

        <!-- 重要ポイント -->
        <div style="background: rgba(255,255,255,0.2); border-radius: 8px; padding: 16px; margin-top: 16px;">
          <div style="display: flex; align-items: flex-start; gap: 12px;">
            <span class="material-icons" style="color: #fbbf24;">warning</span>
            <div style="font-size: 0.9rem; line-height: 1.7;">
              <strong>重要:</strong> Controllerには<strong>ビジネスロジックを書かない</strong>ことがベストプラクティスです。
              データの取得・保存・計算などはServiceクラスに任せ、Controllerはリクエストの受付と画面遷移の制御に集中します。
            </div>
          </div>
        </div>
      </div>

      <div class="prompt-card">
        <h4 style="color: white;"><span class="material-icons">smart_toy</span> AIプロンプト</h4>
        <div class="prompt-box">
          <pre>Spring BootでToDoアプリ用のControllerを作成してください。

要件:
- クラス名: TodoController
- @Controllerアノテーションを使用
- 以下のエンドポイントを作成:
  - GET /todos → 一覧画面
  - GET /todos/new → 新規作成画面
  - GET /todos/{id} → 詳細画面

各メソッドの説明コメントも含めてください。</pre>
        </div>
        <button class="copy-btn" onclick="navigator.clipboard.writeText(this.previousElementSibling.querySelector('pre').textContent)">
          <span class="material-icons">content_copy</span> コピー
        </button>
      </div>

      <h3 style="margin: 32px 0 16px 0; color: #334155; display: flex; align-items: center; gap: 8px;">
        <span class="material-icons" style="color: #22c55e;">auto_awesome</span> 生成されるソースコード
      </h3>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots">
            <span class="code-dot red"></span>
            <span class="code-dot yellow"></span>
            <span class="code-dot green"></span>
          </div>
          <span class="code-title">TodoController.java</span>
        </div>
        <div class="code-content">
          <pre><span class="code-keyword">package</span> com.example.todo.controller;

<span class="code-keyword">import</span> org.springframework.stereotype.Controller;
<span class="code-keyword">import</span> org.springframework.ui.Model;
<span class="code-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="code-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="code-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;

<span class="code-comment">/**
 * ToDoアプリのControllerクラス
 * 画面遷移を管理するエンドポイントを定義
 */</span>
<span class="code-annotation">@Controller</span>
<span class="code-annotation">@RequestMapping</span>(<span class="code-string">"/todos"</span>)
<span class="code-keyword">public class</span> <span class="code-class">TodoController</span> {

    <span class="code-comment">/**
     * 一覧画面を表示
     * GET /todos でアクセス
     */</span>
    <span class="code-annotation">@GetMapping</span>
    <span class="code-keyword">public</span> String <span class="code-class">list</span>(Model model) {
        <span class="code-comment">// ToDoリストをModelに追加（後でServiceから取得）</span>
        <span class="code-keyword">return</span> <span class="code-string">"todo/list"</span>;
    }

    <span class="code-comment">/**
     * 新規作成画面を表示
     * GET /todos/new でアクセス
     */</span>
    <span class="code-annotation">@GetMapping</span>(<span class="code-string">"/new"</span>)
    <span class="code-keyword">public</span> String <span class="code-class">showCreateForm</span>(Model model) {
        <span class="code-comment">// 空のToDoオブジェクトをフォーム用にセット</span>
        <span class="code-keyword">return</span> <span class="code-string">"todo/form"</span>;
    }

    <span class="code-comment">/**
     * 詳細画面を表示
     * GET /todos/{id} でアクセス
     * @param id URLパスから取得するToDoのID
     */</span>
    <span class="code-annotation">@GetMapping</span>(<span class="code-string">"/{id}"</span>)
    <span class="code-keyword">public</span> String <span class="code-class">show</span>(<span class="code-annotation">@PathVariable</span> Long id, Model model) {
        <span class="code-comment">// IDに対応するToDoを取得してModelに追加</span>
        <span class="code-keyword">return</span> <span class="code-string">"todo/detail"</span>;
    }
}</pre>
        </div>
      </div>

      <div class="info-box" style="background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%); border: 1px solid #fde047; border-radius: 12px; padding: 20px; margin: 24px 0;">
        <div class="info-box-title" style="color: #854d0e; margin-bottom: 16px; font-weight: 700; display: flex; align-items: center; gap: 8px;">
          <span class="material-icons">lightbulb</span> コード解説
        </div>
        <div class="info-box-content" style="color: #713f12; line-height: 1.8;">
          <p style="margin: 0 0 16px 0;"><strong>@Controller と @RequestMapping</strong></p>
          <ul style="margin: 0 0 16px 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">@Controller</code> - このクラスがMVCのControllerであることをSpringに伝えます</li>
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">@RequestMapping("/todos")</code> - クラス全体のベースURLを <code>/todos</code> に設定</li>
          </ul>

          <p style="margin: 0 0 16px 0;"><strong>@GetMapping の使い方</strong></p>
          <ul style="margin: 0 0 16px 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">@GetMapping</code> - ベースURL（/todos）へのGETリクエストを処理</li>
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">@GetMapping("/new")</code> - /todos/new へのGETリクエストを処理</li>
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">@GetMapping("/{id}")</code> - /todos/1, /todos/2 など動的URLを処理</li>
          </ul>

          <p style="margin: 0 0 16px 0;"><strong>@PathVariable</strong></p>
          <ul style="margin: 0; padding-left: 20px;">
            <li>URLパス内の <code>{id}</code> 部分の値をメソッド引数として受け取る</li>
            <li>例: <code>/todos/5</code> にアクセス → <code>id = 5</code> が渡される</li>
          </ul>
        </div>
      </div>

      <!-- URLマッピング図解 -->
      <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px; margin: 24px 0;">
        <h4 style="margin: 0 0 16px 0; color: #334155; display: flex; align-items: center; gap: 8px; font-size: 0.95rem;">
          <span class="material-icons" style="color: #6366f1;">link</span> URLマッピングの仕組み
        </h4>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 0.85rem;">
          <!-- ベースURL -->
          <div style="background: #fef3c7; border-radius: 8px; padding: 12px 16px; margin-bottom: 12px;">
            <div style="color: #92400e; font-weight: 600;">@RequestMapping("/todos") ← クラスのベースURL</div>
          </div>
          <!-- 各メソッド -->
          <div style="display: grid; gap: 8px; margin-left: 24px;">
            <div style="display: flex; align-items: center; gap: 12px; background: white; padding: 10px 16px; border-radius: 6px; border: 1px solid #e2e8f0;">
              <code style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 4px;">@GetMapping</code>
              <span style="color: #64748b;">→</span>
              <code style="color: #16a34a;">/todos</code>
              <span style="color: #64748b;">→</span>
              <span style="color: #334155;">一覧画面</span>
            </div>
            <div style="display: flex; align-items: center; gap: 12px; background: white; padding: 10px 16px; border-radius: 6px; border: 1px solid #e2e8f0;">
              <code style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 4px;">@GetMapping("/new")</code>
              <span style="color: #64748b;">→</span>
              <code style="color: #16a34a;">/todos/new</code>
              <span style="color: #64748b;">→</span>
              <span style="color: #334155;">新規作成画面</span>
            </div>
            <div style="display: flex; align-items: center; gap: 12px; background: white; padding: 10px 16px; border-radius: 6px; border: 1px solid #e2e8f0;">
              <code style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 4px;">@GetMapping("/{id}")</code>
              <span style="color: #64748b;">→</span>
              <code style="color: #16a34a;">/todos/5</code>
              <span style="color: #64748b;">→</span>
              <span style="color: #334155;">詳細画面（id=5）</span>
            </div>
          </div>
        </div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>アノテーション</th>
              <th>説明</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>@Controller</code></td>
              <td>Viewを返すコントローラークラスに付与</td>
            </tr>
            <tr>
              <td><code>@GetMapping</code></td>
              <td>GETリクエストを処理するメソッドに付与</td>
            </tr>
            <tr>
              <td><code>@PostMapping</code></td>
              <td>POSTリクエストを処理するメソッドに付与</td>
            </tr>
            <tr>
              <td><code>@PathVariable</code></td>
              <td>URLパスから値を取得</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 2-2</span>
        <h2 class="section-title">Thymeleafテンプレートの作成</h2>
      </div>

      <div class="intro-text">
        <p><strong>Thymeleaf</strong>は、Spring Bootで標準的に使用されるテンプレートエンジンです。HTMLにデータを埋め込むことができます。</p>
      </div>

      <div class="prompt-card">
        <h4 style="color: white;"><span class="material-icons">smart_toy</span> AIプロンプト</h4>
        <div class="prompt-box">
          <pre>ThymeleafでToDoアプリの一覧画面を作成してください。

要件:
- ファイル名: list.html
- 場所: src/main/resources/templates/todo/
- ヘッダーとフッターを含むレイアウト
- ToDoリストをテーブルで表示
- 新規作成へのリンクボタン
- 各行に詳細・編集・削除へのリンク

Bootstrap 5のCDNを使用してスタイリングしてください。</pre>
        </div>
        <button class="copy-btn" onclick="navigator.clipboard.writeText(this.previousElementSibling.querySelector('pre').textContent)">
          <span class="material-icons">content_copy</span> コピー
        </button>
      </div>

      <h3 style="margin: 32px 0 16px 0; color: #334155; display: flex; align-items: center; gap: 8px;">
        <span class="material-icons" style="color: #22c55e;">auto_awesome</span> 生成されるソースコード
      </h3>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots">
            <span class="code-dot red"></span>
            <span class="code-dot yellow"></span>
            <span class="code-dot green"></span>
          </div>
          <span class="code-title">src/main/resources/templates/todo/list.html</span>
        </div>
        <div class="code-content">
          <pre><span class="code-keyword">&lt;!DOCTYPE html&gt;</span>
<span class="code-keyword">&lt;html</span> <span class="code-annotation">xmlns:th</span>=<span class="code-string">"http://www.thymeleaf.org"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;head&gt;</span>
    <span class="code-keyword">&lt;meta</span> charset=<span class="code-string">"UTF-8"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;title&gt;</span>ToDo一覧<span class="code-keyword">&lt;/title&gt;</span>
    <span class="code-comment">&lt;!-- Bootstrap 5 CDN --&gt;</span>
    <span class="code-keyword">&lt;link</span> href=<span class="code-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"</span>
          rel=<span class="code-string">"stylesheet"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;/head&gt;</span>
<span class="code-keyword">&lt;body&gt;</span>
    <span class="code-comment">&lt;!-- ヘッダー --&gt;</span>
    <span class="code-keyword">&lt;nav</span> class=<span class="code-string">"navbar navbar-dark bg-primary"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;div</span> class=<span class="code-string">"container"</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;span</span> class=<span class="code-string">"navbar-brand"</span><span class="code-keyword">&gt;</span>ToDoアプリ<span class="code-keyword">&lt;/span&gt;</span>
        <span class="code-keyword">&lt;/div&gt;</span>
    <span class="code-keyword">&lt;/nav&gt;</span>

    <span class="code-keyword">&lt;div</span> class=<span class="code-string">"container mt-4"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;h1&gt;</span>ToDo一覧<span class="code-keyword">&lt;/h1&gt;</span>

        <span class="code-comment">&lt;!-- 新規作成ボタン --&gt;</span>
        <span class="code-keyword">&lt;a</span> <span class="code-annotation">th:href</span>=<span class="code-string">"@{/todos/new}"</span> class=<span class="code-string">"btn btn-success mb-3"</span><span class="code-keyword">&gt;</span>
            新規作成
        <span class="code-keyword">&lt;/a&gt;</span>

        <span class="code-comment">&lt;!-- ToDoリストテーブル --&gt;</span>
        <span class="code-keyword">&lt;table</span> class=<span class="code-string">"table table-striped"</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;thead&gt;</span>
                <span class="code-keyword">&lt;tr&gt;</span>
                    <span class="code-keyword">&lt;th&gt;</span>ID<span class="code-keyword">&lt;/th&gt;</span>
                    <span class="code-keyword">&lt;th&gt;</span>タイトル<span class="code-keyword">&lt;/th&gt;</span>
                    <span class="code-keyword">&lt;th&gt;</span>ステータス<span class="code-keyword">&lt;/th&gt;</span>
                    <span class="code-keyword">&lt;th&gt;</span>操作<span class="code-keyword">&lt;/th&gt;</span>
                <span class="code-keyword">&lt;/tr&gt;</span>
            <span class="code-keyword">&lt;/thead&gt;</span>
            <span class="code-keyword">&lt;tbody&gt;</span>
                <span class="code-comment">&lt;!-- th:each で繰り返し表示 --&gt;</span>
                <span class="code-keyword">&lt;tr</span> <span class="code-annotation">th:each</span>=<span class="code-string">"todo : ${todos}"</span><span class="code-keyword">&gt;</span>
                    <span class="code-keyword">&lt;td</span> <span class="code-annotation">th:text</span>=<span class="code-string">"${todo.id}"</span><span class="code-keyword">&gt;</span>1<span class="code-keyword">&lt;/td&gt;</span>
                    <span class="code-keyword">&lt;td</span> <span class="code-annotation">th:text</span>=<span class="code-string">"${todo.title}"</span><span class="code-keyword">&gt;</span>サンプルタスク<span class="code-keyword">&lt;/td&gt;</span>
                    <span class="code-keyword">&lt;td</span> <span class="code-annotation">th:text</span>=<span class="code-string">"${todo.completed ? '完了' : '未完了'}"</span><span class="code-keyword">&gt;</span>未完了<span class="code-keyword">&lt;/td&gt;</span>
                    <span class="code-keyword">&lt;td&gt;</span>
                        <span class="code-keyword">&lt;a</span> <span class="code-annotation">th:href</span>=<span class="code-string">"@{/todos/{id}(id=${todo.id})}"</span>
                           class=<span class="code-string">"btn btn-info btn-sm"</span><span class="code-keyword">&gt;</span>詳細<span class="code-keyword">&lt;/a&gt;</span>
                        <span class="code-keyword">&lt;a</span> <span class="code-annotation">th:href</span>=<span class="code-string">"@{/todos/{id}/edit(id=${todo.id})}"</span>
                           class=<span class="code-string">"btn btn-warning btn-sm"</span><span class="code-keyword">&gt;</span>編集<span class="code-keyword">&lt;/a&gt;</span>
                        <span class="code-keyword">&lt;a</span> <span class="code-annotation">th:href</span>=<span class="code-string">"@{/todos/{id}/delete(id=${todo.id})}"</span>
                           class=<span class="code-string">"btn btn-danger btn-sm"</span><span class="code-keyword">&gt;</span>削除<span class="code-keyword">&lt;/a&gt;</span>
                    <span class="code-keyword">&lt;/td&gt;</span>
                <span class="code-keyword">&lt;/tr&gt;</span>
            <span class="code-keyword">&lt;/tbody&gt;</span>
        <span class="code-keyword">&lt;/table&gt;</span>
    <span class="code-keyword">&lt;/div&gt;</span>

    <span class="code-comment">&lt;!-- フッター --&gt;</span>
    <span class="code-keyword">&lt;footer</span> class=<span class="code-string">"bg-light text-center py-3 mt-5"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;p&gt;</span>&amp;copy; 2024 ToDoアプリ<span class="code-keyword">&lt;/p&gt;</span>
    <span class="code-keyword">&lt;/footer&gt;</span>
<span class="code-keyword">&lt;/body&gt;</span>
<span class="code-keyword">&lt;/html&gt;</span></pre>
        </div>
      </div>

      <div class="info-box" style="background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%); border: 1px solid #fde047; border-radius: 12px; padding: 20px; margin: 24px 0;">
        <div class="info-box-title" style="color: #854d0e; margin-bottom: 16px; font-weight: 700; display: flex; align-items: center; gap: 8px;">
          <span class="material-icons">lightbulb</span> コード解説
        </div>
        <div class="info-box-content" style="color: #713f12; line-height: 1.8;">
          <p style="margin: 0 0 16px 0;"><strong>Thymeleaf名前空間の宣言</strong></p>
          <ul style="margin: 0 0 16px 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">xmlns:th="http://www.thymeleaf.org"</code> - Thymeleaf属性を使うための宣言</li>
          </ul>

          <p style="margin: 0 0 16px 0;"><strong>リンク式 @{...}</strong></p>
          <ul style="margin: 0 0 16px 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">th:href="@{/todos/new}"</code> - 固定URLへのリンク</li>
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">th:href="@{/todos/{id}(id=${todo.id})}"</code> - パス変数を含むリンク</li>
          </ul>

          <p style="margin: 0 0 16px 0;"><strong>繰り返し処理 th:each</strong></p>
          <ul style="margin: 0 0 16px 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">th:each="todo : ${todos}"</code> - Controllerから渡されたtodosリストをループ</li>
            <li>各ループで変数 <code>todo</code> に1件ずつデータが入る</li>
          </ul>

          <p style="margin: 0 0 16px 0;"><strong>テキスト出力 th:text</strong></p>
          <ul style="margin: 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">th:text="${todo.title}"</code> - todoオブジェクトのtitleプロパティを出力</li>
            <li>HTMLタグ内のテキスト（サンプルタスク等）は、実行時にth:textの値で置き換えられる</li>
          </ul>
        </div>
      </div>

      <div class="highlight-box">
        <h4>Thymeleaf基本構文</h4>
        <ul>
          <li><code>th:text</code> - テキストを出力</li>
          <li><code>th:each</code> - 繰り返し処理</li>
          <li><code>th:href</code> - リンクURLを動的に生成</li>
          <li><code>th:if</code> / <code>th:unless</code> - 条件分岐</li>
        </ul>
      </div>
    </section>

    <section class="section">
      <div class="section-header">
        <span class="section-number">Section 2-3</span>
        <h2 class="section-title">画面遷移の実装</h2>
      </div>

      <div class="intro-text">
        <p>複数の画面間を<strong>リンク</strong>で遷移できるようにします。Thymeleafの<code>th:href</code>を使用します。</p>
      </div>

      <!-- 画面遷移フロー図解 -->
      <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px; margin: 24px 0;">
        <h4 style="margin: 0 0 20px 0; color: #334155; display: flex; align-items: center; gap: 8px; font-size: 0.95rem;">
          <span class="material-icons" style="color: #6366f1;">swap_horiz</span> 画面遷移フロー
        </h4>
        <div style="display: flex; flex-direction: column; gap: 16px; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem;">
          <!-- 一覧画面 -->
          <div style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
            <div style="background: #dbeafe; border: 2px solid #3b82f6; border-radius: 8px; padding: 16px 20px; min-width: 120px; text-align: center;">
              <div style="font-weight: 700; color: #1e40af;">一覧画面</div>
              <div style="font-size: 0.75rem; color: #3b82f6; margin-top: 4px;">/todos</div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 8px;">
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="color: #94a3b8;">──→</span>
                <span style="background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">新規作成ボタン</span>
                <span style="color: #94a3b8;">→</span>
                <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px; padding: 8px 12px; text-align: center;">
                  <div style="font-weight: 600; color: #92400e;">新規作成画面</div>
                  <div style="font-size: 0.7rem; color: #b45309;">/todos/new</div>
                </div>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="color: #94a3b8;">──→</span>
                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">詳細リンク</span>
                <span style="color: #94a3b8;">→</span>
                <div style="background: #f3e8ff; border: 2px solid #a855f7; border-radius: 8px; padding: 8px 12px; text-align: center;">
                  <div style="font-weight: 600; color: #7e22ce;">詳細画面</div>
                  <div style="font-size: 0.7rem; color: #9333ea;">/todos/{id}</div>
                </div>
                <span style="color: #94a3b8;">→</span>
                <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px; padding: 8px 12px; text-align: center;">
                  <div style="font-weight: 600; color: #92400e;">編集画面</div>
                  <div style="font-size: 0.7rem; color: #b45309;">/todos/{id}/edit</div>
                </div>
              </div>
            </div>
          </div>
          <!-- 戻るボタンの説明 -->
          <div style="background: white; border: 1px solid #e2e8f0; border-radius: 6px; padding: 12px 16px; margin-top: 8px;">
            <span style="color: #64748b; font-size: 0.8rem;">
              <span class="material-icons" style="font-size: 1rem; vertical-align: middle;">keyboard_return</span>
              すべての画面から「戻る」ボタンで <code style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px;">@{/todos}</code> で一覧画面に戻れる
            </span>
          </div>
        </div>
      </div>

      <div class="prompt-card">
        <h4 style="color: white;"><span class="material-icons">smart_toy</span> AIプロンプト</h4>
        <div class="prompt-box">
          <pre>Thymeleafで以下の画面遷移を実装してください。

画面構成:
1. 一覧画面（/todos）
   - 新規作成ボタン → 新規作成画面へ
   - 各行の「詳細」リンク → 詳細画面へ

2. 新規作成画面（/todos/new）
   - 「戻る」ボタン → 一覧画面へ

3. 詳細画面（/todos/{id}）
   - 「一覧に戻る」ボタン → 一覧画面へ
   - 「編集」ボタン → 編集画面へ

th:hrefの使い方と、パラメータの渡し方を示してください。</pre>
        </div>
        <button class="copy-btn" onclick="navigator.clipboard.writeText(this.previousElementSibling.querySelector('pre').textContent)">
          <span class="material-icons">content_copy</span> コピー
        </button>
      </div>

      <h3 style="margin: 32px 0 16px 0; color: #334155; display: flex; align-items: center; gap: 8px;">
        <span class="material-icons" style="color: #22c55e;">auto_awesome</span> 生成されるソースコード
      </h3>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots">
            <span class="code-dot red"></span>
            <span class="code-dot yellow"></span>
            <span class="code-dot green"></span>
          </div>
          <span class="code-title">src/main/resources/templates/todo/form.html（新規作成画面）</span>
        </div>
        <div class="code-content">
          <pre><span class="code-keyword">&lt;!DOCTYPE html&gt;</span>
<span class="code-keyword">&lt;html</span> <span class="code-annotation">xmlns:th</span>=<span class="code-string">"http://www.thymeleaf.org"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;head&gt;</span>
    <span class="code-keyword">&lt;meta</span> charset=<span class="code-string">"UTF-8"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;title&gt;</span>ToDo新規作成<span class="code-keyword">&lt;/title&gt;</span>
    <span class="code-keyword">&lt;link</span> href=<span class="code-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"</span>
          rel=<span class="code-string">"stylesheet"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;/head&gt;</span>
<span class="code-keyword">&lt;body&gt;</span>
    <span class="code-keyword">&lt;div</span> class=<span class="code-string">"container mt-4"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;h1&gt;</span>ToDo新規作成<span class="code-keyword">&lt;/h1&gt;</span>

        <span class="code-comment">&lt;!-- フォーム（Chapter 3で詳しく説明） --&gt;</span>
        <span class="code-keyword">&lt;form&gt;</span>
            <span class="code-keyword">&lt;div</span> class=<span class="code-string">"mb-3"</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;label</span> class=<span class="code-string">"form-label"</span><span class="code-keyword">&gt;</span>タイトル<span class="code-keyword">&lt;/label&gt;</span>
                <span class="code-keyword">&lt;input</span> type=<span class="code-string">"text"</span> class=<span class="code-string">"form-control"</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;/div&gt;</span>
            <span class="code-keyword">&lt;button</span> type=<span class="code-string">"submit"</span> class=<span class="code-string">"btn btn-primary"</span><span class="code-keyword">&gt;</span>作成<span class="code-keyword">&lt;/button&gt;</span>
        <span class="code-keyword">&lt;/form&gt;</span>

        <span class="code-comment">&lt;!-- 戻るボタン: 固定URLへのリンク --&gt;</span>
        <span class="code-keyword">&lt;a</span> <span class="code-annotation">th:href</span>=<span class="code-string">"@{/todos}"</span> class=<span class="code-string">"btn btn-secondary mt-3"</span><span class="code-keyword">&gt;</span>
            戻る
        <span class="code-keyword">&lt;/a&gt;</span>
    <span class="code-keyword">&lt;/div&gt;</span>
<span class="code-keyword">&lt;/body&gt;</span>
<span class="code-keyword">&lt;/html&gt;</span></pre>
        </div>
      </div>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots">
            <span class="code-dot red"></span>
            <span class="code-dot yellow"></span>
            <span class="code-dot green"></span>
          </div>
          <span class="code-title">src/main/resources/templates/todo/detail.html（詳細画面）</span>
        </div>
        <div class="code-content">
          <pre><span class="code-keyword">&lt;!DOCTYPE html&gt;</span>
<span class="code-keyword">&lt;html</span> <span class="code-annotation">xmlns:th</span>=<span class="code-string">"http://www.thymeleaf.org"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;head&gt;</span>
    <span class="code-keyword">&lt;meta</span> charset=<span class="code-string">"UTF-8"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;title&gt;</span>ToDo詳細<span class="code-keyword">&lt;/title&gt;</span>
    <span class="code-keyword">&lt;link</span> href=<span class="code-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"</span>
          rel=<span class="code-string">"stylesheet"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;/head&gt;</span>
<span class="code-keyword">&lt;body&gt;</span>
    <span class="code-keyword">&lt;div</span> class=<span class="code-string">"container mt-4"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;h1&gt;</span>ToDo詳細<span class="code-keyword">&lt;/h1&gt;</span>

        <span class="code-comment">&lt;!-- ToDoの内容を表示 --&gt;</span>
        <span class="code-keyword">&lt;div</span> class=<span class="code-string">"card"</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;div</span> class=<span class="code-string">"card-body"</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;h5</span> class=<span class="code-string">"card-title"</span> <span class="code-annotation">th:text</span>=<span class="code-string">"${todo.title}"</span><span class="code-keyword">&gt;</span>タイトル<span class="code-keyword">&lt;/h5&gt;</span>
                <span class="code-keyword">&lt;p</span> class=<span class="code-string">"card-text"</span><span class="code-keyword">&gt;</span>
                    ステータス:
                    <span class="code-keyword">&lt;span</span> <span class="code-annotation">th:text</span>=<span class="code-string">"${todo.completed ? '完了' : '未完了'}"</span><span class="code-keyword">&gt;</span>未完了<span class="code-keyword">&lt;/span&gt;</span>
                <span class="code-keyword">&lt;/p&gt;</span>
            <span class="code-keyword">&lt;/div&gt;</span>
        <span class="code-keyword">&lt;/div&gt;</span>

        <span class="code-comment">&lt;!-- ナビゲーションボタン --&gt;</span>
        <span class="code-keyword">&lt;div</span> class=<span class="code-string">"mt-3"</span><span class="code-keyword">&gt;</span>
            <span class="code-comment">&lt;!-- 一覧に戻る: 固定URLへのリンク --&gt;</span>
            <span class="code-keyword">&lt;a</span> <span class="code-annotation">th:href</span>=<span class="code-string">"@{/todos}"</span> class=<span class="code-string">"btn btn-secondary"</span><span class="code-keyword">&gt;</span>
                一覧に戻る
            <span class="code-keyword">&lt;/a&gt;</span>

            <span class="code-comment">&lt;!-- 編集: パス変数を含むリンク --&gt;</span>
            <span class="code-keyword">&lt;a</span> <span class="code-annotation">th:href</span>=<span class="code-string">"@{/todos/{id}/edit(id=${todo.id})}"</span> class=<span class="code-string">"btn btn-warning"</span><span class="code-keyword">&gt;</span>
                編集
            <span class="code-keyword">&lt;/a&gt;</span>
        <span class="code-keyword">&lt;/div&gt;</span>
    <span class="code-keyword">&lt;/div&gt;</span>
<span class="code-keyword">&lt;/body&gt;</span>
<span class="code-keyword">&lt;/html&gt;</span></pre>
        </div>
      </div>

      <div class="info-box" style="background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%); border: 1px solid #fde047; border-radius: 12px; padding: 20px; margin: 24px 0;">
        <div class="info-box-title" style="color: #854d0e; margin-bottom: 16px; font-weight: 700; display: flex; align-items: center; gap: 8px;">
          <span class="material-icons">lightbulb</span> コード解説
        </div>
        <div class="info-box-content" style="color: #713f12; line-height: 1.8;">
          <p style="margin: 0 0 16px 0;"><strong>th:href のパターン</strong></p>
          <ul style="margin: 0 0 16px 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">th:href="@{/todos}"</code> - 固定URL（一覧画面へ戻る）</li>
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">th:href="@{/todos/{id}/edit(id=${todo.id})}"</code> - パス変数を動的に埋め込み</li>
          </ul>

          <p style="margin: 0 0 16px 0;"><strong>パス変数の書き方</strong></p>
          <ul style="margin: 0 0 16px 0; padding-left: 20px;">
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">{id}</code> - URL内のプレースホルダー</li>
            <li><code style="background: #fef3c7; padding: 2px 6px; border-radius: 4px;">(id=${todo.id})</code> - 実際の値をバインド</li>
            <li>結果: <code>/todos/5/edit</code> のようなURLが生成される</li>
          </ul>

          <p style="margin: 0 0 16px 0;"><strong>画面遷移の流れ</strong></p>
          <ul style="margin: 0; padding-left: 20px;">
            <li>一覧 → 詳細: <code>@{/todos/{id}(id=${todo.id})}</code></li>
            <li>詳細 → 編集: <code>@{/todos/{id}/edit(id=${todo.id})}</code></li>
            <li>どこからでも一覧へ: <code>@{/todos}</code></li>
          </ul>
        </div>
      </div>

      <div class="info-box">
        <div class="info-box-title"><span class="material-icons">check_circle</span> 確認ポイント</div>
        <div class="info-box-content">
          <p>各画面間のリンクをクリックして、正しく遷移できることを確認してください。URLも期待通りに変化していることを確認しましょう。</p>
        </div>
      </div>
    </section>
  </div>

  <div class="page-nav">
    <a href="promptpg-1.html" class="page-nav-btn prev">
      <div class="page-nav-label">前へ</div>
      <div class="page-nav-title">Chapter 1: Hello! Spring Boot</div>
    </a>
    <a href="promptpg-3.html" class="page-nav-btn next">
      <div class="page-nav-label">次へ</div>
      <div class="page-nav-title">Chapter 3: フォームデータ持ち回り</div>
    </a>
  </div>

  <footer class="footer">
    <p>プロンプトプログラミング - 職業訓練校教材</p>
  </footer>
</body>
</html>
